const __vite__fileDeps=["assets/vendor-DL8Txhke.js","assets/react-BQtoYNb1.js","assets/polyfills-NkOEr1-x.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
var ml=Object.defineProperty;var pl=(s,t,e)=>t in s?ml(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var m=(s,t,e)=>pl(s,typeof t!="symbol"?t+"":t,e);import{j as n,r as p,a as fl,R as gl,b as Ee,c as _l}from"./react-BQtoYNb1.js";import{C as yl,c as vl,s as xl,i as xr,p as wl,a as ye,b as Ks,d as re,e as F,g as Fi,h as We,j as Lr,k as ns,l as _e,m as Ri,n as bl,o as Sl,q as jl,r as ya,t as Cl,B as kl,u as Mi,v as El,Q as Pl,w as Nl,x as A,y as B,z as Il,A as Al,D as Tl,E as Ll,F as Xs,N as Bi,V as va,G as oe,H as le,I as rt,J as $l,P as dt,K as ce,L as en,M as qe,O as $r,R as Or,S as Ol,T as wr,U as Ui,W as Dl,X as Fl,Y as Dr,Z as Ps,_ as xt,$ as Rl,a0 as Hi,a1 as He,a2 as rs,a3 as Ml,a4 as Wi,a5 as Bl,a6 as Vi,a7 as Ul,a8 as Hl,a9 as Wl,aa as Vl,ab as ql,ac as zl,ad as Gl,ae as Jl,af as Yl,ag as Kl,ah as Ql,ai as xa,aj as qi,ak as Zl}from"./vendor-DL8Txhke.js";import{I as Rs}from"./inplayer-Dfyh36rh.js";import"./index-DrWh1H7H.js";import"./polyfills-NkOEr1-x.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function e(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(a){if(a.ep)return;a.ep=!0;const o=e(a);fetch(a.href,o)}})();var gS=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function _S(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}const Xl="modulepreload",ed=function(s){return"/"+s},wa={},zi=function(t,e,r){let a=Promise.resolve();if(e&&e.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),i=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));a=Promise.all(e.map(c=>{if(c=ed(c),c in wa)return;wa[c]=!0;const l=c.endsWith(".css"),d=l?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const u=document.createElement("link");if(u.rel=l?"stylesheet":Xl,l||(u.as="script",u.crossOrigin=""),u.href=c,i&&u.setAttribute("nonce",i),document.head.appendChild(u),l)return new Promise((h,g)=>{u.addEventListener("load",h),u.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${c}`)))})}))}return a.then(()=>t()).catch(o=>{const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=o,window.dispatchEvent(i),!i.defaultPrevented)throw o})};function td(s={}){const{immediate:t=!1,onNeedRefresh:e,onOfflineReady:r,onRegistered:a,onRegisteredSW:o,onRegisterError:i}=s;let c,l;const d=async(h=!0)=>{await l};async function u(){if("serviceWorker"in navigator){if(c=await zi(async()=>{const{Workbox:h}=await import("./vendor-DL8Txhke.js").then(g=>g.al);return{Workbox:h}},__vite__mapDeps([0,1,2])).then(({Workbox:h})=>new h("/sw.js",{scope:"/",type:"classic"})).catch(h=>{i==null||i(h)}),!c)return;c.addEventListener("activated",h=>{(h.isUpdate||h.isExternal)&&window.location.reload()}),c.addEventListener("installed",h=>{h.isUpdate||r==null||r()}),c.register({immediate:t}).then(h=>{o?o("/sw.js",h):a==null||a(h)}).catch(h=>{i==null||i(h)})}}return l=u(),d}const K={APP_VERSION:"",APP_API_BASE_URL:"https://cdn.jwplayer.com",APP_PLAYER_ID:"M4qoGvUk",APP_FOOTER_TEXT:"",APP_DEFAULT_LANGUAGE:"en"},sd=s=>{K.APP_VERSION=s.APP_VERSION||K.APP_VERSION,K.APP_API_BASE_URL=s.APP_API_BASE_URL||K.APP_API_BASE_URL,K.APP_PLAYER_ID=s.APP_PLAYER_ID||K.APP_PLAYER_ID,K.APP_FOOTER_TEXT=s.APP_FOOTER_TEXT||K.APP_FOOTER_TEXT,K.APP_DEFAULT_LANGUAGE=s.APP_DEFAULT_LANGUAGE||K.APP_DEFAULT_LANGUAGE,K.APP_DEFAULT_CONFIG_SOURCE||(K.APP_DEFAULT_CONFIG_SOURCE=s.APP_DEFAULT_CONFIG_SOURCE),K.APP_PLAYER_LICENSE_KEY||(K.APP_PLAYER_LICENSE_KEY=s.APP_PLAYER_LICENSE_KEY),K.APP_BODY_FONT=K.APP_BODY_FONT,K.APP_BODY_ALT_FONT=K.APP_BODY_ALT_FONT};var ht=(s=>(s.ContinueWatching="continue_watching",s.Favorites="favorites",s))(ht||{});const nd=["favorites","continue_watching"],Kt={JWP:"JWP",CLEENG:"CLEENG"},$e={AVOD:"AVOD",AUTHVOD:"AUTHVOD",SVOD:"SVOD"},Gt={Min:.05,Max:.95},rd=25,Gi="test_I4OFGUUCEVB5TI222AS3N2Y2LY6PJM3K",Ji="live_BQDOFBYTGZB3XKF62GBYSLPUJ4YW2TPL",ad=15*6e4,bt={series:"series",episode:"episode",liveChannel:"livechannel",liveEvent:"liveevent",page:"page",hub:"hub"},od={live:"live"},br="M4qoGvUk",zs="app-config",hn="config-file-override",Ns=60*1e3*20,Is=60*1e3*20,id=["1:1","2:1","2:3","4:3","5:3","16:9","9:13","9:16"],Fr=48,cd={canUpdateEmail:!1,canSupportEmptyFullName:!1,canChangePasswordWithOldPassword:!1,canRenewSubscription:!1,canExportAccountData:!1,canDeleteAccount:!1,canUpdatePaymentMethod:!1,canShowReceipts:!1,hasSocialURLs:!1,hasNotifications:!1,watchListSizeLimit:Fr},Rr={jwp:"jwp",viewNexa:"viewnexa"},Jt={playlist:"playlist",continue_watching:"continue_watching",favorites:"favorites",content_list:"content_list"},ae=new yl({defaultScope:"Singleton",skipBaseClassChecks:!0});function G(s,t=!0){const e=ae.getAll(s)[0];if(t&&!e)throw new Error(`Service / Controller '${String(s)}' not found`);return e}function ld(s){return ae.getAll(s)}function At(s,t,e=!0){if(!t)return;let r;try{return r=ae.getAllNamed(s,t)[0],r}catch(a){if(a instanceof Error&&a.message.includes("No matching bindings found")){if(e)throw new Error(`Service not found '${String(s)}' with name '${t}'`);return}console.error("Error caught while initializing service",a)}}function Fe(s,t){if(!s)throw new Error(t)}function Wn(s,t){if(!s)throw new Error(`${t} feature is not enabled`)}const tn=Symbol("INTEGRATION_TYPE"),Mr=Symbol("DETERMINE_INTEGRATION_TYPE"),sn=Symbol("GET_CUSTOMER_IP");function dd(s,t=200){let e;function r(...a){e&&clearTimeout(e),e=setTimeout(()=>s(...a),t)}return r.cancel=()=>clearTimeout(e),r}function ud(s,t){let e,r;function a(...o){const i=r?Date.now()-r:t;i>=t?(s.apply(this,o),r=Date.now()):e||(e=setTimeout(()=>{r&&Date.now()-r>=t&&(s.apply(this,o),r=Date.now()),e=void 0},t-i))}return a.cancel=()=>clearTimeout(e),a}const hd=s=>s.replace(/\\u[\dA-F]{4}/gi,t=>String.fromCharCode(parseInt(t.replace(/\\u/g,""),16)));function md(s){if(s.indexOf("#")===0&&(s=s.slice(1)),s.length===3&&(s=s[0]+s[0]+s[1]+s[1]+s[2]+s[2]),s.length===6)return{r:parseInt(s.slice(0,2),16),g:parseInt(s.slice(2,4),16),b:parseInt(s.slice(4,6),16)}}function Vn(s){const t=md(s);return t?t.r*.299+t.g*.587+t.b*.114>186?"#000000":"#FFFFFF":""}const pd=!1,fd=!1,nn=(s,t)=>{var e;return((e=s.contentType)==null?void 0:e.toLowerCase())===t.toLowerCase()},os=s=>{var t;return["true","1","yes","on"].includes((t=String(s))==null?void 0:t.toLowerCase())},gd=s=>{var t;return["false","0","no","off"].includes((t=String(s))==null?void 0:t.toLowerCase())};const _d=s=>!!s;var Tt=(s=>(s.LIVE="LIVE",s.VOD="VOD",s.SCHEDULED="SCHEDULED",s))(Tt||{});const Yi=s=>!!s&&nn(s,bt.liveEvent),Ki=s=>s.mediaStatus==="SCHEDULED"||s.mediaStatus==="LIVE",yd=s=>{const t=s["VCH.EventState"],{scheduledStart:e,scheduledEnd:r}=s,a=new Date;if((t==="LIVE_PUBLISHED"||e&&e<a)&&r&&r>a)return"LIVE";if(!t)return"VOD";switch(t){case"PRE_LIVE":case"LIVE_UNPUBLISHED":return"SCHEDULED";case"LIVE_PUBLISHED":return"LIVE";case"INSTANT_VOD":case"VOD_PUBLIC":return"VOD"}},vd=s=>s.mediaStatus==="LIVE"||s.mediaStatus==="VOD",Qi="/m/:id/*",Br="/p/:id/*",Zi="/n/:id/*",xd="/s/:id/*",wd="/q/*",bd="/o/about",In="/u",Sd=`${In}/*`,Gs="my-account",Sr="favorites",jr="payments",jd=`${In}/${Gs}`,Cd=`${In}/${Sr}`,kd=`${In}/${jr}`;var Xe=(s=>(s[s.DEBUG=0]="DEBUG",s[s.INFO=1]="INFO",s[s.WARN=2]="WARN",s[s.ERROR=3]="ERROR",s[s.FATAL=4]="FATAL",s[s.SILENT=5]="SILENT",s))(Xe||{});class Ur{}const Ed=s=>s instanceof Error?s:new Error(String(s)),rn=s=>(t,e,{error:r,...a}={})=>{ld(Ur).forEach(i=>{i.log(s,t,e,a,r?Ed(r):void 0)})},Nt=rn(Xe.DEBUG),Xi=rn(Xe.INFO),ss=rn(Xe.WARN),Ve=rn(Xe.ERROR);rn(Xe.FATAL);const ec=s=>s?s.seriesPlayListId||s.seriesPlaylistId||s.seriesId:void 0,tc=s=>typeof ec(s)<"u",Pd=s=>nn(s,bt.series),sc=s=>tc(s)||Pd(s),nc=s=>typeof(s==null?void 0:s.episodeNumber)<"u"||nn(s,bt.episode),Nd=s=>{if(!s||!nc(s))return;const e=(s.tags?s.tags.split(","):[]).find(function(r){return/seriesid_([\w\d]+)/i.test(r)});if(e)return e.split("_")[1]},rc=s=>nn(s,bt.liveChannel),Se=(s,t)=>{const[e,r=""]=s.split("?"),a=new URLSearchParams(r);Object.entries(t).forEach(([i,c])=>{if(c==null)return a.delete(i);const l=Array.isArray(c)?c.join(","):c;a.set(i,String(l))});const o=a.toString();return`${e}${o?`?${o}`:""}`},An=(s,t,e)=>{const r=s.split("/").map(a=>{if(a==="*")return t?Object.entries(t).filter(([l])=>!s.includes(l)).map(([l,d])=>d).join("/"):a;if(!a.startsWith(":")||!t)return a;const o=a.endsWith("?"),i=a.replace(":","").replace("?",""),c=t[i];return c||(o||ss("urlFormatting","Missing param in path creation",{path:s,paramName:i}),"")}).join("/");return e?Se(r,e):r},ac=(s,t="-")=>s.toString().toLowerCase().replace(/\s+/g,"-").replace(/[^\w-]+/g,"").replace(/--+/g,"-").replace(/^-+/,"").replace(/-+$/,"").replace(/-/g,t),Le=({media:s,playlistId:t,play:e=!1,episodeId:r})=>An(Qi,{id:s.mediaid,title:ac(s.title)},{r:t,play:e?"1":null,e:r}),oc=(s,t)=>An(Br,{id:s,title:void 0}),ic=(s,t)=>An(Zi,{id:s,title:void 0}),Ss=(s,t,e=!1)=>An(Br,{id:s},{channel:t,play:e?"1":null}),ts=({seriesId:s,episodeId:t,play:e,playlistId:r})=>Se(`/s/${s}`,{r,e:t,play:e?"1":null}),cc=(s,t,e)=>{const r=Nd(s),a=ec(s);return ts({seriesId:a||r||"",play:t,playlistId:e,episodeId:r&&s.mediaid})};class Id extends Error{constructor(e="",r){super(e);m(this,"code");m(this,"message");this.name="ApiError",this.message=e,this.code=r}}const ct=async s=>{const t=await s.json();if(!s.ok){const e=`Request '${s.url}' failed with ${s.status}`,r=t&&typeof t=="object"&&"message"in t&&typeof t.message=="string"?t.message:void 0;throw new Id(r||e,s.status||500)}return t},Tn=(s,t,e,r)=>{const a=gd(r==null?void 0:r.requiresSubscription)||os(r==null?void 0:r.free),o=r==null?void 0:r.mediaOffers;return!(a||s===$e.AVOD&&!o||s===$e.AUTHVOD&&t&&!o||s===$e.SVOD&&e&&!(o!=null&&o.some(i=>i.premier)))},Ad=(s,t)=>t?t.replace(/\s/g,"").split(",").reduce((e,r)=>r.indexOf(`${s}:`)===0||r.indexOf(`!${s}:`)===0?[...e,{offerId:r.slice(r.indexOf(":")+1),premier:r[0]==="!"}]:e,[]):null,As=(s,t)=>{const e=xl(t);return vl(e)},z=As("ConfigStore",()=>({loaded:!1,config:{id:"",siteName:"",description:"",player:"",siteId:"",assets:{},content:[],menu:[],integrations:{cleeng:{useSandbox:!0},jwp:{clientId:null,assetId:null,useSandbox:!0}},styling:{}},settings:{additionalAllowedConfigSources:[],playerId:br},supportedLanguages:[],accessModel:$e.AVOD,integrationType:null}));var ba,Sa;const ja=20;let Me=(ba=ye(),ba(Sa=class{constructor(){m(this,"generateAlternateImageURL",({mediaId:t,label:e,playlistLabel:r})=>{const a=`/v2/media/${t}/images/${r||e}.webp`;return Se(`${K.APP_API_BASE_URL}${a}`,{poster_fallback:1,fallback:r?e:null})});m(this,"parseDate",(t,e)=>{const r=t[e];if(r&&!xr(new Date(r))){Ve("ApiService",`Invalid "${e}" date provided for the "${t.title}" media item`,{error:new Error("Invalid date")});return}return r?wl(r):void 0});m(this,"transformContentList",t=>{const{list:e,...r}=t,a={...r,playlist:[]};return a.playlist=e.map(o=>{const{custom_params:i,media_id:c,description:l,tags:d,...u}=o,h={feedid:t.id,mediaid:c,tags:d.join(","),description:l||"",sources:[],images:[],image:"",link:"",pubdate:0,...u,...i};return this.transformMediaItem(h,a)}),a});m(this,"transformPlaylist",(t,e)=>(t.playlist=t.playlist.map(r=>this.transformMediaItem(r,t)),e&&(t.playlist=t.playlist.filter(r=>r.mediaid!==e)),t));m(this,"transformMediaItem",(t,e)=>{const r=z.getState().config,a=Object.keys(r==null?void 0:r.integrations)[0],o=e==null?void 0:e.imageLabel,i=t.mediaid,c={...t,cardImage:this.generateAlternateImageURL({mediaId:i,label:"card",playlistLabel:o}),channelLogoImage:this.generateAlternateImageURL({mediaId:i,label:"channel_logo",playlistLabel:o}),backgroundImage:this.generateAlternateImageURL({mediaId:i,label:"background"}),mediaOffers:t.productIds?Ad(a,t.productIds):void 0,scheduledStart:this.parseDate(t,"VCH.ScheduledStart"),scheduledEnd:this.parseDate(t,"VCH.ScheduledEnd")};return c.mediaStatus=yd(c),c});m(this,"transformEpisodes",(t,e)=>{const{episodes:r,page:a,page_limit:o,total:i}=t;return{episodes:r.filter(c=>c.media_item).map(c=>{var l;return{...this.transformMediaItem(c.media_item),seasonNumber:(e==null?void 0:e.toString())||((l=c.season_number)==null?void 0:l.toString())||"",episodeNumber:String(c.episode_number)}}),pagination:{page:a,page_limit:o,total:i}}});m(this,"getMediaByWatchlist",async(t,e,r)=>{if(!(e!=null&&e.length))return[];const a=`/apps/watchlists/${t}`,o=Se(`${K.APP_API_BASE_URL}${a}`,{token:r,media_ids:e}),i=await fetch(o),c=await ct(i);if(!c)throw new Error(`The data was not found using the watchlist ${t}`);return(c.playlist||[]).map(l=>this.transformMediaItem(l))});m(this,"getMediaById",async(t,e,r)=>{const a=r?`/v2/media/${t}/drm/${r}`:`/v2/media/${t}`,o=Se(`${K.APP_API_BASE_URL}${a}`,{token:e}),i=await fetch(o),l=(await ct(i)).playlist[0];if(!l)throw new Error("MediaItem not found");return this.transformMediaItem(l)});m(this,"getSeries",async(t,e={})=>{if(!t)throw new Error("Series ID is required");const r=`/apps/series/${t}`,a=Se(`${K.APP_API_BASE_URL}${r}`,e),o=await fetch(a);return await ct(o)});m(this,"getSeriesByMediaIds",async t=>{const r=`${K.APP_API_BASE_URL}/apps/series?media_ids=${t.join(",")}`,a=await fetch(r);return await ct(a)});m(this,"getEpisodes",async({seriesId:t,pageOffset:e,pageLimit:r=ja,afterId:a})=>{if(!t)throw new Error("Series ID is required");const o=`/apps/series/${t}/episodes`,i=Se(`${K.APP_API_BASE_URL}${o}`,{page_offset:e,page_limit:r,after_id:a}),c=await fetch(i),l=await ct(c);return this.transformEpisodes(l)});m(this,"getSeasonWithEpisodes",async({seriesId:t,seasonNumber:e,pageOffset:r,pageLimit:a=ja})=>{if(!t)throw new Error("Series ID is required");const o=`/apps/series/${t}/seasons/${e}/episodes`,i=Se(`${K.APP_API_BASE_URL}${o}`,{page_offset:r,page_limit:a}),c=await fetch(i),l=await ct(c);return this.transformEpisodes(l,e)});m(this,"getAdSchedule",async t=>{if(!t)throw new Error("Ad Schedule ID is required");const e=K.APP_API_BASE_URL+`/v2/advertising/schedules/${t}.json`,r=await fetch(e,{credentials:"omit"});return await ct(r)});m(this,"getPlaylistById",async(t,e={})=>{if(!t)return;const r=`/v2/playlists/${t}`,a=Se(`${K.APP_API_BASE_URL}${r}`,e),o=await fetch(a),i=await ct(o);return this.transformPlaylist(i,e.related_media_id)});m(this,"getContentList",async({id:t,siteId:e})=>{if(!t||!e)throw new Error("List ID and Site ID are required");const r=`/v2/sites/${e}/content_lists/${t}`,a=Se(`${K.APP_API_BASE_URL}${r}`,{}),o=await fetch(a),i=await ct(o);return this.transformContentList(i)});m(this,"getContentSearch",async({siteId:t,params:e})=>{const r=`/v2/sites/${t}/app_content/media/search`,a=Se(`${K.APP_API_BASE_URL}${r}`,{search_query:e.searchTerm}),o=await fetch(a),i=await ct(o);return this.transformPlaylist(i)})}})||Sa);class Oe{}class wt{constructor(t){m(this,"features");this.features=t}}var Ca,ka,Ea,Pa,Ot;const Td=Ks(re().shape({mediaid:F(),progress:Fi()}));let Cr=(Ca=ye(),ka=function(s,t){return We(tn)(s,void 0,0)},Ea=Reflect.metadata("design:type",Function),Pa=Reflect.metadata("design:paramtypes",[String,typeof Me>"u"?Object:Me,typeof Oe>"u"?Object:Oe]),Ca(Ot=ka(Ot=Ea(Ot=Pa(Ot=class{constructor(t,e,r){m(this,"PERSIST_KEY_WATCH_HISTORY","history");m(this,"apiService");m(this,"storageService");m(this,"accountService");m(this,"getWatchHistoryItems",async(t,e)=>{const r=await this.apiService.getMediaByWatchlist(t,e);return Object.fromEntries((r||[]).map(o=>[o.mediaid,o]))});m(this,"getWatchHistorySeriesItems",async(t,e)=>{const r=await this.apiService.getSeriesByMediaIds(e),a=Object.keys(r||{}).map(l=>{var d,u;return(u=(d=r==null?void 0:r[l])==null?void 0:d[0])==null?void 0:u.series_id}).filter(Boolean),o=[...new Set(a)],i=await this.apiService.getMediaByWatchlist(t,o);return Object.keys(r||{}).reduce((l,d)=>{var h,g;const u=(g=(h=r==null?void 0:r[d])==null?void 0:h[0])==null?void 0:g.series_id;return u&&(l[d]=i==null?void 0:i.find(_=>_.mediaid===u)),l},{})});m(this,"getWatchHistory",async(t,e)=>{const r=t?await this.getWatchHistoryFromAccount(t):await this.getWatchHistoryFromStorage(),a=r.map(({mediaid:o})=>o);if(!a.length)return[];try{const o=await this.getWatchHistoryItems(e,a),i=await this.getWatchHistorySeriesItems(e,a);return r.map(c=>{const l=i==null?void 0:i[c.mediaid],d=o[c.mediaid];if(d)return this.createWatchHistoryItem(l||d,c.mediaid,l==null?void 0:l.mediaid,c.progress)}).filter(c=>!!c)}catch(o){Ve("WatchHistoryService","Failed to get watch history items",{error:o})}return[]});m(this,"serializeWatchHistory",t=>t.map(({mediaid:e,progress:r})=>({mediaid:e,progress:r})));m(this,"persistWatchHistory",async(t,e)=>{var r;e?await((r=this.accountService)==null?void 0:r.updateWatchHistory({history:this.serializeWatchHistory(t),user:e})):await this.storageService.setItem(this.PERSIST_KEY_WATCH_HISTORY,JSON.stringify(this.serializeWatchHistory(t)))});m(this,"createWatchHistoryItem",(t,e,r,a)=>({mediaid:e,seriesId:r,title:t.title,tags:t.tags,duration:t.duration,progress:a,playlistItem:t}));m(this,"getMaxWatchHistoryCount",()=>{var t,e;return((e=(t=this.accountService)==null?void 0:t.features)==null?void 0:e.watchListSizeLimit)||Fr});m(this,"saveItem",async(t,e,r,a)=>{if(!r)return;const o=this.createWatchHistoryItem(e||t,t.mediaid,e==null?void 0:e.mediaid,r),i=a.filter(({mediaid:c,seriesId:l})=>c!==o.mediaid&&(!l||l!==o.seriesId));return i.unshift(o),i.splice(this.getMaxWatchHistoryCount()),i});this.apiService=e,this.storageService=r,this.accountService=At(wt,t)}validateWatchHistory(t){return t&&Td.validateSync(t)?t:[]}async getWatchHistoryFromAccount(t){const e=await this.accountService.getWatchHistory({user:t});return this.validateWatchHistory(e)}async getWatchHistoryFromStorage(){const t=await this.storageService.getItem(this.PERSIST_KEY_WATCH_HISTORY,!0);return this.validateWatchHistory(t)}})||Ot)||Ot)||Ot)||Ot);var Na,Ia;let lc=(Na=ye(),Na(Ia=class{constructor(){m(this,"getToken",async(t,e={},r)=>await(await fetch(t,{method:"POST",headers:{Authorization:r?`Bearer ${r}`:""},body:JSON.stringify(e)})).json());m(this,"getMediaToken",async(t,e,r,a,o)=>{const i=await this.getToken(`${t}/media/${e}/sign${o?`/drm/${o}`:""}`,a,r);if(!i.entitled)throw new Error("Unauthorized");return i.token})}})||Ia);var Aa,Ta,La,$a,Dt;const qn="inplayer_token",Ld="inplayer_iot",$d={json:"application/json",form:"application/x-www-form-urlencoded"};var vr;let Te=(Aa=ye(),Ta=function(s,t){return We(Oe)(s,void 0,0)},La=Reflect.metadata("design:type",Function),$a=Reflect.metadata("design:paramtypes",[typeof Oe>"u"?Object:Oe]),Aa(Dt=Ta(Dt=La(Dt=$a(Dt=(vr=class{constructor(t){m(this,"storageService");m(this,"useSandboxEnv",!0);m(this,"setup",t=>{this.useSandboxEnv=t});m(this,"getBaseUrl",()=>this.useSandboxEnv?"https://staging-sims.jwplayer.com":"http://sims.jwplayer.com");m(this,"setToken",(t,e="",r)=>this.storageService.setItem(qn,JSON.stringify({token:t,refreshToken:e,expires:r}),!1));m(this,"getToken",async()=>{const t=await this.storageService.getItem(qn,!0,!1);return t||{token:"",refreshToken:"",expires:0}});m(this,"removeToken",async()=>{await Promise.all([this.storageService.removeItem(qn),this.storageService.removeItem(Ld)])});m(this,"isAuthenticated",async()=>{const t=await this.getToken();return!!t.token&&t.expires>Date.now()/1e3});m(this,"performRequest",async(t="/",e="GET",r,{contentType:a="form",responseType:o="json",withAuthentication:i=!1,keepalive:c,includeFullResponse:l=!1}={},d)=>{var x;const u={"Content-Type":$d[a]};if(i){const y=await this.getToken();y.token&&(u.Authorization=`Bearer ${y.token}`)}const h=new URLSearchParams;r&&Object.entries(r).forEach(([y,v])=>{(v||v===0)&&(typeof v=="object"?Object.entries(v).forEach(([b,w])=>{h.append(`${y}[${b}]`,w.toString())}):h.append(y,v.toString()))});const g=`${t.startsWith("http")?t:`${this.getBaseUrl()}${t}`}${d?`?${new URLSearchParams(d).toString()}`:""}`,_=await fetch(g,{headers:u,keepalive:c,method:e,body:r&&h.toString()}),f=await((x=_[o])==null?void 0:x.call(_));if(!_.ok)throw{response:{data:f}};return l?{..._,data:f}:f});m(this,"get",(t,e,r)=>this.performRequest(t,"GET",void 0,e,r));m(this,"patch",(t,e,r)=>this.performRequest(t,"PATCH",e,r));m(this,"put",(t,e,r)=>this.performRequest(t,"PUT",e,r));m(this,"post",(t,e,r)=>this.performRequest(t,"POST",e,r));m(this,"remove",(t,e,r)=>this.performRequest(t,"DELETE",r,e));this.storageService=t}},m(vr,"isCommonError",t=>{var e,r,a,o;return typeof t=="object"&&t!==null&&"response"in t&&typeof((r=(e=t.response)==null?void 0:e.data)==null?void 0:r.code)=="number"&&typeof((o=(a=t.response)==null?void 0:a.data)==null?void 0:o.message)=="string"}),vr))||Dt)||Dt)||Dt)||Dt);var Oa,Da,Fa,Ra,Ft;let dc=(Oa=ye(),Da=function(s,t){return We(Te)(s,void 0,0)},Fa=Reflect.metadata("design:type",Function),Ra=Reflect.metadata("design:paramtypes",[typeof Te>"u"?Object:Te]),Oa(Ft=Da(Ft=Fa(Ft=Ra(Ft=class{constructor(t){m(this,"apiService");m(this,"getJWPMediaToken",async(t="",e)=>{try{return(await this.apiService.get("v2/items/jw-media/token",{withAuthentication:!0},{app_config_id:t,media_id:e})).token}catch{throw new Error("Unauthorized")}});this.apiService=t}})||Ft)||Ft)||Ft)||Ft);var Ma,Ba,Ua,Ha,Rt;const Od=Ks(re().shape({mediaid:F()}));let kr=(Ma=ye(),Ba=function(s,t){return We(tn)(s,void 0,0)},Ua=Reflect.metadata("design:type",Function),Ha=Reflect.metadata("design:paramtypes",[String,typeof Me>"u"?Object:Me,typeof Oe>"u"?Object:Oe]),Ma(Rt=Ba(Rt=Ua(Rt=Ha(Rt=class{constructor(t,e,r){m(this,"PERSIST_KEY_FAVORITES","favorites");m(this,"apiService");m(this,"storageService");m(this,"accountService");m(this,"getFavorites",async(t,e)=>{const a=(t?await this.getFavoritesFromAccount(t):await this.getFavoritesFromStorage()).map(({mediaid:o})=>o);if(!a)return[];try{return(await this.apiService.getMediaByWatchlist(e,a)||[]).map(i=>this.createFavorite(i))}catch(o){Ve("FavoriteService","Failed to get favorites",{error:o})}return[]});m(this,"serializeFavorites",t=>t.map(({mediaid:e})=>({mediaid:e})));m(this,"persistFavorites",async(t,e)=>{var r;if(e)return(r=this.accountService)==null?void 0:r.updateFavorites({favorites:this.serializeFavorites(t),user:e});await this.storageService.setItem(this.PERSIST_KEY_FAVORITES,JSON.stringify(this.serializeFavorites(t)))});m(this,"getMaxFavoritesCount",()=>{var t,e;return((e=(t=this.accountService)==null?void 0:t.features)==null?void 0:e.watchListSizeLimit)||Fr});m(this,"createFavorite",t=>({mediaid:t.mediaid,title:t.title,tags:t.tags,duration:t.duration,playlistItem:t}));this.apiService=e,this.storageService=r,this.accountService=At(wt,t,!1)}validateFavorites(t){return t&&Od.validateSync(t)?t:[]}async getFavoritesFromAccount(t){var r;const e=await((r=this.accountService)==null?void 0:r.getFavorites({user:t}));return this.validateFavorites(e)}async getFavoritesFromStorage(){const t=await this.storageService.getItem(this.PERSIST_KEY_FAVORITES,!0);return this.validateFavorites(t)}})||Rt)||Rt)||Rt)||Rt);const Dd=re({contentId:F().notRequired(),title:F().notRequired(),featured:Lr().notRequired(),backgroundColor:F().nullable().notRequired(),type:ns().oneOf(["playlist","continue_watching","favorites","content_list"])}).defined(),Fd=re().shape({label:F().defined(),contentId:F().defined(),filterTags:F().notRequired(),type:ns().oneOf(["playlist","content_list"]).notRequired()}),Rd=re({recommendationsPlaylist:F().nullable(),searchPlaylist:F().nullable(),continueWatchingList:F().nullable(),favoritesList:F().nullable()}),Md=re({id:F().nullable(),monthlyOffer:F().nullable(),yearlyOffer:F().nullable(),useSandbox:Lr().default(!0)}),Bd=re({clientId:F().nullable(),assetId:Fi().nullable(),useSandbox:Lr().default(!0)}),Ud=re({backgroundColor:F().nullable(),highlightColor:F().nullable(),headerBackground:F().nullable(),footerText:F().nullable()}),Hd=re({id:F().notRequired(),siteName:F().notRequired(),description:F().defined(),analyticsToken:F().nullable(),adSchedule:F().nullable(),adDeliveryMethod:ns().oneOf(["csai","ssai"]).notRequired(),adConfig:F().nullable(),siteId:F().defined(),assets:re({banner:F().notRequired().nullable()}).notRequired(),content:Ks().of(Dd),menu:Ks().of(Fd),styling:Ud.notRequired(),features:Rd.notRequired(),integrations:re({cleeng:Md.notRequired(),jwp:Bd.notRequired()}).notRequired(),adScheduleUrls:re({json:F().notRequired().nullable(),xml:F().notRequired().nullable()}).notRequired(),custom:re().notRequired(),contentSigningService:re().shape({host:F().required(),drmPolicyId:F().notRequired()}),contentProtection:re().shape({accessModel:F().oneOf(["free","freeauth","authvod","svod"]).notRequired(),drm:re({defaultPolicyId:F()}).notRequired()}).notRequired()}).defined();class Cs extends Error{constructor(e,r){super(e);m(this,"payload");this.name="AppError",this.payload=r}}var Wa,Va,qa,us;let jn=(Wa=ye(),Va=Reflect.metadata("design:type",Function),qa=Reflect.metadata("design:paramtypes",[typeof Me>"u"?Object:Me]),Wa(us=Va(us=qa(us=class{constructor(t){m(this,"CONFIG_HOST",K.APP_API_BASE_URL);m(this,"DEFAULT_CONFIG",{id:"",siteName:"",description:"",siteId:"",assets:{banner:"/images/logo.png"},content:[],menu:[],integrations:{},styling:{footerText:""},features:{}});m(this,"apiService");m(this,"enrichConfig",t=>{const{content:e,siteName:r}=t,a=e.map(o=>Object.assign({featured:!1},o));return{...t,siteName:r||_e.t("common:default_site_name"),content:a}});m(this,"getDefaultConfig",()=>this.DEFAULT_CONFIG);m(this,"validateConfig",t=>Hd.validate(t,{strict:!0}));m(this,"formatSourceLocation",t=>{if(t)return t.match(/^[a-z,\d]{8}$/)?`${this.CONFIG_HOST}/apps/configs/${t}.json`:t});m(this,"loadAdSchedule",async t=>this.apiService.getAdSchedule(t));m(this,"loadConfig",async t=>{const e=Ri(),r={title:e.t("error:config_invalid"),description:e.t("error:check_your_config"),helpLink:"https://github.com/jwplayer/ott-web-app/blob/develop/docs/configuration.md"};if(!t)throw new Cs("No config location found",r);const a=await fetch(t,{headers:{Accept:"application/json"},method:"GET"}).catch(()=>{throw new Cs("Failed to load the config",r)});if(!a.ok)throw new Cs("Failed to load the config",r);const o=await a.json();if(!o)throw new Error("No config found");return this.enrichConfig(o)});this.apiService=t}})||us)||us)||us);var za,Ga,Ja,hs;let Cn=(za=ye(),Ga=Reflect.metadata("design:type",Function),Ja=Reflect.metadata("design:paramtypes",[typeof Oe>"u"?Object:Oe]),za(hs=Ga(hs=Ja(hs=class{constructor(t){m(this,"storageService");m(this,"isValidConfigSource",(t,e)=>e!=null&&e.UNSAFE_allowAnyConfigSource?!!t:(e==null?void 0:e.defaultConfigSource)===t||(e==null?void 0:e.additionalAllowedConfigSources)&&(e==null?void 0:e.additionalAllowedConfigSources.indexOf(t))>=0);m(this,"initialize",async()=>{var a;const t=await fetch("/.webapp.ini").then(o=>o.text()).then(o=>bl.parse(o)).catch(o=>(Nt("SettingsService","Failed to fetch or parse the ini settings",{error:o}),{})),e=Ri(),r={title:e.t("error:settings_invalid"),description:e.t("error:check_your_settings"),helpLink:"https://github.com/jwplayer/ott-web-app/blob/develop/docs/initialization-file.md"};if(!t)throw new Cs("Unable to load .webapp.ini",r);if(t.defaultConfigSource||(t.defaultConfigSource=K.APP_DEFAULT_CONFIG_SOURCE),t.playerId||(t.playerId=K.APP_PLAYER_ID||br),t.playerLicenseKey||(t.playerLicenseKey=K.APP_PLAYER_LICENSE_KEY),t.playerId===br&&!t.playerLicenseKey&&ss("SettingsService","Using Global OTT Player without setting player key. Some features, such as analytics, may not work correctly."),!t.defaultConfigSource&&(!t.additionalAllowedConfigSources||((a=t.additionalAllowedConfigSources)==null?void 0:a.length)===0)&&!t.UNSAFE_allowAnyConfigSource)throw new Cs("No usable config sources",r);return t});this.storageService=t}async getConfigSource(t,e){var i;if(!t)return"";const a=new URLSearchParams(e.split("?")[1]).get(zs);if(!t.UNSAFE_allowAnyConfigSource&&(((i=t.additionalAllowedConfigSources)==null?void 0:i.length)||0)<=0)return t.defaultConfigSource;if(a!==null){if(!a)return await this.storageService.removeItem(hn),t.defaultConfigSource;if(this.isValidConfigSource(a,t))return await this.storageService.setItem(hn,a),a;ss("SettingsService",`Invalid app-config query param: ${a}`)}const o=await this.storageService.getItem(hn,!1);if(o&&typeof o=="string"){if(this.isValidConfigSource(o,t))return o;ss("SettingsService","Invalid stored config: "+o),await this.storageService.removeItem(hn)}return t.defaultConfigSource}})||hs)||hs)||hs);const R=As("AccountStore",(s,t)=>({loading:!1,user:null,subscription:null,transactions:null,activePayment:null,customerConsents:null,publisherConsents:null,publisherConsentsLoading:!1,pendingOffer:null,setLoading:e=>s({loading:e}),getAccountInfo:()=>{const e=t().user,r=t().customerConsents;if(!(e!=null&&e.id))throw new Error("user not logged in");return{customerId:e==null?void 0:e.id,customer:e,customerConsents:r}}})),ut=As("WatchHistoryStore",(s,t)=>({watchHistory:[],playlistItemsLoaded:!1,continueWatchingPlaylistId:ht.ContinueWatching,getItem:e=>t().watchHistory.find(({mediaid:r,progress:a})=>r===e.mediaid&&a>Gt.Min&&a<Gt.Max),getPlaylist:()=>({feedid:t().continueWatchingPlaylistId||ht.ContinueWatching,title:"Continue watching",playlist:t().watchHistory.filter(({playlistItem:e,progress:r})=>!!e&&r>Gt.Min&&r<Gt.Max).map(({playlistItem:e})=>e)}),getDictionaryWithEpisodes:()=>t().watchHistory.reduce((e,r)=>{const a=r.mediaid;return e[a]=r.progress,e},{}),getDictionaryWithSeries:()=>t().watchHistory.reduce((e,r)=>{const a=r.seriesId||r.mediaid;return e[a]=r.progress,e},{})}));var Ya,Ka,Qa,ms;let Qs=(Ya=ye(),Ka=Reflect.metadata("design:type",Function),Qa=Reflect.metadata("design:paramtypes",[typeof Cr>"u"?Object:Cr]),Ya(ms=Ka(ms=Qa(ms=class{constructor(t){m(this,"watchHistoryService");m(this,"initialize",async()=>{await this.restoreWatchHistory()});m(this,"restoreWatchHistory",async()=>{var a;const{user:t}=R.getState(),e=(a=z.getState().config.features)==null?void 0:a.continueWatchingList;if(!e)return;const r=await this.watchHistoryService.getWatchHistory(t,e);ut.setState({watchHistory:r.filter(o=>!!(o!=null&&o.mediaid)),playlistItemsLoaded:!0,continueWatchingPlaylistId:e})});m(this,"persistWatchHistory",async()=>{const{watchHistory:t}=ut.getState(),{user:e}=R.getState();await this.watchHistoryService.persistWatchHistory(t,e)});m(this,"saveItem",async(t,e,r)=>{const{watchHistory:a}=ut.getState();if(!r)return;const o=await this.watchHistoryService.saveItem(t,e,r,a);o&&(ut.setState({watchHistory:o}),await this.persistWatchHistory())});this.watchHistoryService=t}})||ms)||ms)||ms);class Ts{}class Ls{}const ve=As("CheckoutStore",s=>({requestedMediaOffers:[],mediaOffers:[],subscriptionOffers:[],switchSubscriptionOffers:[],selectedOffer:null,defaultOfferId:null,order:null,paymentMethods:null,setRequestedMediaOffers:t=>s({requestedMediaOffers:t}),setOrder:t=>s({order:t}),setPaymentMethods:t=>s({paymentMethods:t})}));class Ke extends Error{constructor(e){super(Object.values(e).flat().join(";"));m(this,"errors");this.errors=e}}const Wd=s=>{const t=s==null?void 0:s.period;return t==="month"?"upgrade":t==="year"?"downgrade":"upgrade"};var Za,Xa,eo,to,so,ft;let St=(Za=ye(),Xa=function(s,t){return We(tn)(s,void 0,0)},eo=function(s,t){return We(sn)(s,void 0,1)},to=Reflect.metadata("design:type",Function),so=Reflect.metadata("design:paramtypes",[typeof IntegrationType>"u"?Object:IntegrationType,typeof GetCustomerIP>"u"?Object:GetCustomerIP]),Za(ft=Xa(ft=eo(ft=to(ft=so(ft=class{constructor(t,e){m(this,"accountService");m(this,"checkoutService");m(this,"subscriptionService");m(this,"getCustomerIP");m(this,"initialiseOffers",async()=>{const t=ve.getState().requestedMediaOffers,e=t?await this.getOffers({offerIds:t.map(({offerId:r})=>r)}):[];if(ve.setState({mediaOffers:e}),!ve.getState().subscriptionOffers.length&&this.accountService.svodOfferIds){const r=await this.getOffers({offerIds:this.accountService.svodOfferIds});ve.setState({subscriptionOffers:r})}if(!ve.getState().switchSubscriptionOffers.length){const r=await this.getSubscriptionSwitches(),a=r?await this.getOffers({offerIds:r}):[];ve.setState({switchSubscriptionOffers:a})}});m(this,"getSubscriptionOfferIds",()=>this.accountService.svodOfferIds);m(this,"chooseOffer",async t=>{ve.setState({selectedOffer:t})});m(this,"initialiseOrder",async t=>{var l,d,u;const{getAccountInfo:e}=R.getState(),{customer:r}=e(),o=(l=(await this.getPaymentMethods())[0])==null?void 0:l.id,i={offer:t,customerId:r.id,country:(r==null?void 0:r.country)||"",paymentMethodId:o},c=await this.checkoutService.createOrder(i);if(((d=c==null?void 0:c.errors)==null?void 0:d.length)>0)throw ve.getState().setOrder(null),new Error(c==null?void 0:c.errors[0]);ve.getState().setOrder((u=c.responseData)==null?void 0:u.order)});m(this,"updateOrder",async(t,e,r)=>{var a;try{const o=await this.checkoutService.updateOrder({order:t,paymentMethodId:e,couponCode:r});o.responseData.order&&ve.getState().setOrder((a=o.responseData)==null?void 0:a.order)}catch(o){if(o instanceof Error)if(o.message==="Order not found")ve.getState().setOrder(null);else{if(o.message==="Invalid coupon code")throw new Ke({couponCode:[_e.t("account:checkout.coupon_not_valid")]});if(o.message==="Invalid coupon code for this offer")throw new Ke({couponCode:[_e.t("account:checkout.coupon_not_valid_for_offer")]})}throw new Ke({form:[_e.t("error:unknown_error")]})}});m(this,"getPaymentMethods",async()=>{var r,a;const{paymentMethods:t}=ve.getState();if(t)return t;const e=await this.checkoutService.getPaymentMethods();if(e.errors.length>0)throw new Error(e.errors[0]);return ve.getState().setPaymentMethods((r=e.responseData)==null?void 0:r.paymentMethods),(a=e.responseData)==null?void 0:a.paymentMethods});m(this,"paymentWithoutDetails",async()=>{const{order:t}=ve.getState();if(!t)throw new Error("No order created");const e=await this.checkoutService.paymentWithoutDetails({orderId:t.id});if(e.errors.length>0)throw new Error(e.errors[0]);if(e.responseData.rejectedReason)throw new Error(e.responseData.rejectedReason);return e.responseData});m(this,"directPostCardPayment",async({cardPaymentPayload:t,referrer:e,returnUrl:r})=>{const{order:a}=ve.getState();if(!a)throw new Error("No order created");return await this.checkoutService.directPostCardPayment(t,a,e,r)});m(this,"createAdyenPaymentSession",async(t,e=!0)=>{const{order:r}=ve.getState(),a=r==null?void 0:r.id;if(e&&!a)throw new Error("There is no order to pay for");Fe(this.checkoutService.createAdyenPaymentSession,"createAdyenPaymentSession is not available in checkout service");const o=await this.checkoutService.createAdyenPaymentSession({orderId:a,returnUrl:t});if(o.errors.length>0)throw new Error(o.errors[0]);return o.responseData});m(this,"initialAdyenPayment",async(t,e)=>{const{order:r}=ve.getState();if(!r)throw new Error("No order created");Fe(this.checkoutService.initialAdyenPayment,"initialAdyenPayment is not available in checkout service");const a=await this.checkoutService.initialAdyenPayment({orderId:r.id,returnUrl:e,paymentMethod:t,customerIP:await this.getCustomerIP()});if(a.errors.length>0)throw new Error(a.errors[0]);return a.responseData});m(this,"finalizeAdyenPayment",async(t,e,r)=>{if(!e)throw new Error("No order created");Fe(this.checkoutService.finalizeAdyenPayment,"finalizeAdyenPayment is not available in checkout service");const a=await this.checkoutService.finalizeAdyenPayment({orderId:e,details:t,paymentData:r});if(a.errors.length>0)throw new Error(a.errors[0]);return a.responseData});m(this,"paypalPayment",async({successUrl:t,waitingUrl:e,cancelUrl:r,errorUrl:a,couponCode:o=""})=>{const{order:i}=ve.getState();if(!i)throw new Error("No order created");const c=await this.checkoutService.paymentWithPayPal({order:i,successUrl:t,waitingUrl:e,cancelUrl:r,errorUrl:a,couponCode:o});if(c.errors.length>0)throw new Error(c.errors[0]);return{redirectUrl:c.responseData.redirectUrl}});m(this,"getSubscriptionSwitches",async()=>{const{getAccountInfo:t}=R.getState(),{customerId:e}=t(),{subscription:r}=R.getState();if(!r||!this.checkoutService.getSubscriptionSwitches)return null;Fe(this.checkoutService.getOffer,"getOffer is not available in checkout service");const a=await this.checkoutService.getSubscriptionSwitches({customerId:e,offerId:r.offerId});return a.responseData.available.length?a.responseData.available.map(({toOfferId:o})=>o):null});m(this,"switchSubscription",async()=>{const t=ve.getState().selectedOffer,e=R.getState().subscription,{getAccountInfo:r}=R.getState(),{customerId:a}=r();if(!t||!e)throw new Error("No offer selected");Fe(this.checkoutService.switchSubscription,"switchSubscription is not available in checkout service");const o=Wd(e),i={toOfferId:t.offerId,customerId:a,offerId:e.offerId,switchDirection:o};await this.checkoutService.switchSubscription(i)});m(this,"changeSubscription",async({accessFeeId:t,subscriptionId:e})=>{Fe(this.subscriptionService.changeSubscription,"changeSubscription is not available in subscription service");const{responseData:r}=await this.subscriptionService.changeSubscription({accessFeeId:t,subscriptionId:e});return r});m(this,"updatePayPalPaymentMethod",async(t,e,r,a,o,i)=>{Fe(this.checkoutService.updatePaymentMethodWithPayPal,"updatePaymentMethodWithPayPal is not available in checkout service"),Fe(this.checkoutService.deletePaymentMethod,"deletePaymentMethod is not available in checkout service");const c=await this.checkoutService.updatePaymentMethodWithPayPal({paymentMethodId:o,successUrl:t,waitingUrl:e,cancelUrl:r,errorUrl:a});if(c.errors.length>0)throw new Error(c.errors[0]);return i&&await this.checkoutService.deletePaymentMethod({paymentDetailsId:i}),c.responseData});m(this,"addAdyenPaymentDetails",async(t,e,r)=>{Fe(this.checkoutService.addAdyenPaymentDetails,"addAdyenPaymentDetails is not available in checkout service");const a=await this.checkoutService.addAdyenPaymentDetails({paymentMethodId:e,returnUrl:r,paymentMethod:t,customerIP:await this.getCustomerIP()});if(a.errors.length>0)throw new Error(a.errors[0]);return a.responseData});m(this,"finalizeAdyenPaymentDetails",async(t,e,r)=>{Fe(this.checkoutService.finalizeAdyenPaymentDetails,"finalizeAdyenPaymentDetails is not available in checkout service");const a=await this.checkoutService.finalizeAdyenPaymentDetails({paymentMethodId:e,details:t,paymentData:r});if(a.errors.length>0)throw new Error(a.errors[0]);return a.responseData});m(this,"getOffers",t=>this.checkoutService.getOffers(t));m(this,"getEntitlements",t=>this.checkoutService.getEntitlements(t));this.getCustomerIP=e,this.accountService=At(wt,t),this.checkoutService=At(Ts,t),this.subscriptionService=At(Ls,t)}})||ft)||ft)||ft)||ft)||ft);const lt=As("FavoritesState",(s,t)=>({favorites:[],warning:null,favoritesPlaylistId:ht.Favorites,setWarning:e=>s({warning:e}),clearWarning:()=>s({warning:null}),hasItem:e=>t().favorites.some(r=>r.mediaid===e.mediaid),getPlaylist:()=>({feedid:t().favoritesPlaylistId||ht.Favorites,title:"Favorites",playlist:t().favorites.map(({playlistItem:e})=>e)})}));var no,ro,ao,ps;let ks=(no=ye(),ro=Reflect.metadata("design:type",Function),ao=Reflect.metadata("design:paramtypes",[typeof kr>"u"?Object:kr]),no(ps=ro(ps=ao(ps=class{constructor(t){m(this,"favoritesService");m(this,"initialize",async()=>{await this.restoreFavorites()});m(this,"restoreFavorites",async()=>{var a;const{user:t}=R.getState(),e=(a=z.getState().config.features)==null?void 0:a.favoritesList;if(!e)return;const r=await this.favoritesService.getFavorites(t,e);lt.setState({favorites:r,favoritesPlaylistId:e})});m(this,"persistFavorites",async()=>{const{favorites:t}=lt.getState(),{user:e}=R.getState();await this.favoritesService.persistFavorites(t,e)});m(this,"saveItem",async t=>{const{favorites:e}=lt.getState();if(!e.some(({mediaid:r})=>r===t.mediaid)){const r=[this.favoritesService.createFavorite(t)].concat(e);lt.setState({favorites:r}),await this.persistFavorites()}});m(this,"removeItem",async t=>{const{favorites:e}=lt.getState(),r=e.filter(({mediaid:a})=>a!==t.mediaid);lt.setState({favorites:r}),await this.persistFavorites()});m(this,"toggleFavorite",async t=>{const{favorites:e,hasItem:r,setWarning:a}=lt.getState();if(!t)return;if(r(t)){await this.removeItem(t);return}if(e.length>this.favoritesService.getMaxFavoritesCount()){a(_e.t("video:favorites_warning",{maxCount:this.favoritesService.getMaxFavoritesCount()}));return}await this.saveItem(t)});m(this,"clear",async()=>{lt.setState({favorites:[]}),await this.persistFavorites()});this.favoritesService=t}})||ps)||ps)||ps);var oo,io,co,lo,Mt;let fe=(oo=ye(),io=function(s,t){return We(tn)(s,void 0,0)},co=Reflect.metadata("design:type",Function),lo=Reflect.metadata("design:paramtypes",[typeof IntegrationType>"u"?Object:IntegrationType,typeof ks>"u"?Object:ks,typeof Qs>"u"?Object:Qs]),oo(Mt=io(Mt=co(Mt=lo(Mt=class{constructor(t,e,r){m(this,"checkoutService");m(this,"accountService");m(this,"subscriptionService");m(this,"favoritesController");m(this,"watchHistoryController");m(this,"features");m(this,"refreshEntitlements");m(this,"loadUserData",async()=>{try{await this.accountService.getAuthData()&&await this.getAccount()}catch(t){Ve("AccountController","Failed to get user",{error:t}),t instanceof Error&&t.message.includes("Invalid JWT token")&&await this.logout()}});m(this,"initialize",async(t,e)=>{this.refreshEntitlements=e,R.setState({loading:!0});const r=z.getState().config;await this.accountService.initialize(r,t,this.logout),z.setState({accessModel:this.accountService.accessModel}),await this.loadUserData(),R.setState({loading:!1})});m(this,"updateUser",async t=>{R.setState({loading:!0});const{user:e}=R.getState(),{canUpdateEmail:r,canSupportEmptyFullName:a}=this.getFeatures();if(Object.prototype.hasOwnProperty.call(t,"email")&&!r)throw new Error("Email update not supported");if(!e)throw new Error("User not logged in");const o=this.validateInputLength(t);if(o.length)return{errors:o,responseData:{}};let i=t;a||(i={...t,email:e.email});const c=await this.accountService.updateCustomer({...i,id:e.id.toString()});if(!c)throw new Error("Unknown error");return R.setState({user:c}),{errors:[],responseData:c}});m(this,"getAccount",async()=>{const{config:t}=z.getState();try{const e=await this.accountService.getUser({config:t});e&&await this.afterLogin(e.user,e.customerConsents),R.setState({loading:!1})}catch{R.setState({user:null,subscription:null,transactions:null,activePayment:null,customerConsents:null,publisherConsents:null,loading:!1})}});m(this,"login",async(t,e,r)=>{R.setState({loading:!0});try{const a=await this.accountService.login({email:t,password:e,referrer:r});if(a){await this.afterLogin(a.user,a.customerConsents);return}}catch(a){if(a instanceof Error&&a.message.toLowerCase().includes("invalid param email"))throw new Ke({email:[_e.t("account:login.wrong_email")]})}finally{R.setState({loading:!1})}throw new Ke({form:[_e.t("account:login.wrong_combination")]})});m(this,"logout",async()=>{var t,e;await((t=this.accountService)==null?void 0:t.logout()),await this.clearLoginState(),await((e=this.refreshEntitlements)==null?void 0:e.call(this))});m(this,"register",async(t,e,r,a)=>{try{const o=await this.accountService.register({email:t,password:e,consents:a,referrer:r});if(o){const{user:i,customerConsents:c}=o;await this.afterLogin(i,c,!0);return}}catch(o){if(o instanceof Error){const i=o.message.toLowerCase();if(i.includes("customer already exists")||i.includes("account already exists"))throw new Ke({form:[_e.t("account:registration.user_exists")]});if(i.includes("please enter a valid e-mail address"))throw new Ke({email:[_e.t("account:registration.field_is_not_valid_email")]});if(i.includes("invalid param password"))throw new Ke({password:[_e.t("account:registration.invalid_password")]})}}throw new Ke({form:[_e.t("account:registration.failed_to_create")]})});m(this,"updateConsents",async t=>{var a;const{getAccountInfo:e}=R.getState(),{customer:r}=e();R.setState({loading:!0});try{const o=await((a=this.accountService)==null?void 0:a.updateCustomerConsents({customer:r,consents:t}));return o?(R.setState({customerConsents:o}),{responseData:o,errors:[]}):{responseData:[],errors:[]}}finally{R.setState({loading:!1})}});m(this,"getCustomerConsents",async()=>{const{getAccountInfo:t}=R.getState(),{customer:e}=t(),r=await this.accountService.getCustomerConsents({customer:e});return r&&R.setState({customerConsents:r}),r});m(this,"getPublisherConsents",async()=>{const{config:t}=z.getState();R.setState({publisherConsentsLoading:!0});const e=await this.accountService.getPublisherConsents(t);R.setState({publisherConsents:e,publisherConsentsLoading:!1})});m(this,"getCaptureStatus",async()=>{const{getAccountInfo:t}=R.getState(),{customer:e}=t();return this.accountService.getCaptureStatus({customer:e})});m(this,"updateCaptureAnswers",async t=>{const{getAccountInfo:e}=R.getState(),{customer:r,customerConsents:a}=e(),o=await this.accountService.updateCaptureAnswers({customer:r,...t});return R.setState({user:o,customerConsents:a}),o});m(this,"resetPassword",async(t,e)=>{await this.accountService.resetPassword({customerEmail:t,resetUrl:e})});m(this,"changePasswordWithOldPassword",async(t,e,r)=>{await this.accountService.changePasswordWithOldPassword({oldPassword:t,newPassword:e,newPasswordConfirmation:r})});m(this,"changePasswordWithToken",async(t,e,r,a)=>{await this.accountService.changePasswordWithResetToken({customerEmail:t,newPassword:e,resetPasswordToken:r,newPasswordConfirmation:a})});m(this,"updateSubscription",async t=>{var i;const{getAccountInfo:e}=R.getState(),{customerId:r}=e(),{subscription:a}=R.getState();if(!a)throw new Error("user has no active subscription");const o=await((i=this.subscriptionService)==null?void 0:i.updateSubscription({customerId:r,offerId:a.offerId,status:t,unsubscribeUrl:a.unsubscribeUrl}));if(o.errors.length>0)throw new Error(o.errors[0]);return await this.reloadSubscriptions({retry:10}),o==null?void 0:o.responseData});m(this,"updateCardDetails",async({cardName:t,cardNumber:e,cvc:r,expMonth:a,expYear:o,currency:i})=>{const{getAccountInfo:c}=R.getState(),{customerId:l}=c();Fe(this.subscriptionService.updateCardDetails,"updateCardDetails is not available in subscription service");const d=await this.subscriptionService.updateCardDetails({cardName:t,cardNumber:e,cvc:r,expMonth:a,expYear:o,currency:i}),u=await this.subscriptionService.getActivePayment({customerId:l})||null;return R.setState({loading:!1,activePayment:u}),d});m(this,"checkEntitlements",async t=>{if(!t)return!1;const{responseData:e}=await this.checkoutService.getEntitlements({offerId:t});return!!(e!=null&&e.accessGranted)});m(this,"reloadSubscriptions",async({delay:t,retry:e}={delay:0,retry:0})=>{var u,h;R.setState({loading:!0});const{getAccountInfo:r}=R.getState(),{customerId:a}=r(),{accessModel:o}=z.getState();if(t&&t>0)return new Promise(g=>{setTimeout(()=>{this.reloadSubscriptions({retry:e}).finally(g)},t)});if(o!=="SVOD")return await((u=this.refreshEntitlements)==null?void 0:u.call(this)),R.setState({loading:!1});const[i,c,l]=await Promise.all([this.subscriptionService.getActiveSubscription({customerId:a}),this.subscriptionService.getAllTransactions({customerId:a}),this.subscriptionService.getActivePayment({customerId:a})]);let d=null;if(!i&&e&&e>0)return await this.reloadSubscriptions({delay:1500,retry:e-1});try{if(i!=null&&i.pendingSwitchId){Fe(this.checkoutService.getOffer,"getOffer is not available in checkout service"),Fe(this.checkoutService.getSubscriptionSwitch,"getSubscriptionSwitch is not available in checkout service");const g=await this.checkoutService.getSubscriptionSwitch({switchId:i.pendingSwitchId});d=(await this.checkoutService.getOffer({offerId:g.responseData.toOfferId})).responseData}}catch(g){Ve("AccountController","Failed to fetch the pending offer",{error:g})}await((h=this.refreshEntitlements)==null?void 0:h.call(this)),R.setState({subscription:i,loading:!1,pendingOffer:d,transactions:c,activePayment:l})});m(this,"exportAccountData",async()=>{var e;const{canExportAccountData:t}=this.getFeatures();return Fe(this.accountService.exportAccountData,"exportAccountData is not available in account service"),Wn(t,"Export account"),(e=this.accountService)==null?void 0:e.exportAccountData(void 0)});m(this,"getSocialLoginUrls",t=>{const{hasSocialURLs:e}=this.getFeatures();return Fe(this.accountService.getSocialUrls,"getSocialUrls is not available in account service"),Wn(e,"Social logins"),this.accountService.getSocialUrls({redirectUrl:t})});m(this,"deleteAccountData",async t=>{const{canDeleteAccount:e}=this.getFeatures();Fe(this.accountService.deleteAccount,"deleteAccount is not available in account service"),Wn(e,"Delete account");try{await this.accountService.deleteAccount({password:t})}catch(r){throw(r instanceof Error?r.message.toLowerCase():"").includes("invalid credentials")?new Ke({form:[_e.t("user:account.delete_account.invalid_credentials")]}):new Ke({form:[_e.t("user:account.delete_account.error")]})}});m(this,"getReceipt",async t=>{Fe(this.subscriptionService.fetchReceipt,"fetchReceipt is not available in subscription service");const{responseData:e}=await this.subscriptionService.fetchReceipt({transactionId:t});return e});m(this,"getAuthData",async()=>this.accountService.getAuthData());m(this,"subscribeToNotifications",async({uuid:t,onMessage:e})=>this.accountService.subscribeToNotifications({uuid:t,onMessage:e}));m(this,"validateInputLength",t=>{var r,a;const e=[];return Number((r=t==null?void 0:t.firstName)==null?void 0:r.length)>50&&e.push(_e.t("account:validation.first_name")),Number((a=t==null?void 0:t.lastName)==null?void 0:a.length)>50&&e.push(_e.t("account:validation.last_name")),e});m(this,"clearLoginState",async()=>{R.setState({user:null,subscription:null,transactions:null,activePayment:null,customerConsents:null,publisherConsents:null,loading:!1}),await this.favoritesController.restoreFavorites(),await this.watchHistoryController.restoreWatchHistory()});this.checkoutService=At(Ts,t),this.accountService=At(wt,t),this.subscriptionService=At(Ls,t),this.favoritesController=e,this.watchHistoryController=r,this.features=t?this.accountService.features:cd}getSandbox(){return this.accountService.sandbox}getFeatures(){return this.features}async afterLogin(t,e,r=!1){R.setState({user:t,customerConsents:e}),await Promise.allSettled([this.reloadSubscriptions(),this.getPublisherConsents(),r?this.favoritesController.persistFavorites():this.favoritesController.restoreFavorites(),r?this.watchHistoryController.persistWatchHistory():this.watchHistoryController.restoreWatchHistory()]),R.setState({loading:!1})}})||Mt)||Mt)||Mt)||Mt);var uo,ho,mo,po,fo,go,tt;let Hr=(uo=ye(),ho=function(s,t){return We(jn)(s,void 0,0)},mo=function(s,t){return We(Cn)(s,void 0,1)},po=function(s,t){return We(Oe)(s,void 0,2)},fo=Reflect.metadata("design:type",Function),go=Reflect.metadata("design:paramtypes",[typeof jn>"u"?Object:jn,typeof Cn>"u"?Object:Cn,typeof Oe>"u"?Object:Oe]),uo(tt=ho(tt=mo(tt=po(tt=fo(tt=go(tt=class{constructor(t,e,r){m(this,"configService");m(this,"settingsService");m(this,"storageService");m(this,"loadAndValidateConfig",async t=>{const e=this.configService.formatSourceLocation(t),r=this.configService.getDefaultConfig();e||z.setState({config:r});let a=await this.configService.loadConfig(e);a.id=t,a.assets=a.assets||{},a.assets.banner||(a.assets.banner=r.assets.banner);const o=a.assets.banner;return z.setState(i=>{i.config.assets.banner=o}),a=await this.configService.validateConfig(a),a=Sl({},r,a),a});m(this,"initializeApp",async(t,e)=>{var c,l;Nt("AppController","Initializing app",{url:t});const r=await this.settingsService.initialize(),a=await this.settingsService.getConfigSource(r,t),o=await this.loadAndValidateConfig(a),i=this.calculateIntegrationType(o);return z.setState({config:o,loaded:!0,integrationType:i}),this.storageService.initialize("jwapp"),z.setState({settings:r}),i&&await G(fe).initialize(t,e),(c=o.features)!=null&&c.continueWatchingList&&o.content.some(d=>d.type===ht.ContinueWatching)&&await G(Qs).initialize(),(l=o.features)!=null&&l.favoritesList&&o.content.some(d=>d.type===ht.Favorites)&&await G(ks).initialize(),{config:o,settings:r,configSource:a}});m(this,"calculateIntegrationType",t=>{const r=ae.getAll(Mr).reduce((a,o)=>{const i=o(t);return i?[...a,i]:a},[]);if(r.length>1)throw new Error(`Failed to initialize app, more than 1 integrations are enabled: ${r.join(", ")}`);return r[0]||null});m(this,"getIntegrationType",()=>{const t=z.getState();if(!t.loaded)throw new Error("A call to `AppController#getIntegrationType()` was made before loading the config");return t.integrationType});this.configService=t,this.settingsService=e,this.storageService=r}})||tt)||tt)||tt)||tt)||tt)||tt);class an{}var _o,yo;const Vd=s=>s.status==="fulfilled"?!0:(Ve("EpgController","An error occurred resolving a promise: ",{error:s.reason}),!1);let uc=(_o=ye(),_o(yo=class{constructor(){m(this,"parseSchedule",async(t,e)=>{const r=!!e.scheduleDemo||!1,a=this.getEpgService(e);if(!Array.isArray(t))return[];const i=(await Promise.allSettled(t.map(c=>a==null?void 0:a.transformProgram(c).catch(l=>{Nt("EpgController","Failed to transform a program",{error:l,program:c})})))).filter(Vd).map(c=>c.value).filter(c=>!!c);return r?this.generateDemoPrograms(i):i});m(this,"getSchedule",async t=>{const e=this.getEpgService(t),r=await(e==null?void 0:e.fetchSchedule(t)),a=await this.parseSchedule(r,t),o=t.catchupHours&&parseInt(t.catchupHours);return{id:t.mediaid,title:t.title,description:t.description,catchupHours:o||8,channelLogoImage:t.channelLogoImage,backgroundImage:t.backgroundImage,programs:a}});m(this,"getEpgService",t=>{var a;const e=((a=t==null?void 0:t.scheduleType)==null?void 0:a.toLocaleLowerCase())||Rr.jwp,r=At(an,e,!1);return r||ss("EpgController",`No epg service was added for the ${e} schedule type`),r});m(this,"getSchedules",async t=>Promise.all(t.map(e=>this.getSchedule(e))))}generateDemoPrograms(t){var i;const e=new Date,r=new Date((i=t[0])==null?void 0:i.startTime),a=new Date(Date.UTC(r.getUTCFullYear(),r.getUTCMonth(),r.getUTCDate())),o=jl(e,a);return t.map((c,l)=>({...c,id:`${c.id}_${l}`,startTime:ya(new Date(c.startTime),o).toJSON(),endTime:ya(new Date(c.endTime),o).toJSON()}))}})||yo);var vo,xo;const qd=re().shape({"episode-num":re().shape({"#text":F().required()}),title:re().shape({"#text":F().required()}),desc:re().shape({"#text":F()}),icon:re().shape({src:F()}),start:F().required(),stop:F().required()}),wo=s=>Cl(s,"yyyyMdHms xxxx",new Date).toISOString();let zd=(vo=ye(),vo(xo=class extends an{constructor(){super(...arguments);m(this,"transformProgram",async e=>{var a,o,i;const r=await qd.validate(e);return{id:r["episode-num"]["#text"],title:r.title["#text"],startTime:wo(r.start),endTime:wo(r.stop),description:(a=r==null?void 0:r.desc)==null?void 0:a["#text"],cardImage:(o=r==null?void 0:r.icon)==null?void 0:o.src,backgroundImage:(i=r==null?void 0:r.icon)==null?void 0:i.src}});m(this,"fetchSchedule",async e=>{var i;const{XMLParser:r}=await zi(async()=>{const{XMLParser:c}=await import("./vendor-DL8Txhke.js").then(l=>l.f);return{XMLParser:c}},__vite__mapDeps([0,1,2])),a=e.scheduleUrl;if(!a){ss("ViewNexaEpgService","Tried requesting a schedule for an item with missing `scheduleUrl`",{item:e});return}const o={ignoreAttributes:!1,attributeNamePrefix:""};try{const c=await fetch(a).then(u=>u.text()),d=new r(o).parse(c);return((i=d==null?void 0:d.tv)==null?void 0:i.programme)||[]}catch(c){c instanceof Error&&Ve("ViewNexaEpgService",`Fetch failed for View Nexa EPG schedule: '${a}'`,{error:c})}})}})||xo);var bo,So;const Gd="API-KEY",Jd=re().shape({id:F().required(),title:F().required(),startTime:F().required().test(s=>s?xr(new Date(s)):!1),endTime:F().required().test(s=>s?xr(new Date(s)):!1),chapterPointCustomProperties:Ks().of(re().shape({key:F().required(),value:F().test("required-but-empty","value is required",s=>typeof s=="string")}))});let Yd=(bo=ye(),bo(So=class extends an{constructor(){super(...arguments);m(this,"transformProgram",async e=>{var o,i,c,l;const r=await Jd.validate(e),a=((i=(o=r.chapterPointCustomProperties)==null?void 0:o.find(d=>d.key==="image"))==null?void 0:i.value)||void 0;return{id:r.id,title:r.title,startTime:r.startTime,endTime:r.endTime,cardImage:a,backgroundImage:a,description:((l=(c=r.chapterPointCustomProperties)==null?void 0:c.find(d=>d.key==="description"))==null?void 0:l.value)||void 0}});m(this,"fetchSchedule",async e=>{if(!e.scheduleUrl){ss("JWEpgService","Tried requesting a schedule for an item with missing `scheduleUrl`",{item:e});return}const r=new Headers;e.scheduleToken&&r.set(Gd,e.scheduleToken);try{const a=await fetch(e.scheduleUrl,{headers:r});return await ct(a)}catch(a){a instanceof Error&&Ve("JWEpgService",`Fetch failed for EPG schedule: '${e.scheduleUrl}'`,{error:a})}})}})||So);class Kd{constructor(){m(this,"queue",[])}getLength(){return this.queue.length}async enqueue(){return new Promise((t,e)=>{this.queue.push({resolve:t,reject:e})})}async resolve(t){const e=this.queue.map(({resolve:r})=>r(t));this.queue=[],await Promise.allSettled(e)}async reject(t){const e=this.queue.map(({reject:r})=>r(t));this.queue=[],await Promise.allSettled(e)}}var jo,Co,ko,Eo,Bt;const zn="auth",Qd=re().shape({accessToken:F().required(),refreshToken:F().required()}),Zd=s=>Qd.isValidSync(s),Po=s=>{try{const t=Mi(s);if(typeof t.exp=="number")return t.exp*1e3}catch{}return-1};let as=(jo=ye(),Co=function(s,t){return We(sn)(s,void 0,1)},ko=Reflect.metadata("design:type",Function),Eo=Reflect.metadata("design:paramtypes",[typeof Oe>"u"?Object:Oe,typeof GetCustomerIP>"u"?Object:GetCustomerIP]),jo(Bt=Co(Bt=ko(Bt=Eo(Bt=class{constructor(t,e){m(this,"storageService");m(this,"getCustomerIP");m(this,"channel");m(this,"queue",new Kd);m(this,"isRefreshing",!1);m(this,"expiration",-1);m(this,"sandbox",!1);m(this,"tokens",null);m(this,"logoutCallback");m(this,"getNewTokens",async({refreshToken:t})=>{var e;try{const{responseData:r}=await this.post("/auths/refresh_token",JSON.stringify({refreshToken:t}));return{accessToken:r.jwt,refreshToken:r.refreshToken}}catch(r){throw r instanceof Error&&(Nt("CleengService","Failed to refresh accessToken",{error:r}),(r.message.includes("Refresh token is expired or does not exist")||r.message.includes("Missing or invalid parameter"))&&(this.logoutCallback||Nt("CleengService","logoutCallback is not set"),await((e=this.logoutCallback)==null?void 0:e.call(this)))),r}});m(this,"handleBroadcastMessage",async t=>{this.isRefreshing=t.action==="refreshing",t.tokens&&await this.setTokens(t.tokens),t.action==="resolved"?await this.queue.resolve():t.action==="rejected"&&await this.queue.reject()});m(this,"sendBroadcastMessage",(t,e)=>{const r={action:t,tokens:e};this.channel.postMessage(r)});m(this,"getBaseUrl",()=>this.sandbox?"https://mediastore-sandbox.cleeng.com":"https://mediastore.cleeng.com");m(this,"performRequest",async(t="/",e="GET",r,a={})=>{try{const o=a.authenticate?await this.getAccessTokenOrThrow():void 0;return await(await fetch(`${this.getBaseUrl()}${t}`,{headers:{Accept:"application/json","Content-Type":"application/json",Authorization:o?`Bearer ${o}`:""},keepalive:a.keepalive,method:e,body:r})).json()}catch(o){return{errors:Array.of(o instanceof Error?o.message:String(o))}}});m(this,"initialize",async(t,e)=>{this.sandbox=t,this.logoutCallback=e,await this.restoreTokensFromStorage(),await this.maybeRefreshAccessToken()});m(this,"setTokens",async t=>{this.tokens=t,this.expiration=Po(t.accessToken),await this.persistInStorage(this.tokens)});m(this,"clearTokens",async()=>{this.tokens=null,await this.persistInStorage(null)});m(this,"restoreTokensFromStorage",async()=>{const t=await this.storageService.getItem(zn,!1);let e;if(typeof t!="string")return;try{if(e=JSON.parse(t),!Zd(e))return}catch{return}const r=Po(e.accessToken);r>this.expiration&&(this.tokens=e,this.expiration=r)});m(this,"accessTokenIsExpired",()=>this.tokens?this.expiration>-1&&Date.now()-this.expiration>0:!1);m(this,"hasTokens",()=>!!this.tokens);m(this,"refreshTokens",async t=>{this.sendBroadcastMessage("refreshing"),this.isRefreshing=!0;try{const e=await this.getNewTokens(t);if(e){await this.setTokens(e),this.isRefreshing=!1,this.sendBroadcastMessage("resolved",e),await this.queue.resolve();return}}catch(e){Nt("CleengService","Failed to refresh tokens",{error:e})}await this.clearTokens(),this.isRefreshing=!1,this.sendBroadcastMessage("rejected"),await this.queue.reject()});m(this,"maybeRefreshAccessToken",async()=>{try{if(this.isRefreshing)return Nt("CleengService","Token is already refreshing, waiting in queue..."),await this.queue.enqueue();if(!this.accessTokenIsExpired()||!this.tokens)return;await this.refreshTokens(this.tokens)}catch(t){Ve("CleengService","Error caught while refreshing the access token",{error:t})}});m(this,"getAccessToken",async()=>{var t;return await this.maybeRefreshAccessToken(),await this.restoreTokensFromStorage(),(t=this.tokens)==null?void 0:t.accessToken});m(this,"getAccessTokenOrThrow",async()=>{const t=await this.getAccessToken();if(!t)throw new Error("Access token is missing");return t});m(this,"getLocales",async()=>{const t=await this.getCustomerIP();return this.get(`/locales${t?"?customerIP="+t:""}`)});m(this,"get",(t,e)=>this.performRequest(t,"GET",void 0,e));m(this,"patch",(t,e,r)=>this.performRequest(t,"PATCH",e,r));m(this,"put",(t,e,r)=>this.performRequest(t,"PUT",e,r));m(this,"post",(t,e,r)=>this.performRequest(t,"POST",e,r));m(this,"remove",(t,e)=>this.performRequest(t,"DELETE",void 0,e));this.storageService=t,this.getCustomerIP=e,this.channel=new kl("jwp-refresh-token-channel"),this.channel.addEventListener("message",this.handleBroadcastMessage)}async persistInStorage(t){t?await this.storageService.setItem(zn,JSON.stringify(t)):await this.storageService.removeItem(zn)}})||Bt)||Bt)||Bt)||Bt);const No=s=>({id:s.id,email:s.email,country:s.country,firstName:s.firstName,lastName:s.lastName,fullName:`${s.firstName} ${s.lastName}`,metadata:s.externalData||{}}),Xd=s=>({type:"checkbox",name:s.name,label:s.label,defaultValue:"",required:s.required,placeholder:s.placeholder,options:{},enabledByDefault:!1,version:s.version});var Io,Ao,To,Lo,Ut;let eu=(Io=ye(),Ao=function(s,t){return We(sn)(s,void 0,1)},To=Reflect.metadata("design:type",Function),Lo=Reflect.metadata("design:paramtypes",[typeof as>"u"?Object:as,typeof GetCustomerIP>"u"?Object:GetCustomerIP]),Io(Ut=Ao(Ut=To(Ut=Lo(Ut=class extends wt{constructor(e,r){super({canUpdateEmail:!0,canSupportEmptyFullName:!0,canChangePasswordWithOldPassword:!1,canRenewSubscription:!0,canExportAccountData:!1,canDeleteAccount:!1,canUpdatePaymentMethod:!0,canShowReceipts:!1,hasSocialURLs:!1,hasNotifications:!1,watchListSizeLimit:48});m(this,"cleengService");m(this,"getCustomerIP");m(this,"publisherId","");m(this,"externalData",{});m(this,"accessModel",$e.AUTHVOD);m(this,"svodOfferIds",[]);m(this,"sandbox",!1);m(this,"handleErrors",e=>{if(e.length>0)throw new Error(e[0])});m(this,"getCustomerIdFromAuthData",e=>Mi(e.jwt).customerId);m(this,"getCustomer",async({customerId:e})=>{const{responseData:r,errors:a}=await this.cleengService.get(`/customers/${e}`,{authenticate:!0});return this.handleErrors(a),this.externalData=r.externalData||{},No(r)});m(this,"getLocales",async()=>this.cleengService.getLocales());m(this,"initialize",async(e,r,a)=>{var i;const o=(i=e==null?void 0:e.integrations)==null?void 0:i.cleeng;if(!(o!=null&&o.id))throw new Error("Failed to initialize Cleeng integration. The publisherId is missing.");this.publisherId=o.id,this.accessModel=o.monthlyOffer||o.yearlyOffer?$e.SVOD:$e.AUTHVOD,this.svodOfferIds=[o==null?void 0:o.monthlyOffer,o==null?void 0:o.yearlyOffer].filter(Boolean).map(String),this.sandbox=!!o.useSandbox,await this.cleengService.initialize(this.sandbox,a)});m(this,"getAuthData",async()=>this.cleengService.tokens?{jwt:this.cleengService.tokens.accessToken,refreshToken:this.cleengService.tokens.refreshToken}:null);m(this,"getCustomerConsents",async e=>{var o;const{customer:r}=e,a=await this.cleengService.get(`/customers/${r==null?void 0:r.id}/consents`,{authenticate:!0});return this.handleErrors(a.errors),((o=a==null?void 0:a.responseData)==null?void 0:o.consents)||[]});m(this,"updateCustomerConsents",async e=>{const{customer:r}=e,a={id:r.id,consents:e.consents},o=await this.cleengService.put(`/customers/${r==null?void 0:r.id}/consents`,JSON.stringify(a),{authenticate:!0});return this.handleErrors(o.errors),await this.getCustomerConsents(e)});m(this,"login",async({email:e,password:r})=>{const a={email:e,password:r,publisherId:this.publisherId,customerIP:await this.getCustomerIP()},{responseData:o,errors:i}=await this.cleengService.post("/auths",JSON.stringify(a));this.handleErrors(i),await this.cleengService.setTokens({accessToken:o.jwt,refreshToken:o.refreshToken});const{user:c,customerConsents:l}=await this.getUser();return{user:c,auth:o,customerConsents:l}});m(this,"register",async({email:e,password:r,consents:a})=>{const o=await this.getLocales();this.handleErrors(o.errors);const i={email:e,password:r,locale:o.responseData.locale,country:o.responseData.country,currency:o.responseData.currency,publisherId:this.publisherId,customerIP:await this.getCustomerIP()},{responseData:c,errors:l}=await this.cleengService.post("/customers",JSON.stringify(i));this.handleErrors(l),await this.cleengService.setTokens({accessToken:c.jwt,refreshToken:c.refreshToken});const{user:d}=await this.getUser(),u=await this.updateCustomerConsents({consents:a,customer:d}).catch(()=>[]);return{user:d,auth:c,customerConsents:u}});m(this,"logout",async()=>{await this.cleengService.clearTokens()});m(this,"getUser",async()=>{const e=await this.getAuthData();if(!e)throw new Error("Not logged in");const r=this.getCustomerIdFromAuthData(e),a=await this.getCustomer({customerId:r}),o=await this.getCustomerConsents({customer:a});return{user:a,customerConsents:o}});m(this,"getPublisherConsents",async()=>{var r;const e=await this.cleengService.get(`/publishers/${this.publisherId}/consents`);return this.handleErrors(e.errors),(((r=e.responseData)==null?void 0:r.consents)||[]).map(Xd)});m(this,"getCaptureStatus",async({customer:e})=>{const r=await this.cleengService.get(`/customers/${e==null?void 0:e.id}/capture/status`,{authenticate:!0});return this.handleErrors(r.errors),r.responseData});m(this,"updateCaptureAnswers",async({customer:e,...r})=>{const a={customerId:e.id,...r},o=await this.cleengService.put(`/customers/${e.id}/capture`,JSON.stringify(a),{authenticate:!0});return this.handleErrors(o.errors),this.getCustomer({customerId:e.id})});m(this,"resetPassword",async e=>{const r=await this.cleengService.put("/customers/passwords",JSON.stringify({...e,publisherId:this.publisherId}));this.handleErrors(r.errors)});m(this,"changePasswordWithResetToken",async e=>{const r=await this.cleengService.patch("/customers/passwords",JSON.stringify({...e,publisherId:this.publisherId}));this.handleErrors(r.errors)});m(this,"changePasswordWithOldPassword",async()=>{});m(this,"updateCustomer",async e=>{const{id:r,metadata:a,fullName:o,...i}=e,c={id:r,...i},{responseData:l,errors:d}=await this.cleengService.patch(`/customers/${r}`,JSON.stringify(c),{authenticate:!0,keepalive:!0});return this.handleErrors(d),this.externalData=l.externalData||{},No(l)});m(this,"updateWatchHistory",async({user:e,history:r})=>{const a={id:e.id,externalData:{...this.externalData,history:r}},{errors:o,responseData:i}=await this.cleengService.patch(`/customers/${e.id}`,JSON.stringify(a),{authenticate:!0,keepalive:!0});this.handleErrors(o),this.externalData=i.externalData||{}});m(this,"updateFavorites",async({user:e,favorites:r})=>{const a={id:e.id,externalData:{...this.externalData,favorites:r}},{errors:o,responseData:i}=await this.cleengService.patch(`/customers/${e.id}`,JSON.stringify(a),{authenticate:!0,keepalive:!0});this.handleErrors(o),this.externalData=i.externalData||{}});m(this,"getWatchHistory",async()=>this.externalData.history||[]);m(this,"getFavorites",async()=>this.externalData.favorites||[]);m(this,"subscribeToNotifications",async()=>!1);m(this,"getSocialUrls");m(this,"exportAccountData");m(this,"deleteAccount");this.cleengService=e,this.getCustomerIP=r}})||Ut)||Ut)||Ut)||Ut);var $o,Oo,Do,Fo,Ht;let tu=($o=ye(),Oo=function(s,t){return We(sn)(s,void 0,1)},Do=Reflect.metadata("design:type",Function),Fo=Reflect.metadata("design:paramtypes",[typeof as>"u"?Object:as,typeof GetCustomerIP>"u"?Object:GetCustomerIP]),$o(Ht=Oo(Ht=Do(Ht=Fo(Ht=class extends Ts{constructor(e,r){super();m(this,"cleengService");m(this,"getCustomerIP");m(this,"getOffers",async e=>await Promise.all(e.offerIds.map(async r=>{const a=await this.getOffer({offerId:String(r)});if(a.errors.length>0)throw new Error(a.errors[0]);return a.responseData})));m(this,"getOffer",async e=>{const r=await this.getCustomerIP();return this.cleengService.get(`/offers/${e.offerId}${r?"?customerIP="+r:""}`)});m(this,"createOrder",async e=>{var i;const r=await this.cleengService.getLocales();if(r.errors.length>0)throw new Error(r.errors[0]);const a=r.responseData.ipAddress,o={offerId:e.offer.offerId,customerId:e.customerId,country:e.country,currency:((i=r==null?void 0:r.responseData)==null?void 0:i.currency)||"EUR",customerIP:a,paymentMethodId:e.paymentMethodId};return this.cleengService.post("/orders",JSON.stringify(o),{authenticate:!0})});m(this,"getOrder",async({orderId:e})=>this.cleengService.get(`/orders/${e}`,{authenticate:!0}));m(this,"updateOrder",async({order:e,...r})=>{const a=await this.cleengService.patch(`/orders/${e.id}`,JSON.stringify(r),{authenticate:!0});if(a.errors.length){if(a.errors[0].includes(`Order with ${e.id} not found`))throw new Error("Order not found");if(a.errors[0].includes(`Coupon ${r.couponCode} not found`))throw new Error("Invalid coupon code");if(a.errors[0].includes(`Coupon ${r.couponCode} cannot be applied on this offer`))throw new Error("Invalid coupon code for this offer")}return a});m(this,"getPaymentMethods",async()=>this.cleengService.get("/payment-methods",{authenticate:!0}));m(this,"paymentWithoutDetails",async e=>this.cleengService.post("/payments",JSON.stringify(e),{authenticate:!0}));m(this,"paymentWithPayPal",async e=>{const{order:r,successUrl:a,cancelUrl:o,errorUrl:i}=e,c={orderId:r.id,successUrl:a,cancelUrl:o,errorUrl:i};return this.cleengService.post("/connectors/paypal/v1/tokens",JSON.stringify(c),{authenticate:!0})});m(this,"getSubscriptionSwitches",async e=>this.cleengService.get(`/customers/${e.customerId}/subscription_switches/${e.offerId}/availability`,{authenticate:!0}));m(this,"getSubscriptionSwitch",async e=>this.cleengService.get(`/subscription_switches/${e.switchId}`,{authenticate:!0}));m(this,"switchSubscription",async e=>this.cleengService.post(`/customers/${e.customerId}/subscription_switches/${e.offerId}`,JSON.stringify({toOfferId:e.toOfferId,switchDirection:e.switchDirection}),{authenticate:!0}));m(this,"getEntitlements",async e=>this.cleengService.get(`/entitlements/${e.offerId}`,{authenticate:!0}));m(this,"createAdyenPaymentSession",async e=>await this.cleengService.post("/connectors/adyen/sessions",JSON.stringify(e),{authenticate:!0}));m(this,"initialAdyenPayment",async e=>this.cleengService.post("/connectors/adyen/initial-payment",JSON.stringify({...e,attemptAuthentication:this.cleengService.sandbox?"always":void 0}),{authenticate:!0}));m(this,"finalizeAdyenPayment",async e=>this.cleengService.post("/connectors/adyen/initial-payment/finalize",JSON.stringify(e),{authenticate:!0}));m(this,"updatePaymentMethodWithPayPal",async e=>this.cleengService.post("/connectors/paypal/v1/payment_details/tokens",JSON.stringify(e),{authenticate:!0}));m(this,"deletePaymentMethod",async e=>this.cleengService.remove(`/payment_details/${e.paymentDetailsId}`,{authenticate:!0}));m(this,"addAdyenPaymentDetails",async e=>this.cleengService.post("/connectors/adyen/payment-details",JSON.stringify({...e,attemptAuthentication:this.cleengService.sandbox?"always":void 0}),{authenticate:!0}));m(this,"finalizeAdyenPaymentDetails",async e=>this.cleengService.post("/connectors/adyen/payment-details/finalize",JSON.stringify(e),{authenticate:!0}));m(this,"directPostCardPayment",async()=>!1);this.cleengService=e,this.getCustomerIP=r}})||Ht)||Ht)||Ht)||Ht);var Ro,Mo,Bo,fs;let su=(Ro=ye(),Mo=Reflect.metadata("design:type",Function),Bo=Reflect.metadata("design:paramtypes",[typeof as>"u"?Object:as]),Ro(fs=Mo(fs=Bo(fs=class extends Ls{constructor(e){super();m(this,"cleengService");m(this,"getActiveSubscription",async({customerId:e})=>{const r=await this.getSubscriptions({customerId:e});return r.errors.length>0?null:r.responseData.items.find(a=>a.status==="active"||a.status==="cancelled")||null});m(this,"getAllTransactions",async({customerId:e})=>{const r=await this.getTransactions({customerId:e});return r.errors.length>0?null:r.responseData.items});m(this,"getActivePayment",async({customerId:e})=>{const r=await this.getPaymentDetails({customerId:e});return r.errors.length>0?null:r.responseData.paymentDetails.find(a=>a.active)||null});m(this,"getSubscriptions",async e=>this.cleengService.get(`/customers/${e.customerId}/subscriptions`,{authenticate:!0}));m(this,"updateSubscription",async e=>this.cleengService.patch(`/customers/${e.customerId}/subscriptions`,JSON.stringify(e),{authenticate:!0}));m(this,"getPaymentDetails",async e=>this.cleengService.get(`/customers/${e.customerId}/payment_details`,{authenticate:!0}));m(this,"getTransactions",async({customerId:e,limit:r,offset:a})=>this.cleengService.get(Se(`/customers/${e}/transactions`,{limit:r,offset:a}),{authenticate:!0}));m(this,"fetchReceipt",async({transactionId:e})=>this.cleengService.get(`/receipt/${e}`,{authenticate:!0}));m(this,"updateCardDetails");m(this,"changeSubscription");this.cleengService=e}})||fs)||fs)||fs);const nu=(s,t)=>{var a;const e=s.menu.find(o=>o.contentId===t);return((a=e==null?void 0:e.filterTags)==null?void 0:a.split(",").filter(Boolean))||[]},ru=(s,t)=>t===""?s:{...s,playlist:s.playlist.filter(({tags:e})=>e?e.split(",").includes(t):!1)},hc=(s=15)=>({title:"",playlist:new Array(s).fill({}).map((t,e)=>({description:"",duration:0,feedid:"",image:"",images:[],cardImage:"",backgroundImage:"",channelLogoImage:"",link:"",genre:"",mediaid:`placeholder_${e}`,pubdate:0,rating:"",sources:[],tags:"",title:"",tracks:[]}))}),au=(s=[],t=[])=>!s||!t?{}:s==null?void 0:s.reduce((r,a)=>{const o=t==null?void 0:t.find(i=>i.name===a.name);if(o){const i=a.isCustomRegisterField?o.value??"":o.state==="accepted";r[a.name]=i}return r},{}),ou=(s=[],t=[])=>{if(!s||!t)return{};const e={};return s==null||s.forEach(r=>{t!=null&&t.find(a=>a.name===r.name&&a.state==="accepted")&&(e[r.name]=!0)}),e},iu=s=>{const t={};return s&&(s==null||s.forEach(e=>{t[e.name]=e.type==="checkbox"?e.enabledByDefault===!0:e.defaultValue??""})),t},kn=(s,t)=>{const e=[];return!s||!t||s.forEach(r=>{e.push({name:r.name,version:r.version,state:t[r.name]?"accepted":"declined",value:t[r.name]??""})}),e},cu=(s,t)=>{const e=[],r=[];return!s||!t?{customerConsents:e,consentsErrors:r}:(s.forEach(a=>{a.required&&!t[a.name]&&r.push(a.name),e.push({name:a.name,version:a.version,state:t[a.name]?"accepted":"declined",value:t[a.name]??""})}),{customerConsents:e,consentsErrors:r})},lu=s=>s.value!=="",du=({name:s,value:t=""},e,r)=>{const a=s==="us_state"?r.find(({name:i,value:c})=>i==="country"&&c==="us")?t==="n/a"?"":t:"n/a":(t===!0||t===!1)&&s!=="terms"?t?"on":"off":t;return[s,a]},Er=s=>Object.fromEntries(s.filter(lu).map(du)),Uo=s=>Array.isArray(s)||typeof s=="object"&&s!==null?JSON.parse(JSON.stringify(s)):s,mc=s=>{if(typeof s=="string"&&id.includes(s))return s},pc=s=>{if(!s)return 0;const t=s.split(":");return t.length===2?Math.floor(parseInt(t[1])/parseInt(t[0])):0};var Ho,Wo,Vo,gs;const uu="https://inplayer.com/legal/terms";let hu=(Ho=ye(),Wo=Reflect.metadata("design:type",Function),Vo=Reflect.metadata("design:paramtypes",[typeof Oe>"u"?Object:Oe,typeof Te>"u"?Object:Te]),Ho(gs=Wo(gs=Vo(gs=class extends wt{constructor(e,r){super({canUpdateEmail:!1,canSupportEmptyFullName:!1,canChangePasswordWithOldPassword:!0,canRenewSubscription:!1,canExportAccountData:!0,canUpdatePaymentMethod:!1,canShowReceipts:!0,canDeleteAccount:!0,hasNotifications:!0,hasSocialURLs:!0,watchListSizeLimit:48});m(this,"storageService");m(this,"apiService");m(this,"clientId","");m(this,"accessModel",$e.AUTHVOD);m(this,"assetId",null);m(this,"svodOfferIds",[]);m(this,"sandbox",!1);m(this,"parseJson",(e,r={})=>{try{return JSON.parse(e)}catch{return r}});m(this,"formatFavorite",e=>({mediaid:e.media_id}));m(this,"formatHistoryItem",e=>({mediaid:e.media_id,progress:e.progress}));m(this,"formatAccount",e=>{const{id:r,uuid:a,email:o,full_name:i,metadata:c,created_at:l}=e,d=new Date(l*1e3).toLocaleString(),u=c==null?void 0:c.first_name,h=c==null?void 0:c.surname;return{id:r.toString(),uuid:a,email:o,fullName:i,firstName:u,lastName:h,metadata:c,regDate:d,country:"",lastUserIp:""}});m(this,"initialize",async(e,r,a)=>{var h;const o=(h=e.integrations)==null?void 0:h.jwp;if(!(o!=null&&o.clientId))throw new Error("Failed to initialize JWP integration. The clientId is missing.");this.sandbox=!!o.useSandbox;const i=this.sandbox?"development":"production";Rs.setConfig(i),this.apiService.setup(this.sandbox),o.clientId&&(this.clientId=o.clientId),o.assetId&&(this.accessModel=$e.SVOD,this.assetId=o.assetId,this.svodOfferIds=o.assetId?[String(o.assetId)]:[]);const c=new URLSearchParams(r.split("#")[1]),l=c.get("token"),d=c.get("refresh_token"),u=c.get("expires");!l||!d||!u||this.apiService.setToken(l,d,parseInt(u))});m(this,"getAuthData",async()=>{if(await this.apiService.isAuthenticated()){const e=await this.apiService.getToken();return{jwt:e.token,refreshToken:e.refreshToken}}return null});m(this,"getPublisherConsents",async()=>{try{const e=await this.apiService.get(`/accounts/register-fields/${this.clientId}`),r=e==null?void 0:e.collection.find(({name:o})=>o==="terms"),a=e==null?void 0:e.collection.filter(o=>!["email_confirmation","first_name","surname"].includes(o.name)&&![r].includes(o)).map(o=>({type:o.type,isCustomRegisterField:!0,name:o.name,label:o.label,placeholder:o.placeholder,required:o.required,options:o.options,defaultValue:"",version:"1",...o.type==="checkbox"?{enabledByDefault:o.default_value==="true"}:{defaultValue:o.default_value}}));return r?[this.getTermsConsent(r),...a]:a}catch{throw new Error("Failed to fetch publisher consents.")}});m(this,"getCustomerConsents",async e=>{var r;try{if(!(e!=null&&e.customer))return{consents:[]};const{customer:a}=e;return this.parseJson((r=a.metadata)==null?void 0:r.consents,[])}catch{throw new Error("Unable to fetch Customer consents.")}});m(this,"updateCustomerConsents",async e=>{var r;try{const{customer:a,consents:o}=e,i=this.formatUpdateAccount(a),c={...i,metadata:{...i.metadata,...Er(o),consents:JSON.stringify(o)}},l=await this.apiService.put("/accounts",c,{withAuthentication:!0});return this.parseJson((r=l==null?void 0:l.metadata)==null?void 0:r.consents,[])}catch{throw new Error("Unable to update Customer consents")}});m(this,"updateCaptureAnswers",async({customer:e,...r})=>this.updateCustomer({...e,...r}));m(this,"changePasswordWithOldPassword",async e=>{const{oldPassword:r,newPassword:a,newPasswordConfirmation:o}=e;try{await this.apiService.post("/accounts/change-password",{old_password:r,password:a,password_confirmation:o},{withAuthentication:!0})}catch(i){throw Te.isCommonError(i)?new Error(i.response.data.message):new Error("Failed to change password")}});m(this,"resetPassword",async({customerEmail:e})=>{try{await this.apiService.post("/accounts/forgot-password",{email:e,merchant_uuid:this.clientId,branding_id:0})}catch{throw new Error("Failed to reset password.")}});m(this,"login",async({email:e,password:r,referrer:a})=>{var o;try{const i=await this.apiService.post("/v2/accounts/authenticate",{client_id:this.clientId||"",grant_type:"password",referrer:a,username:e,password:r});this.apiService.setToken(i.access_token,"",i.expires);const c=this.formatAccount(i.account);return{auth:this.formatAuth(i),user:c,customerConsents:this.parseJson((o=c==null?void 0:c.metadata)==null?void 0:o.consents,[])}}catch{throw new Error("Failed to authenticate user.")}});m(this,"register",async({email:e,password:r,referrer:a,consents:o})=>{var i;try{const c=await this.apiService.post("/accounts",{full_name:e,username:e,password:r,password_confirmation:r,client_id:this.clientId||"",type:"consumer",referrer:a,grant_type:"password",metadata:{first_name:" ",surname:" ",...Er(o),consents:JSON.stringify(o)}});this.apiService.setToken(c.access_token,"",c.expires);const l=this.formatAccount(c.account);return{auth:this.formatAuth(c),user:l,customerConsents:this.parseJson((i=l==null?void 0:l.metadata)==null?void 0:i.consents,[])}}catch(c){throw Te.isCommonError(c)?new Error(c.response.data.message):new Error("Failed to create account.")}});m(this,"logout",async()=>{try{Rs.Notifications.isSubscribed()&&Rs.Notifications.unsubscribe(),await this.apiService.isAuthenticated()&&(await this.apiService.get("/accounts/logout",{withAuthentication:!0}),await this.apiService.removeToken())}catch{throw new Error("Failed to sign out.")}});m(this,"getUser",async()=>{var e;try{const r=await this.apiService.get("/accounts",{withAuthentication:!0}),a=this.formatAccount(r);return{user:a,customerConsents:this.parseJson((e=a==null?void 0:a.metadata)==null?void 0:e.consents,[])}}catch{throw new Error("Failed to fetch user data.")}});m(this,"updateCustomer",async e=>{try{const r=await this.apiService.put("/accounts",this.formatUpdateAccount(e),{withAuthentication:!0});return this.formatAccount(r)}catch{throw new Error("Failed to update user data.")}});m(this,"formatUpdateAccount",e=>{var l,d;const r=((l=e.firstName)==null?void 0:l.trim())||"",a=((d=e.lastName)==null?void 0:d.trim())||"",o=`${r} ${a}`.trim()||e.email,i={...e.metadata,first_name:r,surname:a};return{full_name:o,metadata:i}});m(this,"getCaptureStatus",async({customer:{firstName:e,lastName:r}})=>{const a=(e==null?void 0:e.trim())||"",o=(r==null?void 0:r.trim())||"";return{isCaptureEnabled:!0,shouldCaptureBeDisplayed:!a||!o,settings:[{answer:{firstName:a||null,lastName:o||null},enabled:!0,key:"firstNameLastName",required:!0}]}});m(this,"changePasswordWithResetToken",async e=>{const{resetPasswordToken:r="",newPassword:a,newPasswordConfirmation:o=""}=e;try{await this.apiService.put(`/accounts/forgot-password/${r}`,{password:a,password_confirmation:o,branding_id:0})}catch(i){throw Te.isCommonError(i)?new Error(i.response.data.message):new Error("Failed to change password.")}});m(this,"getTermsConsent",({label:e})=>{const r=`<a href="${e||uu}" target="_blank">${_e.t("account:registration.terms_and_conditions")}</a>`;return{type:"checkbox",isCustomRegisterField:!0,required:!0,name:"terms",defaultValue:"",label:e?_e.t("account:registration.terms_consent",{termsLink:r}):_e.t("account:registration.terms_consent_jwplayer",{termsLink:r}),enabledByDefault:!1,placeholder:"",options:{},version:"1"}});m(this,"updateWatchHistory",async({history:e})=>{const r=await this.getWatchHistory(),a=r.map(o=>o.mediaid)||[];await Promise.allSettled(e.map(({mediaid:o,progress:i})=>{if(!a.includes(o)||r.some(c=>c.mediaid==o&&c.progress!=i))return this.apiService.patch("/v2/accounts/media/watch-history",{media_id:o,progress:i},{withAuthentication:!0})}))});m(this,"updateFavorites",async({favorites:e})=>{const a=(await this.getFavorites()).map(i=>i.mediaid)||[],o=e.map(i=>i.mediaid);await Promise.allSettled(o.map(i=>a.includes(i)?Promise.resolve():this.apiService.post("/v2/accounts/media/favorites",{media_id:i},{withAuthentication:!0}))),await Promise.allSettled(a.map(i=>o.includes(i)?Promise.resolve():this.apiService.remove(`/v2/accounts/media/favorites/${i}`,{withAuthentication:!0})))});m(this,"getFavorites",async()=>{var r;const e=await this.apiService.get("/v2/accounts/media/favorites",{withAuthentication:!0});return((r=e==null?void 0:e.collection)==null?void 0:r.map(this.formatFavorite))||[]});m(this,"getWatchHistory",async()=>{var r;const e=await this.apiService.get("/v2/accounts/media/watch-history",{withAuthentication:!0},{filter:"currently_watching"});return((r=e==null?void 0:e.collection)==null?void 0:r.map(this.formatHistoryItem))||[]});m(this,"subscribeToNotifications",async({uuid:e,onMessage:r})=>{try{return Rs.Notifications.isSubscribed()||Rs.subscribe(e,{onMessage:r,onOpen:()=>!0}),!0}catch{return!1}});m(this,"exportAccountData",async()=>{try{return await this.apiService.post("/accounts/export",{password:void 0,branding_id:0},{withAuthentication:!0})}catch{throw new Error("Failed to export account data")}});m(this,"deleteAccount",async({password:e})=>{try{return await this.apiService.remove("/accounts/erase",{withAuthentication:!0},{password:e,branding_id:0})}catch(r){throw Te.isCommonError(r)?new Error(r.response.data.message||"Failed to delete account"):new Error("Failed to delete account")}});m(this,"getSocialUrls",async({redirectUrl:e})=>{const r=this.storageService.base64Encode(JSON.stringify({client_id:this.clientId||"",redirect:e})),a=await this.apiService.get("/accounts/social",{includeFullResponse:!0},{state:r});if(a.status!==200)throw new Error("Failed to fetch social urls");return a.data.social_urls});this.storageService=e,this.apiService=r}formatAuth(e){const{access_token:r}=e;return{jwt:r,refreshToken:""}}})||gs)||gs)||gs);const Wr=s=>s?`${Math.ceil(s/60)} min`:"",fc=s=>{if(!s)return"";const t=Math.floor(s/3600),e=Math.round((s-t*3600)/60),r=t?`${t}hrs `:"",a=e?`${e}min `:"";return`${r}${a}`},nt=(s,t,e)=>new Intl.NumberFormat(e||"en-US",{style:"currency",currency:t}).format(s),Ln=(s,t)=>!s&&!t?"":s&&s!=="0"?`S${s}:E${t}`:`E${t}`,mu=(s,t,e)=>t?e?`${En(t,s," • ")} - ${gc(e,s)}`:En(t,s," • "):"",vt=(s,t)=>new Intl.DateTimeFormat(t,{day:"numeric",month:"long",year:"numeric"}).format(s),gc=(s,t)=>new Intl.DateTimeFormat(t,{hour:"numeric",minute:"numeric"}).format(s),En=(s,t,e=" ")=>`${vt(s,t)}${e}${gc(s,t)}`,pu=s=>nt(s.customerPriceInclTax,s.customerCurrency,s.customerCountry),Vr=s=>{var t;return((t=s.offerId)==null?void 0:t[0])==="S"};var qo,zo,Go,Jo,Wt;let fu=(qo=ye(),zo=function(s,t){return We(Te)(s,void 0,0)},Go=Reflect.metadata("design:type",Function),Jo=Reflect.metadata("design:paramtypes",[typeof Te>"u"?Object:Te]),qo(Wt=zo(Wt=Go(Wt=Jo(Wt=class extends Ts{constructor(e){super();m(this,"cardPaymentProvider","stripe");m(this,"apiService");m(this,"formatPaymentMethod",(e,r)=>({id:e.id,methodName:e.method_name.toLocaleLowerCase(),provider:r,logoUrl:""}));m(this,"formatEntitlements",(e=0,r=!1)=>({errors:[],responseData:{accessGranted:r,expiresAt:e}}));m(this,"formatOffer",e=>({id:e.id,offerId:this.formatOfferId(e),offerCurrency:e.currency,customerPriceInclTax:e.amount,customerCurrency:e.currency,offerTitle:e.description,active:!0,period:e.access_type.period==="month"&&e.access_type.quantity===12?"year":e.access_type.period,freePeriods:e.trial_period?1:0,planSwitchEnabled:e.item.plan_switch_enabled??!1}));m(this,"formatOrder",e=>({id:e.offer.id,customerId:e.customerId,offerId:e.offer.offerId,totalPrice:e.offer.customerPriceInclTax,priceBreakdown:{offerPrice:e.offer.customerPriceInclTax,discountAmount:e.offer.customerPriceInclTax,discountedPrice:e.offer.customerPriceInclTax,paymentMethodFee:0,taxValue:0},taxRate:0,currency:e.offer.offerCurrency||"EUR",requiredPaymentDetails:!0}));m(this,"createOrder",async e=>({errors:[],responseData:{message:"",order:this.formatOrder(e),success:!0}}));m(this,"getOffers",async e=>(await Promise.all(e.offerIds.map(async a=>{try{const o=await this.apiService.get(`/v2/items/${this.parseOfferId(a)}/access-fees`);return o==null?void 0:o.map(i=>this.formatOffer(i))}catch{throw new Error("Failed to get offers")}}))).flat());m(this,"getPaymentMethods",async()=>{try{const e=await this.apiService.get("/payments/methods",{withAuthentication:!0}),r=[];return e.forEach(a=>{["card","paypal"].includes(a.method_name.toLowerCase())&&r.push(this.formatPaymentMethod(a,this.cardPaymentProvider))}),{errors:[],responseData:{message:"",paymentMethods:r,status:1}}}catch{throw new Error("Failed to get payment methods")}});m(this,"paymentWithPayPal",async e=>{try{const r=await this.apiService.post("/external-payments",{origin:e.waitingUrl,access_fee:e.order.id,payment_method:2,voucher_code:e.couponCode},{withAuthentication:!0});return r!=null&&r.id?{errors:["Already have an active access"],responseData:{redirectUrl:e.errorUrl}}:{errors:[],responseData:{redirectUrl:r.endpoint}}}catch{throw new Error("Failed to generate PayPal payment url")}});m(this,"iFrameCardPayment",async()=>({errors:[],responseData:{}}));m(this,"paymentWithoutDetails",async()=>({errors:[],responseData:{}}));m(this,"updateOrder",async({order:e,couponCode:r})=>{try{const a=await this.apiService.post("/vouchers/discount",{voucher_code:`${r}`,access_fee_id:e.id},{withAuthentication:!0}),o=e.totalPrice-a.amount,i={...e,totalPrice:a.amount,priceBreakdown:{...e.priceBreakdown,discountAmount:o,discountedPrice:o},discount:{applied:!0,type:"coupon",periods:a.discount_duration}};return{errors:[],responseData:{message:"successfully updated",order:i,success:!0}}}catch(a){throw Te.isCommonError(a)&&a.response.data.message==="Voucher not found"?new Error("Invalid coupon code"):new Error("An unknown error occurred")}});m(this,"getEntitlements",async({offerId:e})=>{try{const r=await this.apiService.get(`/items/${this.parseOfferId(e)}/access`,{withAuthentication:!0});return this.formatEntitlements(r.expires_at,!0)}catch{return this.formatEntitlements()}});m(this,"directPostCardPayment",async(e,r,a,o)=>{const i={number:e.cardNumber.replace(/\s/g,""),card_name:e.cardholderName,exp_month:e.cardExpMonth||"",exp_year:e.cardExpYear||"",cvv:e.cardCVC,access_fee:r.id,payment_method:1,voucher_code:e.couponCode,referrer:a,return_url:o};try{return Vr(r)?await this.apiService.post("/subscriptions",i,{withAuthentication:!0}):await this.apiService.post("/payments",i,{withAuthentication:!0}),!0}catch{throw new Error("Failed to make payment")}});m(this,"getSubscriptionSwitches");m(this,"getOrder");m(this,"switchSubscription");m(this,"getSubscriptionSwitch");m(this,"createAdyenPaymentSession");m(this,"initialAdyenPayment");m(this,"finalizeAdyenPayment");m(this,"updatePaymentMethodWithPayPal");m(this,"deletePaymentMethod");m(this,"addAdyenPaymentDetails");m(this,"finalizeAdyenPaymentDetails");m(this,"getOffer");this.apiService=e}formatOfferId(e){return["ppv","ppv_custom"].includes(e.access_type.name)?`C${e.item_id}_${e.id}`:`S${e.item_id}_${e.id}`}parseOfferId(e){return typeof e=="string"?e.startsWith("C")||e.startsWith("S")?parseInt(e.slice(1).split("_")[0]):parseInt(e):e}})||Wt)||Wt)||Wt)||Wt);var Yo,Ko,Qo,Zo,Xo,gt;let gu=(Yo=ye(),Ko=function(s,t){return El("JWP")(s,void 0,0)},Qo=function(s,t){return We(Te)(s,void 0,1)},Zo=Reflect.metadata("design:type",Function),Xo=Reflect.metadata("design:paramtypes",[typeof wt>"u"?Object:wt,typeof Te>"u"?Object:Te]),Yo(gt=Ko(gt=Qo(gt=Zo(gt=Xo(gt=class extends Ls{constructor(e,r){super();m(this,"accountService");m(this,"apiService");m(this,"formatCardDetails",e=>{const{number:r,exp_month:a,exp_year:o,card_name:i,card_type:c,account_id:l,currency:d}=e,u=`0${a}`.slice(-2);return{id:0,paymentMethodId:0,paymentGateway:"card",paymentMethod:"card",customerId:l.toString(),paymentMethodSpecificParams:{holderName:i,variant:c,lastCardFourDigits:String(r),cardExpirationDate:`${u}/${o}`},active:!0,currency:d}});m(this,"formatTransaction",e=>{var a,o,i;const r=((a=e==null?void 0:e.charged_amount)==null?void 0:a.toString())||"0";return{transactionId:e.transaction_token||_e.t("user:payment.access_granted"),transactionDate:e.created_at,trxToken:e.trx_token,offerId:((o=e.item_id)==null?void 0:o.toString())||_e.t("user:payment.no_transaction"),offerType:e.item_type||"",offerTitle:(e==null?void 0:e.item_title)||"",offerPeriod:"",transactionPriceExclTax:r,transactionCurrency:e.currency_iso||"EUR",discountedOfferPrice:r,offerCurrency:e.currency_iso||"EUR",offerPriceExclTax:r,applicableTax:"0",transactionPriceInclTax:r,customerId:(i=e.consumer_id)==null?void 0:i.toString(),customerEmail:"",customerLocale:"",customerCountry:"en",customerIpCountry:"",customerCurrency:"",paymentMethod:e.payment_method_name||_e.t("user:payment.access_granted")}});m(this,"formatActiveSubscription",(e,r)=>{var o,i;let a="";switch(e.action_type){case"free-trial":a="active_trial";break;case"recurrent":a="active";break;case"canceled":a="cancelled";break;case"incomplete_expired":a="expired";break;default:a="terminated"}return{subscriptionId:e.subscription_id,offerId:(o=e.item_id)==null?void 0:o.toString(),accessFeeId:`S${e.access_fee_id}`,status:a,expiresAt:r,nextPaymentAt:e.next_rebill_date,nextPaymentPrice:e.subscription_price,nextPaymentCurrency:e.currency,paymentGateway:"stripe",paymentMethod:e.payment_method_name,offerTitle:e.item_title,period:(i=e.access_type)==null?void 0:i.period,totalPrice:e.charged_amount,unsubscribeUrl:e.unsubscribe_url,pendingSwitchId:null}});m(this,"formatGrantedSubscription",e=>({subscriptionId:"",offerId:e.item.id.toString(),status:"active",expiresAt:e.expires_at,nextPaymentAt:e.expires_at,nextPaymentPrice:0,nextPaymentCurrency:"EUR",paymentGateway:"none",paymentMethod:_e.t("user:payment.access_granted"),offerTitle:e.item.title,period:"granted",totalPrice:0,unsubscribeUrl:"",pendingSwitchId:null}));m(this,"getActiveSubscription",async()=>{const e=this.accountService.assetId;if(e===null)throw new Error("Couldn't fetch active subscription, there is no assetId configured");try{const r=await this.apiService.get(`/items/${e}/access`,{withAuthentication:!0});if(r){const o=(await this.apiService.get("/subscriptions",{withAuthentication:!0,contentType:"json"},{limit:15,page:0})).collection.find(i=>i.item_id===e);return o?this.formatActiveSubscription(o,r==null?void 0:r.expires_at):this.formatGrantedSubscription(r)}return null}catch(r){if(Te.isCommonError(r)&&r.response.data.code===402)return null;throw new Error("Unable to fetch customer subscriptions.")}});m(this,"getAllTransactions",async()=>{var e;try{const r=await this.apiService.get("/v2/accounting/payment-history",{withAuthentication:!0,contentType:"json"});return(e=r==null?void 0:r.collection)==null?void 0:e.map(a=>this.formatTransaction(a))}catch{throw new Error("Failed to get transactions")}});m(this,"getActivePayment",async()=>{var e;try{const r=await this.apiService.get("/v2/payments/cards/default",{withAuthentication:!0,contentType:"json"}),a=[];for(const o in r==null?void 0:r.cards)a.push(this.formatCardDetails({...(e=r.cards)==null?void 0:e[o],currency:o}));return a.find(o=>o.active)||null}catch{return null}});m(this,"getSubscriptions",async()=>({errors:[],responseData:{items:[]}}));m(this,"updateSubscription",async({offerId:e,unsubscribeUrl:r})=>{if(!r)throw new Error("Missing unsubscribe url");try{return await this.apiService.get(r,{withAuthentication:!0,contentType:"json"}),{errors:[],responseData:{offerId:e,status:"cancelled",expiresAt:0}}}catch{throw new Error("Failed to update subscription")}});m(this,"changeSubscription",async({accessFeeId:e,subscriptionId:r})=>{try{const a=await this.apiService.post("/v2/subscriptions/stripe:switch",{inplayer_token:r,access_fee_id:e},{withAuthentication:!0});return{errors:[],responseData:{message:a.message}}}catch{throw new Error("Failed to change subscription")}});m(this,"updateCardDetails",async({cardName:e,cardNumber:r,cvc:a,expMonth:o,expYear:i,currency:c})=>{try{const l=await this.apiService.put("/v2/payments/cards/default",{number:r,card_name:e,cvv:a,exp_month:o,exp_year:i,currency_iso:c},{withAuthentication:!0});return{errors:[],responseData:l}}catch{throw new Error("Failed to update card details")}});m(this,"fetchReceipt",async({transactionId:e})=>{try{const r=await this.apiService.get(`/v2/accounting/transactions/${e}/receipt`,{withAuthentication:!0,contentType:"json",responseType:"blob"});return{errors:[],responseData:r}}catch{throw new Error("Failed to get billing receipt")}});m(this,"getPaymentDetails");m(this,"getTransactions");this.accountService=e,this.apiService=r}})||gt)||gt)||gt)||gt)||gt);const _u=s=>s.container.get(Hr).getIntegrationType(),yu=s=>{var t,e;return(e=(t=s.integrations)==null?void 0:t.cleeng)!=null&&e.id?Kt.CLEENG:null},vu=s=>{var t,e;return(e=(t=s.integrations)==null?void 0:t.jwp)!=null&&e.clientId?Kt.JWP:null};ae.bind(jn).toSelf();ae.bind(Cr).toSelf();ae.bind(kr).toSelf();ae.bind(lc).toSelf();ae.bind(Me).toSelf();ae.bind(Cn).toSelf();ae.bind(Hr).toSelf();ae.bind(Qs).toSelf();ae.bind(ks).toSelf();ae.bind(uc).toSelf();ae.bind(fe).toSelf();ae.bind(St).toSelf();ae.bind(an).to(Yd).whenTargetNamed(Rr.jwp);ae.bind(an).to(zd).whenTargetNamed(Rr.viewNexa);ae.bind(tn).toDynamicValue(_u);ae.bind(Mr).toConstantValue(yu);ae.bind(as).toSelf();ae.bind(wt).to(eu).whenTargetNamed(Kt.CLEENG);ae.bind(Ts).to(tu).whenTargetNamed(Kt.CLEENG);ae.bind(Ls).to(su).whenTargetNamed(Kt.CLEENG);ae.bind(Mr).toConstantValue(vu);ae.bind(Te).toSelf();ae.bind(dc).toSelf();ae.bind(wt).to(hu).whenTargetNamed(Kt.JWP);ae.bind(Ts).to(fu).whenTargetNamed(Kt.JWP);ae.bind(Ls).to(gu).whenTargetNamed(Kt.JWP);class xu extends Ur{constructor(t){super(),this.logLevel=t}log(t,e,r,a,o){if(!(t<this.logLevel)){switch(t){case Xe.ERROR:case Xe.FATAL:console.error(`${Xe[t]} [${e}] ${r}`);break;case Xe.WARN:console.warn(`${Xe[t]} [${e}] ${r}`);break;default:console.log(`${Xe[t]} [${e}] ${r}`)}o&&console.error(o),a&&Object.keys(a).length>0&&console.log(a)}}}var ei,ti;let wu=(ei=ye(),ei(ti=class extends Oe{constructor(){super(...arguments);m(this,"prefix","jwapp")}initialize(e){this.prefix=e}getStorageKey(e){return`${this.prefix}.${e}`}async getItem(e,r,a=!0){try{const o=window.localStorage.getItem(a?this.getStorageKey(e):e);return o&&r?JSON.parse(o):o}catch(o){Ve("LocalStorageService","Failed to parse localStorage entry",{error:o})}}async setItem(e,r,a=!0){try{window.localStorage.setItem(a?this.getStorageKey(e):e,r)}catch(o){Ve("LocalStorageService","Failed to store localStorage entry",{error:o})}}async removeItem(e){try{window.localStorage.removeItem(this.getStorageKey(e))}catch(r){Ve("LocalStorageService","Failed to remove localStorage entry",{error:r})}}base64Encode(e){return window.btoa(e)}base64Decode(e){return window.atob(e)}})||ti);ae.bind(Oe).to(wu);ae.bind(sn).toConstantValue(async()=>void 0);ae.bind(Ur).toDynamicValue(()=>new xu(Xe.ERROR));const _c=new Pl({defaultOptions:{queries:{staleTime:60*60*1e3,refetchOnWindowFocus:!1,retryOnMount:!1}}});function bu({children:s}){return n.jsx(Nl,{client:_c,children:s})}const Su="_errorPage_1k9zf_1",ju="_box_1k9zf_17",Cu="_title_1k9zf_22",ku="_message_1k9zf_29",Eu="_main_1k9zf_33",Pu="_logo_1k9zf_47",Nu="_links_1k9zf_51",Iu="_stack_1k9zf_55",Au="_image_1k9zf_60",_s={errorPage:Su,box:ju,title:Cu,message:ku,main:Eu,logo:Pu,links:Nu,stack:Iu,image:Au},et=({title:s,message:t,learnMoreLabel:e,...r})=>{const{t:a}=A("error");return n.jsx(yc,{title:s||a("generic_error_heading"),message:t||a("generic_error_description"),learnMoreLabel:e||a("learn_more"),...r})},yc=({title:s,children:t,message:e,learnMoreLabel:r,error:a,helpLink:o})=>{const i=z(l=>{var d,u;return(u=(d=l.config)==null?void 0:d.assets)==null?void 0:u.banner});return n.jsx("div",{className:_s.errorPage,children:n.jsxs("div",{className:_s.box,children:[n.jsx("img",{className:_s.image,src:i||"/images/logo.png",alt:""}),n.jsx("h1",{className:_s.title,"aria-live":"polite",children:s||"An error occurred"}),n.jsxs("div",{className:_s.main,children:[n.jsx("p",{className:_s.message,children:e||"Try refreshing this page or come back later."}),t,fd]})]})})},Tu="_buffer_rrxgr_1",Lu="_small_rrxgr_20",$u="_large_rrxgr_30",Gn={buffer:Tu,small:Lu,large:$u},is=({size:s="medium",className:t=""})=>n.jsxs("div",{className:B(Gn.buffer,t,{[Gn.small]:s==="small",[Gn.large]:s==="large"}),children:[n.jsx("div",{}),n.jsx("div",{}),n.jsx("div",{}),n.jsx("div",{})]}),Ou="_loadingOverlay_96qzh_1",Du="_fixed_96qzh_7",Fu="_transparent_96qzh_17",Ru="_inline_96qzh_21",mn={loadingOverlay:Ou,fixed:Du,transparent:Fu,inline:Ru},xe=({transparentBackground:s=!1,inline:t=!1})=>{const e=B(mn.loadingOverlay,{[mn.transparent]:s,[mn.fixed]:!t,[mn.inline]:t});return n.jsx("div",{className:e,children:n.jsx(is,{size:"medium"})})},Mu="_formFeedback_1hyv5_1",Bu="_info_1hyv5_11",Uu="_error_1hyv5_16",Hu="_warning_1hyv5_21",Wu="_success_1hyv5_26",Ms={formFeedback:Mu,info:Bu,error:Uu,warning:Hu,success:Wu},Vu={info:"polite",success:"assertive",warning:"polite",error:"assertive"},Pe=({children:s,variant:t="error",visible:e=!0})=>{const r=B(Ms.formFeedback,{[Ms.error]:t==="error",[Ms.warning]:t==="warning",[Ms.success]:t==="success",[Ms.info]:t==="info",hidden:!e}),a=Vu[t];return n.jsx("div",{"aria-live":a,className:r,children:s})},vc=p.createContext(void 0),Ge=()=>{const s=p.useContext(vc);if(!s)throw new Error("Announcer context is not defined");return s.announce},qu=({children:s})=>{const[t,e]=p.useState(null),r=p.useCallback((a,o,i=Il(10))=>{e({message:a,variant:o}),setTimeout(()=>{e(null)},i)},[]);return n.jsxs(vc.Provider,{value:{announce:r},children:[t&&fl.createPortal(n.jsx(Pe,{variant:t.variant,visible:!1,children:t.message}),document.body),s]})};function HS(s){throw new Error('Could not dynamically require "'+s+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}const zu=(s,t)=>t.reduce((e,r)=>{const a=s.find(({code:o})=>o===r);if(a)return[...e,a];throw new Error(`Missing defined language for code: ${r}`)},[]),Gu=["account","common","country","demo","epg","error","menu","search","us_state","user","video"],Ju=[{code:"en",displayName:"English"},{code:"es",displayName:"Español"}],Yu=async()=>{const s="en,es".split(",")||[],t="en",e=zu(Ju,s);if(z.setState({supportedLanguages:e}),!e.some(({code:r})=>r===t))throw new Error(`The default language is not enabled: ${t}`);await _e.use(Al).use(Tl).use(Ll).init({supportedLngs:e.map(({code:r})=>r),fallbackLng:t,returnEmptyString:!1,ns:Gu,defaultNS:"common",fallbackNS:"common",interpolation:{escapeValue:!1},detection:{order:["localStorage","navigator"],caches:["localStorage"],lookupLocalStorage:"jwapp.language"},react:{useSuspense:!1}})},xc=(s,t={})=>Se(`${s.pathname}${s.search||""}`,t),V=(s,t,e)=>Se(`${s.pathname}${s.search||""}`,{u:t,...e}),It=(s,t)=>Se(window.location.href,{u:s,...t}),ge=s=>{const t=p.useRef(()=>{throw new Error("Callback called in render")});return p.useLayoutEffect(()=>{t.current=s},[s]),p.useCallback((...e)=>{if(typeof t.current=="function")return t.current(...e)},[])};function Re(s){const[t]=Xs();return t.get(s)}const Ku=(s,t=1,e)=>{const r=p.useRef(),[a,o]=p.useState(s);return p.useEffect(()=>{if(window.clearTimeout(r.current),a===0){e&&e();return}return r.current=window.setTimeout(()=>{o(i=>i-t)},t*1e3),()=>{window.clearTimeout(r.current)}},[e,a,t]),a},Qu="_button_1h3d0_1",Zu="_disabled_1h3d0_21",Xu="_small_1h3d0_33",eh="_large_1h3d0_36",th="_primary_1h3d0_46",sh="_outlined_1h3d0_53",nh="_active_1h3d0_56",rh="_text_1h3d0_62",ah="_danger_1h3d0_77",oh="_fullWidth_1h3d0_87",ih="_startIcon_1h3d0_101",ch="_hidden_1h3d0_119",lh="_centerAbsolute_1h3d0_123",it={button:Qu,disabled:Zu,small:Xu,large:eh,default:"_default_1h3d0_39",primary:th,outlined:sh,active:nh,text:rh,danger:ah,delete:"_delete_1h3d0_82",fullWidth:oh,startIcon:ih,hidden:ch,centerAbsolute:lh},D=({label:s,children:t,color:e="default",startIcon:r,fullWidth:a=!1,active:o=!1,variant:i="outlined",size:c="medium",disabled:l,busy:d,type:u="button",to:h,onClick:g,className:_,activeClassname:f="",...x})=>{const y=b=>B(it.button,_,it[e],it[i],{[it.active]:b,[f]:b,[it.fullWidth]:a,[it.large]:c==="large",[it.small]:c==="small",[it.disabled]:l}),v=n.jsxs(n.Fragment,{children:[r&&n.jsx("div",{className:it.startIcon,children:r}),n.jsx("span",{className:B({[it.hidden]:d})||void 0,children:s}),t,d&&n.jsx(is,{className:it.centerAbsolute,size:"small"})]});return h?n.jsx(Bi,{className:({isActive:b})=>y(b),to:h,...x,end:!0,children:v}):n.jsx("button",{className:y(o),onClick:l?void 0:g,type:u,"aria-disabled":l,...x,children:v})},dh="_welcome_v7d1f_1",uh={welcome:dh},hh=({onCloseButtonClick:s,onCountdownCompleted:t,siteName:e})=>{const{t:r}=A("account"),a=Ku(10,1,t);return n.jsxs("div",{className:uh.welcome,children:[n.jsx("h2",{children:r("checkout.welcome_title",{siteName:e})}),n.jsx("p",{children:r("checkout.welcome_description",{siteName:e})}),n.jsx(D,{variant:"contained",color:"primary",label:r("checkout.start_watching",{countdown:a}),onClick:s,size:"large",fullWidth:!0})]})},mh="_title_82pz9_1",ph="_message_82pz9_6",si={title:mh,message:ph},ni=({type:s,message:t,onCloseButtonClick:e})=>{const{t:r}=A("account");return n.jsxs("div",{children:[n.jsx("h2",{className:si.title,children:r(s==="cancelled"?"checkout.payment_cancelled":"checkout.payment_error")}),n.jsx("p",{className:si.message,children:s==="cancelled"?r("checkout.payment_cancelled_message"):t}),n.jsx("div",{children:n.jsx(D,{label:r("checkout.close"),onClick:e,color:"primary",variant:"contained",size:"large",fullWidth:!0})})]})},qr=({className:s,createStyle:t,open:e=!0,duration:r=250,delay:a=0,onOpenAnimationEnd:o,onCloseAnimationEnd:i,keepMounted:c=!1,children:l})=>{const[d,u]=p.useState("closed"),[h,g]=p.useState(!1),_=p.useRef(),f=p.useRef(),x=ge(()=>{g(!0),_.current=window.setTimeout(()=>u("opening"),a),f.current=window.setTimeout(()=>{u("open"),o&&o()},r+a)}),y=ge(()=>{h&&(_.current=window.setTimeout(()=>u("closing"),a),f.current=window.setTimeout(()=>{u("closed"),i&&i()},r+a))});return p.useEffect(()=>(e?x():y(),()=>{clearTimeout(_.current),clearTimeout(f.current)}),[e,x,y]),!e&&d==="closed"&&!c?null:n.jsx("div",{style:t(d),className:s,children:l})},fh=({open:s=!0,duration:t=250,delay:e=0,onOpenAnimationEnd:r,onCloseAnimationEnd:a,children:o,className:i})=>{const l=`transform ${t/1e3}s ease-out`,d=u=>({transition:l,transform:u==="opening"||u==="open"?"scale(1)":"scale(0.7)"});return n.jsx(qr,{createStyle:u=>d(u),open:s,duration:t,delay:e,onOpenAnimationEnd:r,onCloseAnimationEnd:a,className:i,children:o})},gh=!!(typeof window<"u"&&window.document&&window.document.createElement);let pn;function _h(s){if((!pn&&pn!==0||s)&&gh){const t=document.createElement("div");t.style.position="absolute",t.style.top="-9999px",t.style.width="50px",t.style.height="50px",t.style.overflow="scroll",document.body.appendChild(t),pn=t.offsetWidth-t.clientWidth,document.body.removeChild(t)}return pn}const wc=s=>new Promise(t=>{const e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src=s,e.onload=()=>t(),e.onerror=r=>{throw console.info("Error loading external script",r),new Error("Error loading external script")},document.body.appendChild(e)}),yh=()=>{document.body.style.marginRight=`${_h(!0)}px`,document.body.style.overflowY="hidden"},ri=()=>{Array.from(document.querySelectorAll("dialog")).filter(e=>e.open).length||(document.body.style.removeProperty("margin-right"),document.body.style.removeProperty("overflow-y"))};let Bs;const vh=()=>{const s=p.useCallback(()=>{if(!Bs||document.activeElement!==document.body)return;Array.from(document.querySelectorAll("dialog")).filter(o=>o.open).length===0&&(Bs.focus(),Bs=void 0)},[]);p.useEffect(()=>()=>{ri(),s()},[s]);const t=p.useCallback(()=>{Bs||(Bs=document.activeElement),yh()},[]),e=p.useCallback(()=>{s(),ri()},[s]);return{handleOpen:t,handleClose:e}},xh="_centered_evruy_15",wh="_close_evruy_21",fn={centered:xh,close:wh,"fade-out":"_fade-out_evruy_1","fade-in":"_fade-in_evruy_1"},$n=({open:s,onClose:t,children:e,className:r,centered:a,role:o,AnimationComponent:i=fh,animationContainerClassName:c,...l})=>{const d=p.useRef(),{handleOpen:u,handleClose:h}=vh(),g=ge(()=>{var w;const b=()=>{var j,S;(j=d.current)==null||j.classList.remove(fn.close),(S=d.current)==null||S.removeEventListener("animationend",b)};(w=d.current)!=null&&w.open&&(d.current.addEventListener("animationend",b),d.current.classList.add(fn.close))}),_=ge(()=>{var b,w;u(),(b=d.current)==null||b.showModal(),(w=d.current)==null||w.classList.remove(fn.close)}),f=b=>{b.key==="Escape"&&d.current.contains(b.target)&&(b.preventDefault(),t==null||t())},x=b=>{d.current.contains(b.target)&&(t==null||t(),h())},y=()=>{var b;(b=d.current)==null||b.close()};p.useEffect(()=>{s?_():g()},[_,g,s]);const v=b=>{b.target===d.current&&(t==null||t(),h())};return gl.createPortal(n.jsx("dialog",{className:B(r,{[fn.centered]:a}),onKeyDown:f,onClose:x,onClick:v,ref:d,role:o,...l,children:n.jsx(i,{open:s,duration:300,className:c,onCloseAnimationEnd:y,children:e})}),document.querySelector("body"))},zr=({open:s=!0,duration:t=250,delay:e=0,onOpenAnimationEnd:r,onCloseAnimationEnd:a,children:o,direction:i="top",style:c={}})=>{const l=t/1e3,d=`transform ${l}s ease, opacity ${l}s ease`,u={left:"translate(-15px, 0)",top:"translate(0, -15px)",right:"translate(15px, 0)",bottom:"translate(0, 15px)"},h=g=>({transition:d,transform:g==="opening"||g==="open"?"translate(0, 0)":u[i],opacity:g==="opening"||g==="open"?1:0,zIndex:15,...c});return n.jsx(qr,{createStyle:g=>h(g),open:s,duration:t,delay:e,onOpenAnimationEnd:r,onCloseAnimationEnd:a,children:o})},On=s=>p.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},p.createElement("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),p.createElement("path",{d:"M0 0h24v24H0z",fill:"none"})),bh="_iconButton_12yfl_1",Sh={iconButton:bh},ze=({children:s,onClick:t,className:e,...r})=>n.jsx("button",{className:B(Sh.iconButton,e),type:"button",onClick:t,...r,children:s}),jh="_icon_1me4h_1",Ch={icon:jh},J=({icon:s,className:t})=>n.jsx(s,{className:B(Ch.icon,t),"aria-hidden":"true"}),kh="_modalCloseButton_1qofm_1",Eh="_hidden_1qofm_15",ai={modalCloseButton:kh,hidden:Eh},bc=({onClick:s,visible:t=!0})=>{const{t:e}=A("common");return n.jsx(ze,{onClick:s,"aria-label":e("close_modal"),className:B(ai.modalCloseButton,{[ai.hidden]:!t}),children:n.jsx(J,{icon:On})})},Ph="_dialog_1ha9n_1",Nh="_small_1ha9n_16",Ih="_large_1ha9n_20",oi={dialog:Ph,small:Nh,large:Ih},Gr=({open:s,onClose:t,children:e,size:r="small",role:a,...o})=>n.jsx($n,{open:s,onClose:t,AnimationComponent:zr,role:a,centered:!0,children:n.jsxs("div",{className:B(oi.dialog,oi[r]),"data-testid":void 0,...o,children:[e,n.jsx(bc,{onClick:t})]})});function jt({initialValues:s,validationSchema:t,validateOnBlur:e=!1,onSubmit:r,onSubmitSuccess:a,onSubmitError:o}){const{t:i}=A("error"),[c,l]=p.useState(Object.fromEntries(Object.keys(s).map(E=>[E,!1]))),[d,u]=p.useState(s),[h,g]=p.useState(!1),[_,f]=p.useState({}),[x,y]=p.useState(!1),v=p.useCallback(()=>{u(s),f({}),y(!1),g(!1),l(Object.fromEntries(Object.keys(s).map(E=>[E,!1])))},[s]),b=(E,P)=>{if(t)try{t.validateSyncAt(E,P),f(N=>({...N,[E]:null}))}catch(N){if(N instanceof va){const $=N.errors[0];f(O=>({...O,[E]:$})),y(!0)}}},w=p.useCallback((E,P)=>{u(N=>({...N,[E]:P}))},[]),j=E=>{const P=E.target.name,N=E.target instanceof HTMLInputElement&&E.target.type==="checkbox"?E.target.checked:E.target.value,$={...d,[P]:N};u($),l(O=>({...O,[P]:N})),_[P]&&b(P,$)},S=E=>{!e||!c[E.target.name]||b(E.target.name,d)},C=E=>{try{return E.validateSync(d,{abortEarly:!1}),!0}catch(P){if(P instanceof va){const N={};for(let $=0;$<P.inner.length;$++){const O=P.inner[$].path,U=P.inner[$].errors[0];O&&U&&!N[O]&&(N[O]=U)}P.inner.every($=>$.type==="required")?N.form=i("validation_form_error.required"):N.form=i("validation_form_error.other"),f(N)}}return!1};return{values:d,errors:_,validationSchemaError:x,handleChange:j,handleBlur:S,handleSubmit:async E=>{if(E.preventDefault(),!(!r||h)){if(f({}),y(!1),t&&!C(t)){y(!0);return}g(!0);try{await r(d,{setValue:w,setErrors:f,setSubmitting:g,setValidationSchemaError:y,validate:C}),a==null||a(d)}catch(P){const N={};P instanceof Ke?Object.entries(P.errors).forEach(([$,O])=>{$&&O&&!N[$]&&(N[$]=O.join(","))}):P instanceof Error?N.form=P.message:N.form=i("unknown_error"),f(N),o==null||o({error:P,resetValue:$=>w($,"")})}g(!1)}},submitting:h,setValue:w,setErrors:f,setSubmitting:g,setValidationSchemaError:y,reset:v}}const Jr=(s=!1)=>{const[t,e]=p.useState(s);return[t,a=>e(o=>typeof a<"u"?a:!o)]},Yr=s=>p.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},p.createElement("path",{d:"M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9M12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17M12,4.5C7,4.5 2.73,7.61 1,12C2.73,16.39 7,19.5 12,19.5C17,19.5 21.27,16.39 23,12C21.27,7.61 17,4.5 12,4.5Z"})),Kr=s=>p.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},p.createElement("path",{d:"M11.83,9L15,12.16C15,12.11 15,12.05 15,12A3,3 0 0,0 12,9C11.94,9 11.89,9 11.83,9M7.53,9.8L9.08,11.35C9.03,11.56 9,11.77 9,12A3,3 0 0,0 12,15C12.22,15 12.44,14.97 12.65,14.92L14.2,16.47C13.53,16.8 12.79,17 12,17A5,5 0 0,1 7,12C7,11.21 7.2,10.47 7.53,9.8M2,4.27L4.28,6.55L4.73,7C3.08,8.3 1.78,10 1,12C2.73,16.39 7,19.5 12,19.5C13.55,19.5 15.03,19.2 16.38,18.66L16.81,19.08L19.73,22L21,20.73L3.27,3M12,7A5,5 0 0,1 17,12C17,12.64 16.87,13.26 16.64,13.82L19.57,16.75C21.07,15.5 22.27,13.86 23,12C21.27,7.61 17,4.5 12,4.5C10.6,4.5 9.26,4.75 8,5.2L10.17,7.35C10.74,7.13 11.35,7 12,7Z"})),ii=(s,t)=>{const e=Math.random()*1e4;return[s,Math.round(e),t].filter(Boolean).join("_").replace(/[\s.]+/g,"_").toLowerCase()},ot=(s,t,e)=>{const[r,a]=p.useState(e||ii(s,t));return p.useEffect(()=>{a(e||ii(s,t))},[e,s,t]),r},Ah="_helperText_1u6a3_1",Th="_error_1u6a3_6",ci={helperText:Ah,error:Th},Lh=({children:s,className:t,error:e,id:r})=>{const a=ot("helper_text",void 0,r);return s?n.jsx("div",{id:a,className:B(ci.helperText,{[ci.error]:e},t),children:s}):null},$h="_formField_130lt_1",Oh="_label_130lt_6",li={formField:$h,label:Oh},on=({className:s,renderInput:t,required:e,label:r,error:a,helperText:o,testId:i,editing:c=!0,name:l})=>{const d=B(li.formField,s),u=ot("text-field",l),h=ot("helper_text",l);return n.jsxs("div",{className:d,"data-testid":i,children:[!!r&&n.jsxs("label",{htmlFor:u,className:li.label,children:[r,e&&c?n.jsx("span",{"aria-hidden":"true",children:"*"}):null]}),t({helperTextId:h,id:u}),c&&n.jsx(Lh,{id:h,error:a,children:o})]})},Dh="_container_bm5y7_1",Fh="_error_bm5y7_10",Rh="_disabled_bm5y7_13",Mh="_leftControl_bm5y7_16",Bh="_input_bm5y7_16",Uh="_rightControl_bm5y7_19",Hh="_control_bm5y7_31",Vt={container:Dh,error:Fh,disabled:Rh,leftControl:Mh,input:Bh,rightControl:Uh,control:Hh},Wh=(s,t)=>!!t,Vh=({required:s,className:t,disabled:e,editing:r=!0,value:a,id:o,name:i,multiline:c,error:l,helperTextId:d,type:u,textAreaRef:h,inputRef:g,leftControl:_,rightControl:f,...x})=>{const y=u||"text",v=B(Vt.container,{[Vt.error]:l,[Vt.disabled]:e,[Vt.leftControl]:!!_,[Vt.rightControl]:!!f},t),b={"aria-required":!!s,"aria-invalid":!!(s&&l&&a!==""),"aria-describedby":d},w={id:o,name:i,value:a,disabled:e,rows:c?3:void 0,className:Vt.input,readOnly:!r,required:s,...b,...x},j=Wh(w,c)?n.jsx("textarea",{...w,ref:h}):n.jsx("input",{...w,type:y,ref:g});return r?n.jsxs("div",{className:v,children:[_?n.jsx("div",{className:Vt.control,children:_}):null,j,f?n.jsx("div",{className:Vt.control,children:f}):null]}):j},qh="_textField_cksfq_1",zh={textField:qh},de=({className:s,helperText:t,label:e,error:r,required:a,editing:o=!0,testId:i,name:c,...l})=>n.jsx(on,{className:B(zh.textField,s),error:r,helperText:t,label:e,required:a,editing:o,testId:i,name:c,renderInput:d=>n.jsx(Vh,{editing:o,error:r,name:c,required:a,...d,...l})}),Gh="_passwordStrength_1od1i_1",Jh="_passwordStrengthFill_1od1i_9",Yh="_label_1od1i_13",Kh="_passwordStrengthBar_1od1i_38",gn={passwordStrength:Gh,passwordStrengthFill:Jh,label:Yh,passwordStrengthBar:Kh},Qh=/^(?=.*[a-z])(?=.*[0-9]).{8,}$/,Zh=({password:s})=>{const{t}=A("account"),r=(o=>{let i=0;return o.match(Qh)&&(o.match(/[A-Z]+/)&&(i+=1),o.match(/(\d.*\d)/)&&(i+=1),o.match(/[!,@#$%^&*?_~]/)&&(i+=1),o.match(/([!,@#$%^&*?_~].*[!,@#$%^&*?_~])/)&&(i+=1)),i})(s),a=[t("registration.password_strength.invalid"),t("registration.password_strength.weak"),t("registration.password_strength.fair"),t("registration.password_strength.strong"),t("registration.password_strength.very_strong")];return r?n.jsxs("div",{className:gn.passwordStrength,"data-strength":r,children:[n.jsx("div",{className:gn.passwordStrengthBar,children:n.jsx("div",{className:gn.passwordStrengthFill})}),n.jsx("span",{className:"hidden",children:t("registration.password_strength_prefix")})," ",n.jsx("span",{className:gn.label,children:a[r]})]}):null},Ys=({value:s,showToggleView:t=!0,helperText:e,showHelperText:r=!0,...a})=>{const{t:o}=A("account"),[i,c]=Jr();return n.jsx(de,{...a,helperText:e??(r?n.jsxs(Ee.Fragment,{children:[n.jsx(Zh,{password:s||""}),o("reset.password_helper_text")]}):null),type:i?"text":"password",rightControl:t?n.jsx(ze,{"aria-label":o("reset.view_password"),onClick:()=>c(),"aria-pressed":i,children:n.jsx(J,{icon:i?Yr:Kr})}):null,required:!0})},Xh="_heading_1ungm_1",em="_paragraph_1ungm_7",tm="_disclaimer_1ungm_11",sm="_buttons_1ungm_25",nm="_stacked_1ungm_34",rm="_warningBox_1ungm_40",qt={heading:Xh,paragraph:em,disclaimer:tm,buttons:sm,stacked:nm,warningBox:rm},am=()=>{const s=G(fe),{t}=A("user"),e=Ge(),r=Re("u"),[a,o]=p.useState(""),i=oe(),c=le(),{handleSubmit:l,handleChange:d,values:u,errors:h,setErrors:g,reset:_}=jt({initialValues:{password:""},validationSchema:re().shape({password:F().required(t("login.field_required"))}),onSubmit:y=>{o(y.password),i(V(c,"delete-account-confirmation"),{replace:!0})}}),f=rt(s.deleteAccountData,{onSuccess:async()=>{i("/"),await s.logout(),e(t("account.delete_account.success"),"success")},onError:y=>{y instanceof Ke&&(g(y.errors),i(V(c,"delete-account"),{replace:!0})),o("")}});p.useEffect(()=>{r==="delete-account-confirmation"&&!a&&i(V(c,"delete-account"),{replace:!0})},[c,r,i,a,f,_]);const x=p.useCallback(()=>{i(V(c,null),{replace:!0})},[c,i]);return a?n.jsxs("div",{children:[n.jsx("h2",{className:qt.heading,children:t("account.delete_account.title")}),n.jsxs("div",{className:qt.disclaimer,children:[n.jsx("p",{children:t("account.delete_account.modal.text_data_erasure")}),n.jsx("p",{children:t("account.delete_account.modal.text_revoked_access")}),n.jsx("div",{className:qt.warningBox,children:n.jsx("p",{children:t("account.delete_account.modal.warning")})}),n.jsxs("p",{children:[t("account.delete_account.modal.text_cant_be_undone")," ",n.jsx("br",{}),t("account.delete_account.modal.text_contacts")]})]}),n.jsxs("div",{className:qt.buttons,children:[n.jsx(D,{disabled:f.isLoading,variant:"text",label:t("account.cancel"),onClick:x}),n.jsx(D,{disabled:f.isLoading,variant:"delete",label:t("account.delete_account.title"),onClick:()=>{f.mutate(a)}})]})]}):n.jsxs("form",{onSubmit:l,children:[n.jsx("h2",{className:qt.heading,children:t("account.delete_account.title")}),n.jsx("p",{className:qt.paragraph,children:t("account.delete_account.modal.description")}),h.form&&n.jsx(Pe,{variant:"error",children:h.form}),n.jsx(Ys,{value:u.password,onChange:d,label:t("account.password"),placeholder:t("account.delete_account.modal.placeholder"),error:!!h.password||!!h.form,helperText:h.password,name:"password",showHelperText:!1}),n.jsxs("div",{className:B(qt.buttons,qt.stacked),children:[n.jsx(D,{type:"submit",color:"primary",label:t("account.continue"),fullWidth:!0}),n.jsx(D,{type:"button",onClick:x,variant:"text",label:t("account.cancel"),fullWidth:!0})]})]})},om="_container_lkpac_1",im="_title_lkpac_7",di={container:om,title:im},cm=()=>{const s=G(fe),t=G(St),{t:e}=A("account"),r=Ge(),a=oe(),o=le(),{accessModel:i}=z(({accessModel:f})=>({accessModel:f})),[c]=Xs(),l=c.get("redirectResult"),d=c.get("orderId"),[u,h]=p.useState(),g=p.useMemo(()=>V(o,i===$e.SVOD?"welcome":null),[i,o]),_=ge(async f=>{const x=d?parseInt(d,10):void 0;try{await t.finalizeAdyenPayment({redirectResult:decodeURI(f)},x),await s.reloadSubscriptions({retry:10}),r(e("checkout.payment_success"),"success"),a(g)}catch(y){y instanceof Error&&h(y.message)}});return p.useEffect(()=>{l&&_(l)},[_,l]),n.jsx("div",{className:di.container,children:u?n.jsxs(n.Fragment,{children:[n.jsx("h2",{className:di.title,children:u}),n.jsx(D,{label:e("checkout.go_back_to_checkout"),variant:"contained",color:"primary",size:"large",onClick:()=>a(V(o,"checkout")),fullWidth:!0})]}):n.jsx("div",{children:n.jsx(is,{})})})},lm=()=>{const s=G(fe),t=G(St),e=p.useRef(),[r,a]=p.useState(null),{t:o}=A("user"),i=t.getSubscriptionOfferIds(),c=p.useCallback(({interval:l=3e3,iterations:d=5,offerId:u=i==null?void 0:i[0],callback:h})=>{if(!u){h==null||h({hasAccess:!1,offerId:""});return}e.current=window.setInterval(async()=>{await s.checkEntitlements(u)?(window.clearInterval(e.current),await s.reloadSubscriptions(),h==null||h({hasAccess:!0,offerId:u||""})):--d===0&&(window.clearInterval(e.current),a(o("payment.longer_than_usual")),h==null||h({hasAccess:!1,offerId:u||""}))},l)},[i,o,s]);return p.useEffect(()=>()=>{window.clearInterval(e.current)},[]),{intervalCheckAccess:c,errorMessage:r}},dm="_center_153q1_1",um={center:dm},hm=()=>{const{t:s}=A("account"),t=Re("offerId")||void 0,e=le(),r=oe(),a=Ge(),{intervalCheckAccess:o,errorMessage:i}=lm();return p.useEffect(()=>{o({interval:3e3,iterations:5,offerId:t,callback:({hasAccess:c,offerId:l})=>{c&&(a(s("checkout.payment_success"),"success"),l.startsWith("C")||l.startsWith("P")?r(V(e,null)):r(V(e,"welcome")))}})},[]),n.jsx("div",{className:um.center,children:i?n.jsx("h2",{children:i}):n.jsxs(n.Fragment,{children:[n.jsx(is,{}),n.jsx("h2",{children:s("checkout.waiting_for_payment")})]})})},mm="_title_1edbn_1",pm="_message_1edbn_8",ui={title:mm,message:pm},Jn=({type:s,onCloseButtonClick:t})=>{const{t:e}=A("account"),r=Ge(),a=e(`checkout.upgrade_${s}`),o=e(`checkout.upgrade_${s}_message`);return p.useEffect(()=>{const i={error:"error",success:"succes",pending:"info"}[s];r(o,i)},[r,o,s]),n.jsxs("div",{children:[n.jsx("h2",{className:ui.title,children:a}),n.jsx("p",{className:ui.message,children:o}),n.jsx("div",{children:n.jsx(D,{label:e("checkout.close"),onClick:t,color:"primary",variant:"contained",size:"large",fullWidth:!0})})]})},fm="_formFeedback_173nk_1",gm="_formContainer_173nk_5",_m="_passwordButtonsContainer_173nk_13",ym="_buttonsContainer_173nk_21",vm="_heading_173nk_30",xm="_paragraph_173nk_40",wm="_button_173nk_21",Zt={formFeedback:fm,formContainer:gm,passwordButtonsContainer:_m,buttonsContainer:ym,heading:vm,paragraph:xm,button:wm},bm=()=>{const s=G(fe),{t}=A("user"),e=R(d=>{var u;return(u=d.user)==null?void 0:u.email}),[r,a]=p.useState(),o=oe(),i=le(),c=p.useCallback(()=>{o(V(i,null),{replace:!0})},[i,o]),l=async()=>{try{e&&(await s.resetPassword(e,""),o(V(i,"add-password")))}catch{a(t("account.add_password_error"))}};return n.jsxs("div",{className:Zt.formContainer,children:[r&&n.jsx("div",{className:Zt.formFeedback,children:n.jsx(Pe,{variant:"error",children:r})}),n.jsx("h2",{className:Zt.heading,children:t("account.delete_account_password_warning.title")}),n.jsx("p",{className:Zt.paragraph,children:t("account.delete_account_password_warning.text")}),n.jsxs("div",{className:Zt.passwordButtonsContainer,children:[n.jsx(D,{type:"submit",onClick:l,className:Zt.button,color:"primary",fullWidth:!0,label:t("account.proceed_to_adding_a_password")}),n.jsx(D,{type:"button",onClick:c,className:Zt.button,variant:"text",fullWidth:!0,label:t("account.cancel")})]})]})},Sc=s=>p.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},p.createElement("path",{fill:"currentColor",d:"M20,8H4V6H20M20,18H4V12H20M20,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V6C22,4.89 21.1,4 20,4Z"})),Qr=s=>p.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},p.createElement("path",{d:"M7.37083 12.6026c-.70164 0-1.28549-.0571-1.72496-.1142l-1.34375 6.9595H.179688L3.83225.516163C5.08988.201006 7.07827 0 8.97801 0c1.75279 0 3.79949.286619 5.23309 1.28917 1.3172.88839 2.1354 2.23464 2.1354 4.0958 0 2.4344-1.1386 4.26703-2.6901 5.44083-1.6084 1.2333-3.8881 1.7768-6.28557 1.7768zm1.72496-9.30834c-.78902 0-1.34375.05832-1.69457.14393L6.28924 9.13832c.43821.08561.90681.14269 1.60845.14269 2.54311 0 4.20851-1.60433 4.20851-3.52257 0-1.8624-1.3741-2.46418-3.01041-2.46418zm7.22271.21844c.523.18487 1.0195.4169 1.4552.72213 1.3158.88715 2.1353 2.23339 2.1365 4.09456 0 2.43441-1.1398 4.26701-2.69 5.44201-1.6084 1.2321-3.8869 1.7756-6.2856 1.7756-.7016 0-1.28676-.0571-1.72497-.1154l-1.34501 6.9595H3.74219l.31915-1.6577h1.30702l1.34502-6.9582c.4382.057 1.02206.1141 1.72496.1141 2.39746 0 4.67586-.5447 6.28556-1.7755 1.549-1.1738 2.6888-3.00769 2.6888-5.44209 0-1.29909-.4053-2.34258-1.0942-3.15901z"})),Sm="_title_1tanv_1",jm="_success_1tanv_8",Cm="_paymentMethodsInputs_1tanv_12",km="_paymentMethod_1tanv_12",Em="_paymentMethodLabel_1tanv_22",Pm="_radio_1tanv_30",kt={title:Sm,success:jm,paymentMethodsInputs:Cm,paymentMethod:km,paymentMethodLabel:Em,radio:Pm},Nm=({paymentMethodId:s,paymentMethods:t,onCloseButtonClick:e,onPaymentMethodChange:r,renderPaymentMethod:a,submitting:o,updateSuccess:i})=>{const{t:c}=A("account"),l=Ge(),d=t==null?void 0:t.find(h=>h.methodName==="card"),u=t==null?void 0:t.find(h=>h.methodName==="paypal");return p.useEffect(()=>{i&&l(c("checkout.payment_success"),"success")},[i,l,c]),n.jsxs(n.Fragment,{children:[n.jsx("h1",{className:kt.title,children:c("payment.update_payment_details")}),i?n.jsxs(n.Fragment,{children:[n.jsx("p",{className:kt.success,children:c("payment.update_payment_success")}),n.jsx(D,{label:c("payment.back_to_profile"),onClick:e,color:"primary",fullWidth:!0})]}):n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:kt.paymentMethodsInputs,children:[d?n.jsxs("div",{className:kt.paymentMethod,children:[n.jsx("input",{className:kt.radio,type:"radio",name:"paymentMethod",value:d.id,id:"card",checked:s===d.id,onChange:r}),n.jsxs("label",{className:kt.paymentMethodLabel,htmlFor:"card",children:[n.jsx(J,{icon:Sc}),c("payment.credit_card")]})]}):null,u?n.jsxs("div",{className:kt.paymentMethod,children:[n.jsx("input",{className:kt.radio,type:"radio",name:"paymentMethod",value:u.id,id:"paypal",checked:s===u.id,onChange:r}),n.jsxs("label",{className:kt.paymentMethodLabel,htmlFor:"paypal",children:[n.jsx(J,{icon:Qr})," ",c("payment.paypal")]})]}):null]}),n.jsx("div",{children:a?a():null}),o&&n.jsx(xe,{transparentBackground:!0,inline:!0})]})]})},Im="_payPal_17v1t_1",Am={payPal:Im},jc=({onSubmit:s,error:t})=>{const{t:e}=A("account");return n.jsxs("div",{className:Am.payPal,children:[t?n.jsx(Pe,{variant:"error",children:t}):null,n.jsx("p",{children:e("checkout.paypal_instructions")}),n.jsx(D,{label:e("checkout.continue"),variant:"contained",color:"primary",size:"large",onClick:s,fullWidth:!0})]})},Tm="_adyen_1wab6_1",Lm="_container_1wab6_5",hi={adyen:Tm,container:Lm},Cc=({configuration:s,error:t,type:e})=>{const{t:r}=A("account"),a=p.useRef(null),o=p.useRef();return p.useEffect(()=>!a.current||!s.session?void 0:((async()=>{var l;const c=await $l(s);a.current&&(o.current=c.create(e),(l=o.current)==null||l.mount(a.current))})(),()=>{var c;(c=o.current)==null||c.unmount()}),[s,e]),n.jsxs("div",{className:hi.adyen,children:[t?n.jsx(Pe,{variant:"error",children:t}):null,n.jsx("div",{className:hi.container,ref:a}),n.jsx(D,{label:r("checkout.continue"),variant:"contained",color:"primary",size:"large",onClick:()=>{o.current&&o.current.submit()},fullWidth:!0})]})};function $m({setProcessing:s,type:t,setPaymentError:e,error:r,paymentMethodId:a}){const o=G(fe),i=G(St),c=o.getSandbox(),{t:l}=A("account"),d=Ge(),u=oe(),h=le(),[g,_]=p.useState(),f=Re("redirectResult"),x=!!f,y=V(h,"payment-method-success"),v=ge(async j=>{try{s(!0),await i.finalizeAdyenPaymentDetails({redirectResult:decodeURI(j)},a),await o.reloadSubscriptions({retry:10}),s(!1),d(l("checkout.payment_success"),"success"),u(y)}catch(S){s(!1),S instanceof Error&&(e(S.message),u(V(h,"payment-method"),{replace:!0}))}});p.useEffect(()=>{f&&v(f)},[v,f]),p.useEffect(()=>{if(x)return;(async()=>{s(!0);try{const S=await i.createAdyenPaymentSession(window.origin,!1);_(S)}catch(S){S instanceof Error&&e(S.message)}s(!1)})()},[s,e,x,u,h,i]);const b=p.useCallback(async(j,S)=>{if(j.isValid){try{s(!0),e(void 0);const C=It("payment-method",{paymentMethodId:`${a}`}),I=await i.addAdyenPaymentDetails(j.data.paymentMethod,a,C);"action"in I&&S(I.action),await o.reloadSubscriptions({retry:5}),u(y,{replace:!0})}catch(C){C instanceof Error&&e(C.message)}s(!1)}},[u,a,y,e,s,o,i]),w=p.useMemo(()=>({session:g,showPayButton:!1,environment:c?"test":"live",clientKey:c?Gi:Ji,paymentMethodsConfiguration:{card:{hasHolderName:!0,holderNameRequired:!0}},onAdditionalDetails:async j=>{try{s(!0),await i.finalizeAdyenPayment(j.data.details,a),u(y,{replace:!0})}catch(S){S instanceof Error&&(e(S.message),s(!1))}},onSubmit:(j,S)=>b(j,S.handleAction),onError:j=>e(j.message)}),[g,c,s,a,u,y,e,b,i]);return n.jsx(Cc,{configuration:w,type:t,error:r})}const Om=({onCloseButtonClick:s})=>{const t=G(St),e=Re("u")==="payment-method-success",r=Re("paymentMethodId"),a=r?parseInt(r):void 0,o=R(v=>v.activePayment),i=o==null?void 0:o.id,[c,l]=p.useState(void 0),[d,u]=p.useState(a),h=ve(v=>v.paymentMethods),[g,_]=p.useState(!1);p.useEffect(()=>{t.getPaymentMethods()},[t]);const f=v=>{const b=parseInt(v.target.value);u(b),l(void 0)},x=async()=>{_(!0);try{l(void 0);const v=It("payment-method-success"),b=It("waiting-for-payment"),w=It("payment-cancelled"),j=It("payment-error"),S=await t.updatePayPalPaymentMethod(v,b,w,j,d,i);S&&(window.location.href=S.redirectUrl)}catch(v){v instanceof Error&&l(v.message)}_(!1)},y=()=>{const v=h==null?void 0:h.find(b=>b.id===d);return(v==null?void 0:v.methodName)==="card"?n.jsx($m,{paymentMethodId:v.id,setPaymentError:l,setProcessing:_,error:c,type:"card"}):(v==null?void 0:v.methodName)==="paypal"?n.jsx(jc,{onSubmit:x,error:c||null}):null};return h?n.jsx(Nm,{onCloseButtonClick:s,paymentMethods:h,paymentMethodId:d,onPaymentMethodChange:f,renderPaymentMethod:y,updateSuccess:e,submitting:g}):n.jsx("div",{style:{height:300},children:n.jsx(xe,{inline:!0})})},Dm="_title_11svw_1",Fm="_cancelButton_11svw_7",mi={title:Dm,cancelButton:Fm},Rm=({renderPaymentMethod:s,submitting:t,onCancel:e})=>{const{t:r}=A(["common","user"]);return n.jsxs("div",{children:[n.jsx("div",{className:mi.title,children:n.jsx("h1",{children:r("user:payment.add_card_details")})}),n.jsx("div",{children:s?s():null}),n.jsx(D,{onClick:e,className:mi.cancelButton,fullWidth:!0,label:r("common:confirmation_dialog.close")}),t&&n.jsx(xe,{transparentBackground:!0,inline:!0})]})},kc=({value:s,onChange:t,error:e,...r})=>{const{t:a}=A("user"),o=i=>{const c=i.target.value.replace(/\D+/g,"");t&&(i.target.value=c.slice(0,4),t(i))};return n.jsx(de,{label:a("payment.security_code"),"aria-label":a("payment.security_code"),...r,error:!!e,helperText:e||null,name:"cardCVC",className:"directPostSecurityCode",type:"text",value:s,onChange:o,pattern:"\\d*",placeholder:"###",autoComplete:"cc-csc",required:!0})},Ec=({value:s,onChange:t,error:e,...r})=>{const a=o=>{let i=o.target.value.replace(/\D+/g,"");i.length===1?Number(i)>1&&(i="0"+i):i.length===2&&Number(i)>12&&(i="12"),i.length>=3?o.target.value=`${i.slice(0,2)}/${i.slice(2,4)}`:o.target.value=i,t&&t(o)};return n.jsx(de,{label:"Expiry date",...r,name:"cardExpiry",className:"directPostExpiryDate",value:s,error:!!e,helperText:e||null,onChange:a,type:"text",pattern:"\\d*",placeholder:"MM/YY",autoComplete:"cc-exp",required:!0})},Mm="_cardTypeWrapper_lfmk2_1",Bm={cardTypeWrapper:Mm},_n={visa:"/images/payments/visa.svg",mastercard:"/images/payments/mastercard.svg",maestro:"/images/payments/maestro.svg",amex:"/images/payments/amex.svg",discover:"/images/payments/discover.svg",diners:"/images/payments/diners.svg",dinersclub:"/images/payments/diners.svg",unionpay:"/images/payments/unionpay.svg",hiper:"/images/payments/hiper.svg"},Pc=({value:s,error:t,onChange:e,onBlur:r,...a})=>{const[o,i]=p.useState(null),c=l=>{var g,_;const d=dt.fns.cardType((g=l.target)==null?void 0:g.value),u=(_=l.target)==null?void 0:_.value.replace(/\D+/g,"");let h;switch(i(_n!=null&&_n[d]?n.jsx("div",{className:Bm.cardTypeWrapper,children:n.jsx("img",{src:_n[d],alt:d,height:"25"})}):null),d){case"amex":h=`${u.slice(0,4)} ${u.slice(4,10)} ${u.slice(10,15)}`;break;case"dinersclub":h=`${u.slice(0,4)} ${u.slice(4,10)} ${u.slice(10,14)}`;break;default:h=`${u.slice(0,4)} ${u.slice(4,8)} ${u.slice(8,12)} ${u.slice(12,16)}`;break}e&&(l.target.value=h.trim(),e(l))};return n.jsx(de,{value:s,name:"cardNumber",label:"Card number",className:"directPostCreditCardNumber",onChange:c,onBlur:r,error:!!t,helperText:t||null,pattern:"\\d*",...a,type:"text",placeholder:"1234 5678 9012 3456",rightControl:o,autoComplete:"cc-number",required:!0})},Um="_paymentForm_g66uf_1",Hm="_columns_g66uf_6",pi={paymentForm:Um,columns:Hm},Wm=({onCancel:s,setUpdatingCardDetails:t})=>{var d,u,h,g,_,f,x,y;const e=G(fe),r=Ge(),{t:a}=A("account"),{mutate:o,isLoading:i}=rt(e.updateCardDetails),{activePayment:c}=R(({activePayment:v})=>({activePayment:v}),ce),l=jt({initialValues:{cardholderName:"",cardNumber:"",cardExpiry:"",cardCVC:"",cardExpMonth:"",cardExpYear:""},validationSchema:re().shape({cardholderName:F().required(),cardNumber:F().required().test("card number validation",a("checkout.invalid_card_number"),v=>dt.fns.validateCardNumber(v)),cardExpiry:F().required().test("card expiry validation",a("checkout.invalid_card_expiry"),v=>dt.fns.validateCardExpiry(v)),cardCVC:F().required().test("cvc validation",a("checkout.invalid_cvc_number"),v=>{var w;const b=dt.fns.cardType((w=l==null?void 0:l.values)==null?void 0:w.cardNumber);return dt.fns.validateCardCVC(v,b)}),cardExpMonth:F().required(),cardExpYear:F().required()}),validateOnBlur:!0,onSubmit:async()=>{t(!0),o({cardName:l.values.cardholderName,cardNumber:l.values.cardNumber.replace(/\s+/g,""),cvc:parseInt(l.values.cardCVC),expMonth:parseInt(l.values.cardExpMonth),expYear:parseInt(l.values.cardExpYear),currency:(c==null?void 0:c.currency)||""},{onSettled:()=>s(),onSuccess:()=>{r(a("checkout.card_details_updated"),"success")}})}});return p.useEffect(()=>{if(l.values.cardExpiry){const v=dt.fns.cardExpiryVal(l.values.cardExpiry);v.month&&l.setValue("cardExpMonth",v.month.toString()),v.year&&l.setValue("cardExpYear",v.year.toString())}},[l.values.cardExpiry]),n.jsxs("div",{className:pi.paymentForm,children:[n.jsx("div",{children:n.jsx(de,{label:a("checkout.card_holder_name"),name:"cardholderName",value:(d=l==null?void 0:l.values)==null?void 0:d.cardholderName,onChange:l==null?void 0:l.handleChange,onBlur:l==null?void 0:l.handleBlur,placeholder:a("checkout.credit_card_name"),autoComplete:"cc-name",required:!0})}),n.jsx("div",{children:n.jsx(Pc,{value:(h=(u=l==null?void 0:l.values)==null?void 0:u.cardNumber)==null?void 0:h.toString(),error:(g=l==null?void 0:l.errors)==null?void 0:g.cardNumber,onBlur:l==null?void 0:l.handleBlur,onChange:l==null?void 0:l.handleChange})}),n.jsxs("div",{className:pi.columns,children:[n.jsx("div",{children:n.jsx(Ec,{value:(_=l==null?void 0:l.values)==null?void 0:_.cardExpiry,onBlur:l==null?void 0:l.handleBlur,onChange:l==null?void 0:l.handleChange,error:(f=l==null?void 0:l.errors)==null?void 0:f.cardExpiry})}),n.jsx("div",{children:n.jsx(kc,{value:(x=l==null?void 0:l.values)==null?void 0:x.cardCVC,onBlur:l==null?void 0:l.handleBlur,onChange:l==null?void 0:l.handleChange,error:(y=l==null?void 0:l.errors)==null?void 0:y.cardCVC})})]}),n.jsx("div",{children:n.jsx(D,{disabled:i,label:a("checkout.save"),variant:"contained",onClick:l.handleSubmit,type:"submit",color:"primary",size:"large",fullWidth:!0})})]})},Vm=()=>{const s=le(),t=oe(),[e,r]=p.useState(!1),a=()=>{t(V(s,null),{replace:!1})},o=()=>n.jsx(Wm,{onCancel:a,setUpdatingCardDetails:r});return n.jsx(Rm,{onCancel:a,renderPaymentMethod:o,submitting:e})},qm="_title_n9dff_1",zm="_text_n9dff_7",Gm="_button_n9dff_12",Jm="_link_n9dff_16",Ym="_textField_n9dff_17",Km="_paragraph_n9dff_21",Qm="_resendLink_n9dff_31",Us={title:qm,text:zm,button:Gm,link:Jm,textField:Ym,paragraph:Km,resendLink:Qm},Zm=({onSubmit:s,onChange:t,onBlur:e,showOldPasswordField:r,showResetTokenField:a,value:o,errors:i,submitting:c,validationError:l,email:d,onResendEmailClick:u})=>{const{t:h}=A(["account","user"]);return n.jsxs("form",{onSubmit:s,"data-testid":void 0,noValidate:!0,children:[i.form&&n.jsx(Pe,{variant:"error",visible:!l,children:i.form}),n.jsx("h2",{className:Us.title,children:h(r&&a?"user:account.add_password":"reset.password_reset")}),r&&a&&n.jsxs("p",{className:Us.paragraph,children:[h("user:account.add_password_modal_text",{email:d}),n.jsx("a",{className:Us.resendLink,onClick:u,children:h("user:account.resend_mail")})]}),r&&!a&&n.jsx(Ys,{value:o.oldPassword,onChange:t,onBlur:e,label:h("reset.old_password"),placeholder:h("reset.old_password"),error:!!i.oldPassword,name:"oldPassword",showToggleView:!1,showHelperText:!1,autoComplete:"current-password",required:!0}),a&&n.jsx(de,{className:Us.textField,value:o.resetPasswordToken||"",onChange:t,onBlur:e,label:h("reset.reset_password_token"),placeholder:h("reset.reset_password_token"),name:"resetPasswordToken",type:"text",autoComplete:"",required:!0}),n.jsx(Ys,{value:o.password,onChange:t,onBlur:e,label:h("reset.new_password"),placeholder:h("reset.password"),error:!!i.password,name:"password",autoComplete:"new-password",required:!0}),n.jsx(Ys,{value:o.passwordConfirmation,onChange:t,onBlur:e,label:h("reset.repeat_new_password"),placeholder:h("reset.repeat_new_password"),error:!!i.passwordConfirmation,name:"passwordConfirmation",autoComplete:"new-password",showHelperText:!1,required:!0}),n.jsx(D,{type:"submit",className:Us.button,fullWidth:!0,color:"primary",disabled:c,label:h("reset.confirm")}),c&&n.jsx(xe,{transparentBackground:!0,inline:!0})]})},fi=({type:s})=>{const t=G(fe),{t:e}=A("account"),r=Ge(),a=le(),o=oe(),i=Re("resetPasswordToken"),c=Re("email"),l=R(_=>{var f;return(f=_.user)==null?void 0:f.email}),d=R.getState().user,u=async(_,{setErrors:f,setSubmitting:x})=>{const{oldPassword:y,password:v,passwordConfirmation:b,resetPasswordToken:w}=_;if(v!==b)return f({form:e("reset.passwords_do_not_match")}),x(!1);let j=i;w&&(j=w);try{if(d&&!j)await t.changePasswordWithOldPassword(y||"",v,b);else{if(!j)return f({form:e("reset.invalid_link")}),x(!1);await t.changePasswordWithToken(c||"",v,j,b)}r(e("reset.password_reset_success"),"success"),await t.logout(),o(V(a,"login"))}catch(S){S instanceof Error&&(S.message.includes("invalid param password")?f({password:e("reset.invalid_password")}):S.message.includes("resetPasswordToken is not valid")?f({form:e("reset.invalid_reset_link")}):S.message.includes("score does not match standards")?f({form:e("reset.password_strength")}):S.message.includes("old password does not match")?f({form:e("reset.old_password_does_not_match")}):S.message.includes("password could not be set")&&f({form:e("reset.invalid_token")}))}x(!1)},h=jt({initialValues:{password:"",passwordConfirmation:""},validationSchema:re().shape({email:F(),oldPassword:F(),password:F().matches(/^(?=.*[a-z])(?=.*[0-9]).{8,}$/,e("registration.invalid_password")).required(e("login.field_required",{field:e("login.password")})),passwordConfirmation:F().required(),resetPasswordToken:F()}),validateOnBlur:!0,onSubmit:u}),g=async()=>{try{l&&await t.resetPassword(l,"")}catch{h.setErrors({form:e("user:account.resend_mail_error")})}};return n.jsx(Zm,{value:h.values,submitting:h.submitting,onChange:h.handleChange,onBlur:h.handleBlur,errors:h.errors,onSubmit:h.handleSubmit,validationError:h.validationSchemaError,showOldPasswordField:!!(d&&!i),showResetTokenField:s==="add"||!d&&!i,email:c||l,onResendEmailClick:g})},Xm="_title_ofxac_1",ep="_infoBox_ofxac_7",tp="_price_ofxac_23",sp="_confirmButton_ofxac_32",Hs={title:Xm,infoBox:ep,price:tp,confirmButton:sp},np=({subscription:s,customer:t,error:e,submitting:r,onConfirm:a,onClose:o})=>{const{t:i,i18n:c}=A("account");return n.jsxs("div",{children:[e?n.jsx(Pe,{variant:"error",children:e}):null,n.jsx("h2",{className:Hs.title,children:i("renew_subscription.renew_your_subscription")}),n.jsx("p",{className:Hs.paragraph,children:i("renew_subscription.explanation")}),n.jsxs("div",{className:Hs.infoBox,children:[n.jsxs("p",{children:[n.jsx("strong",{children:s.offerTitle})," ",n.jsx("br",{}),i("renew_subscription.next_billing_date_on",{date:vt(new Date(s.expiresAt*1e3),c.language)})]}),n.jsxs("p",{className:Hs.price,children:[n.jsx("strong",{children:nt(s.nextPaymentPrice,s.nextPaymentCurrency,t.country)}),n.jsxs("small",{children:["/",i(`periods.${s.period}`)]})]})]}),n.jsx(D,{className:Hs.confirmButton,color:"primary",variant:"contained",label:i("renew_subscription.renew_subscription"),onClick:a,fullWidth:!0,disabled:r,type:"submit"}),n.jsx(D,{label:i("renew_subscription.no_thanks"),onClick:o,fullWidth:!0})]})},rp="_title_1o843_1",gi={title:rp},ap=({onClose:s,customer:t,subscription:e})=>{const{t:r,i18n:a}=A("account"),o=vt(new Date(e.expiresAt*1e3),a.language),i=nt(e.nextPaymentPrice,e.nextPaymentCurrency,t.country);return n.jsxs("div",{children:[n.jsx("h2",{className:gi.title,children:r("subscription_renewed.title")}),n.jsx("p",{className:gi.paragraph,children:r("subscription_renewed.message",{date:o,price:i})}),n.jsx(D,{label:r("subscription_renewed.back_to_profile"),onClick:s,fullWidth:!0})]})},op=()=>{const s=G(fe),t=oe(),e=le(),{t:r}=A("account"),a=Ge(),{subscription:o,user:i}=R(({subscription:x,user:y})=>({subscription:x,user:y}),ce),[c,l]=p.useState(!1),[d,u]=p.useState(!1),[h,g]=p.useState(null),_=async()=>{u(!0),g(null);try{await s.updateSubscription("active"),a(r("renew_subscription.success"),"success"),l(!0)}catch{g(r("renew_subscription.unknown_error_occurred"))}u(!1)},f=()=>{t(V(e,null),{replace:!0})};return!o||!i?null:n.jsxs(Ee.Fragment,{children:[c?n.jsx(ap,{onClose:f,subscription:o,customer:i}):n.jsx(np,{subscription:o,customer:i,error:h,onConfirm:_,onClose:f,submitting:d}),d?n.jsx(xe,{inline:!0}):null]})},ip="_title_feuiy_1",cp="_confirmButton_feuiy_7",Yn={title:ip,confirmButton:cp},lp=({onConfirm:s,onCancel:t,error:e,submitting:r})=>{const{t:a}=A("account");return n.jsxs("div",{children:[e?n.jsx(Pe,{variant:"error",children:e}):null,n.jsx("h2",{className:Yn.title,children:a("cancel_subscription.title")}),n.jsx("p",{className:Yn.paragraph,children:a("cancel_subscription.explanation")}),n.jsx(D,{className:Yn.confirmButton,label:a("cancel_subscription.unsubscribe"),color:"primary",variant:"contained",onClick:s,fullWidth:!0,disabled:r,type:"submit"}),n.jsx(D,{label:a("cancel_subscription.no_thanks"),variant:"outlined",onClick:t,fullWidth:!0})]})},dp="_title_od1i3_1",Kn={title:dp},up=({expiresDate:s,onClose:t})=>{const{t:e}=A("account");return n.jsxs("div",{className:Kn.SubscriptionCancelled,children:[n.jsx("h2",{className:Kn.title,children:e("subscription_cancelled.title")}),n.jsx("p",{className:Kn.paragraph,children:e("subscription_cancelled.message",{date:s})}),n.jsx(D,{label:e("subscription_cancelled.return_to_profile"),variant:"outlined",onClick:t,fullWidth:!0})]})},hp=()=>{const s=G(fe),{t,i18n:e}=A("account"),r=Ge(),a=oe(),o=le(),i=R(y=>y.subscription),[c,l]=p.useState(!1),[d,u]=p.useState(!1),[h,g]=p.useState(null),_=i!=null&&i.expiresAt?vt(new Date(i.expiresAt*1e3),e.language):"",f=async()=>{u(!0),g(null);try{await s.updateSubscription("cancelled"),_&&r(t("subscription_cancelled.message",{date:_}),"success"),l(!0)}catch{g(t("cancel_subscription.unknown_error_occurred"))}u(!1)},x=()=>{a(V(o,null),{replace:!0})};return i?n.jsxs(Ee.Fragment,{children:[c?n.jsx(up,{expiresDate:_,onClose:x}):n.jsx(lp,{onConfirm:f,onCancel:x,submitting:d,error:h}),d?n.jsx(xe,{transparentBackground:!0,inline:!0}):null]}):null},mp="_title_173ks_1",pp="_text_173ks_7",fp="_button_173ks_12",Qn={title:mp,text:pp,button:fp},gp=({onCancel:s,onReset:t,submitting:e})=>{const{t:r}=A("account");return n.jsxs("div",{children:[n.jsx("h1",{className:Qn.title,children:r("reset.reset_password")}),n.jsx("p",{className:Qn.text,children:r("reset.text")}),n.jsx(D,{onClick:t,className:Qn.button,fullWidth:!0,color:"primary",label:r("reset.yes"),type:"submit",disabled:e}),n.jsx(D,{onClick:s,fullWidth:!0,label:r("reset.no")})]})},_p="_title_17xro_1",yp="_text_17xro_7",vp="_button_17xro_12",Zn={title:_p,text:yp,button:vp},xp=({onSubmit:s,onChange:t,value:e,errors:r,submitting:a,onBlur:o})=>{const{t:i}=A("account");return n.jsxs("form",{onSubmit:s,"data-testid":void 0,noValidate:!0,children:[n.jsx("h2",{className:Zn.title,children:i("reset.forgot_password")}),r.form?n.jsx(Pe,{variant:"error",children:r.form}):null,n.jsx("p",{className:Zn.text,children:i("reset.forgot_text")}),n.jsx(de,{value:e.email,onChange:t,onBlur:o,label:i("reset.email"),placeholder:i("reset.email"),error:!!r.email||!!r.form,helperText:r.email,name:"email",type:"email",autoComplete:"email",required:!0}),n.jsx(D,{type:"submit",className:Zn.button,fullWidth:!0,color:"primary",disabled:a,label:i("reset.email_me")})]})},wp="_title_v7vet_1",bp="_text_v7vet_7",Sp="_button_v7vet_12",jp="_notSure_v7vet_16",Cp="_link_v7vet_20",ys={title:wp,text:bp,button:Sp,notSure:jp,link:Cp},kp=({email:s,onBackToLogin:t,loggedIn:e})=>{const{t:r}=A("account"),a=le();return n.jsxs("div",{className:ys.forgotPasswordForm,children:[n.jsx("h2",{className:ys.title,children:r("reset.link_sent")}),n.jsx("p",{className:ys.text,children:r("reset.link_sent_text",{email:s})}),n.jsx(D,{onClick:t,className:ys.button,fullWidth:!0,color:"primary",label:r("reset.back_login")}),!e&&n.jsxs(Ee.Fragment,{children:[n.jsx("span",{className:ys.notSure,children:r("reset.not_sure")}),n.jsx(en,{className:ys.link,to:V(a,"forgot-password"),children:r("reset.try_again")})]})]})},Xn=({type:s})=>{const t=G(fe),{t:e}=A("account"),r=oe(),a=le(),[o,i]=p.useState(!1),{canChangePasswordWithOldPassword:c}=t.getFeatures(),{customer:l}=R(({user:f})=>({customer:f}),ce),d=()=>{r(V(a,null))},u=async()=>{r({pathname:"/",search:"u=login"},{replace:!0}),l&&await t.logout()},h=async()=>{const f=`${window.location.origin}/?u=edit-password`;try{if(!(l!=null&&l.email)){Nt("ResetPassword","invalid param email");return}i(!0),await t.resetPassword(l.email,f),i(!1),r(V(a,"send-confirmation"))}catch(x){Ve("ResetPassword","Failed to reset password",{error:x})}},g=async(f,{setErrors:x,setSubmitting:y})=>{const v=`${window.location.origin}/?u=edit-password`;try{await t.resetPassword(f.email,v),r(V(a,c?"edit-password":"send-confirmation"))}catch(b){b instanceof Error&&(b.message.toLowerCase().includes("invalid param email")?x({email:e("reset.wrong_email")}):x({form:b.message}))}y(!1)},_=jt({initialValues:{email:""},validationSchema:re().shape({email:F().email(e("login.field_is_not_valid_email")).required(e("login.field_required",{field:e("login.email")}))}),validateOnBlur:!0,onSubmit:g});return n.jsxs(Ee.Fragment,{children:[s==="reset"&&n.jsx(gp,{submitting:o,onCancel:d,onReset:h}),s==="forgot"&&n.jsx(xp,{value:_.values,submitting:_.submitting,onChange:_.handleChange,errors:_.errors,onSubmit:_.handleSubmit,onBlur:_.handleBlur}),s==="confirmation"&&n.jsx(kp,{loggedIn:!!l,email:(l==null?void 0:l.email)||_.values.email,onBackToLogin:u}),(_.submitting||o)&&n.jsx(xe,{transparentBackground:!0,inline:!0})]})},Ep=({onUpdateOrderSuccess:s,onSubmitPaymentWithoutDetailsSuccess:t,onSubmitPaypalPaymentSuccess:e,onSubmitStripePaymentSuccess:r})=>{const a=G(fe),o=G(St),{order:i,selectedOffer:c,paymentMethods:l,setOrder:d}=ve(({order:v,selectedOffer:b,paymentMethods:w,setOrder:j})=>({order:v,selectedOffer:b,paymentMethods:w,setOrder:j})),u=c&&Vr(c)?"svod":"tvod",h=rt({mutationKey:["initialiseOrder"],mutationFn:async({offer:v})=>!!v&&o.initialiseOrder(v)}),g=rt({mutationKey:["updateOrder"],mutationFn:async({paymentMethodId:v,couponCode:b})=>{if(!(!i||!v))return await o.updateOrder(i,v,b)},onSuccess:s}),_=rt({mutationKey:["submitPaymentWithoutDetails"],mutationFn:o.paymentWithoutDetails,onSuccess:async()=>{await a.reloadSubscriptions({retry:10}),t()}}),f=rt({mutationKey:["submitPaymentPaypal"],mutationFn:o.paypalPayment,onSuccess:e}),x=rt({mutationKey:["submitPaymentStripe"],mutationFn:o.directPostCardPayment,onSuccess:r});p.useEffect(()=>{c&&!i&&!h.isLoading&&!h.isError&&h.mutate({offer:c})},[c,i,h]),p.useEffect(()=>()=>d(null),[d]);const y=h.isLoading||g.isLoading||_.isLoading||f.isLoading||x.isLoading;return{selectedOffer:c,offerType:u,paymentMethods:l,order:i,isSubmitting:y,updateOrder:g,submitPaymentWithoutDetails:_,submitPaymentPaypal:f,submitPaymentStripe:x}},Nc=s=>p.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},p.createElement("path",{d:"M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z"})),Pp="_dialogBackButton_1pa6f_1",Np={dialogBackButton:Pp},Ic=({onClick:s})=>{const{t}=A();return n.jsx(ze,{onClick:s,className:Np.dialogBackButton,"aria-label":t("common:back"),children:n.jsx(J,{icon:Nc})})},Ip="_backButton_1xlk4_1",Ap="_title_1xlk4_7",Tp="_order_1xlk4_13",Lp="_orderTitle_1xlk4_22",$p="_orderTitleMargin_1xlk4_28",Op="_orderBillingDate_1xlk4_32",Dp="_orderInfo_1xlk4_37",Fp="_orderPrice_1xlk4_41",Rp="_couponForm_1xlk4_54",Mp="_redeemCoupon_1xlk4_59",Bp="_couponInput_1xlk4_66",Up="_orderTotals_1xlk4_84",Hp="_couponCell_1xlk4_96",Wp="_divider_1xlk4_113",Vp="_paymentMethods_1xlk4_118",qp="_paymentMethod_1xlk4_118",zp="_paymentMethodLabel_1xlk4_127",Gp="_radio_1xlk4_135",Jp="_noPaymentNeeded_1xlk4_170",Ce={backButton:Ip,title:Ap,order:Tp,orderTitle:Lp,orderTitleMargin:$p,orderBillingDate:Op,orderInfo:Dp,orderPrice:Fp,couponForm:Rp,redeemCoupon:Mp,couponInput:Bp,orderTotals:Up,couponCell:Hp,divider:Wp,paymentMethods:Vp,paymentMethod:qp,paymentMethodLabel:zp,radio:Gp,noPaymentNeeded:Jp},Yp=({paymentMethodId:s,paymentMethods:t,order:e,offer:r,offerType:a,onBackButtonClick:o,onPaymentMethodChange:i,error:c,couponFormOpen:l,couponInputValue:d,couponFormError:u,couponFormApplied:h,couponFormSubmitting:g,onCouponInputChange:_,onCloseCouponFormClick:f,onCouponFormSubmit:x,onRedeemCouponButtonClick:y,children:v,submitting:b})=>{var P,N,$,O,U,H,T;const{t:w}=A("account"),j=()=>r?w(`periods.${r.period}`):"",S=M=>{if(M.freeDays)return w("checkout.days_trial",{count:M.freeDays});if(M.freePeriods){const Z=w(`periods.${M.period}`,{count:M.freePeriods});return w("checkout.periods_trial",{count:M.freePeriods,period:Z})}return null},C=t==null?void 0:t.find(M=>M.methodName==="card"),I=t==null?void 0:t.find(M=>M.methodName==="paypal"),E=a==="svod"?r.period==="month"?w("checkout.monthly"):w("checkout.yearly"):r.offerTitle;return n.jsxs("div",{children:[c?n.jsx(Pe,{variant:"error",children:c}):null,n.jsx("h1",{className:Ce.title,children:w("checkout.payment_method")}),n.jsxs("div",{className:Ce.order,children:[n.jsxs("div",{className:Ce.orderInfo,children:[n.jsx("p",{className:B(Ce.orderTitle,{[Ce.orderTitleMargin]:a==="svod"}),children:E}),((P=e.discount)==null?void 0:P.type)==="trial"?n.jsx("p",{className:Ce.orderBillingDate,children:S(r)}):null]}),n.jsxs("div",{className:Ce.orderPrice,children:[n.jsx("span",{children:nt(r.customerPriceInclTax,e.currency,r.customerCountry)}),a==="svod"&&n.jsxs("small",{children:["/",j()]})]})]}),n.jsx("div",{className:Ce.couponForm,children:l?n.jsxs("form",{onSubmit:x,noValidate:!0,children:[n.jsxs("div",{className:Ce.redeemCoupon,children:[n.jsx(ze,{"aria-label":"Close coupon form",onClick:f,children:n.jsx(J,{icon:On})}),n.jsx("input",{className:Ce.couponInput,name:"couponCode",type:"text",placeholder:"Coupon code",value:d,onChange:_}),n.jsx(D,{variant:"outlined",label:"Apply",type:"submit",disabled:g})]}),u?n.jsx(Pe,{variant:"error",children:u}):null,h?n.jsx(Pe,{variant:"success",children:w("checkout.coupon_applied")}):null]}):n.jsx(D,{variant:"outlined",label:w("checkout.redeem_coupon"),onClick:y})}),n.jsx("div",{children:n.jsxs("table",{className:Ce.orderTotals,children:[n.jsxs("tbody",{children:[(N=e.discount)!=null&&N.applied&&(($=e.discount)==null?void 0:$.type)==="coupon"?n.jsxs("tr",{children:[n.jsxs("td",{className:Ce.couponCell,children:[w("checkout.coupon_discount"),n.jsx("br",{}),!!r.period&&a==="svod"&&n.jsx("small",{children:w("checkout.discount_period",{count:(O=e.discount)==null?void 0:O.periods,period:w(`periods.${r.period}`,{count:(U=e.discount)==null?void 0:U.periods})})})]}),n.jsx("td",{children:nt(-e.priceBreakdown.discountAmount*(1+e.taxRate),e.currency,r.customerCountry)})]}):null,(H=e.discount)!=null&&H.applied&&((T=e.discount)==null?void 0:T.type)==="trial"?n.jsxs("tr",{children:[n.jsx("td",{className:Ce.couponCell,children:w("checkout.free_trial_discount")}),n.jsx("td",{children:nt(-r.customerPriceInclTax,e.currency,r.customerCountry)})]}):null,e.priceBreakdown.paymentMethodFee>0&&n.jsxs("tr",{children:[n.jsx("td",{children:w("checkout.payment_method_fee")}),n.jsx("td",{children:nt(e.priceBreakdown.paymentMethodFee,e.currency,r.customerCountry)})]})]}),n.jsxs("tfoot",{children:[n.jsxs("tr",{children:[n.jsx("td",{children:w("checkout.total_price")}),n.jsx("td",{children:nt(e.totalPrice,e.currency,r.customerCountry)})]}),e.priceBreakdown.taxValue>0&&n.jsxs("tr",{children:[n.jsx("td",{children:w("checkout.applicable_tax",{taxRate:Math.round(e.taxRate*100)})}),n.jsx("td",{children:nt(e.priceBreakdown.taxValue,e.currency,r.customerCountry)})]})]})]})}),n.jsx("hr",{className:Ce.divider}),e.requiredPaymentDetails?n.jsxs("div",{className:Ce.paymentMethods,children:[C?n.jsxs("div",{className:Ce.paymentMethod,children:[n.jsx("input",{className:Ce.radio,type:"radio",name:"paymentMethodId",value:C.id,id:"card",checked:s===C.id.toString(),onChange:i}),n.jsxs("label",{className:Ce.paymentMethodLabel,htmlFor:"card",children:[n.jsx(J,{icon:Sc})," ",w("checkout.credit_card")]})]}):null,I?n.jsxs("div",{className:Ce.paymentMethod,children:[n.jsx("input",{className:Ce.radio,type:"radio",name:"paymentMethodId",value:I.id,id:"paypal",checked:s===I.id.toString(),onChange:i}),n.jsxs("label",{className:Ce.paymentMethodLabel,htmlFor:"paypal",children:[n.jsx(J,{icon:Qr})," ",w("checkout.paypal")]})]}):null]}):null,v?n.jsx("div",{children:v}):null,b&&n.jsx(xe,{transparentBackground:!0,inline:!0}),n.jsx(Ic,{onClick:o})]})},Kp="_noPaymentRequired_170kq_1",Qp={noPaymentRequired:Kp},Zp=({onSubmit:s,error:t})=>{const{t:e}=A("account");return n.jsxs("div",{className:Qp.noPaymentRequired,children:[t?n.jsx(Pe,{variant:"error",children:t}):null,n.jsx("p",{children:e("checkout.no_payment_needed")}),n.jsx(D,{label:e("checkout.continue"),variant:"contained",color:"primary",size:"large",onClick:s,fullWidth:!0})]})},Xp="_paymentForm_1nfvx_1",ef="_columns_1nfvx_6",tf="_formError_1nfvx_13",er={paymentForm:Xp,columns:ef,formError:tf},sf=({onPaymentFormSubmit:s})=>{const{t}=A("account"),{values:e,errors:r,setValue:a,handleChange:o,handleBlur:i,handleSubmit:c}=jt({initialValues:{cardholderName:"",cardNumber:"",cardExpiry:"",cardCVC:"",cardExpMonth:"",cardExpYear:""},validationSchema:re().required().shape({cardholderName:F().required(),cardNumber:F().required().test("card number validation",t("checkout.invalid_card_number"),l=>dt.fns.validateCardNumber(l)),cardExpiry:F().required().test("card expiry validation",t("checkout.invalid_card_expiry"),l=>dt.fns.validateCardExpiry(l)),cardCVC:F().required().test("cvc validation",t("checkout.invalid_cvc_number"),(l,d)=>{const u=dt.fns.cardType(d.parent.cardNumber);return dt.fns.validateCardCVC(l,u)}),cardExpMonth:F().required(),cardExpYear:F().required()}),validateOnBlur:!0,onSubmit:s});return p.useEffect(()=>{if(e.cardExpiry){const l=dt.fns.cardExpiryVal(e.cardExpiry);l.month&&a("cardExpMonth",l.month.toString()),l.year&&a("cardExpYear",l.year.toString())}},[e.cardExpiry]),n.jsx("div",{className:er.paymentForm,children:n.jsxs("form",{onSubmit:c,"data-testid":void 0,noValidate:!0,children:[r.form?n.jsx("div",{className:er.formError,children:n.jsx(Pe,{variant:"error",children:r.form})}):null,n.jsx("div",{children:n.jsx(de,{label:t("checkout.card_holder_name"),name:"cardholderName",value:e.cardholderName,onChange:o,onBlur:i,placeholder:t("checkout.credit_card_name"),autoComplete:"cc-name",required:!0})}),n.jsx("div",{children:n.jsx(Pc,{value:e.cardNumber.toString(),error:r.cardNumber,onBlur:i,onChange:o})}),n.jsxs("div",{className:er.columns,children:[n.jsx("div",{children:n.jsx(Ec,{value:e.cardExpiry,onBlur:i,onChange:o,error:r.cardExpiry})}),n.jsx("div",{children:n.jsx(kc,{value:e.cardCVC,onBlur:i,onChange:o,error:r.cardCVC})})]}),n.jsx("div",{children:n.jsx(D,{label:t("checkout.continue"),variant:"contained",color:"primary",type:"submit",size:"large",fullWidth:!0})})]})})};function nf({setUpdatingOrder:s,type:t,paymentSuccessUrl:e,orderId:r}){const a=G(fe),o=G(St),{t:i}=A(["account","error"]),c=Ge(),[l,d]=p.useState(),[u,h]=p.useState(),g=a.getSandbox(),_=oe();p.useEffect(()=>{(async()=>{s(!0);try{const v=await o.createAdyenPaymentSession(window.origin);h(v)}catch(v){v instanceof Error&&d(v.message)}s(!1)})()},[s,o]);const f=p.useCallback(async(y,v)=>{if(y.isValid){try{if(s(!0),d(void 0),r===void 0){d(i("error:adyen_order_unknown"));return}const b=Se(window.location.href,{u:"finalize-payment",orderId:r}),w=await o.initialAdyenPayment(y.data.paymentMethod,b);"action"in w&&v(w.action),await a.reloadSubscriptions({retry:10}),c(i("account:checkout.payment_success"),"success"),_(e,{replace:!0})}catch(b){b instanceof Error&&d(b.message)}s(!1)}},[s,r,o,a,c,i,_,e]),x=p.useMemo(()=>({session:u,showPayButton:!1,environment:g?"test":"live",clientKey:g?Gi:Ji,paymentMethodsConfiguration:{card:{hasHolderName:!0,holderNameRequired:!0}},onAdditionalDetails:async y=>{try{s(!0);const v=y.data.details;await o.finalizeAdyenPayment(r,v),c(i("account:checkout.payment_success"),"success"),_(e,{replace:!0})}catch(v){v instanceof Error&&(d(v.message),s(!1))}},onSubmit:(y,v)=>f(y,v.handleAction),onError:y=>d(y.message)}),[u,g,s,o,r,c,i,_,e,f]);return n.jsx(Cc,{configuration:x,type:t,error:l})}const rf=()=>{var we,ue,je,ie;const s=le(),t=oe(),[e,r]=p.useState(!1),[a,o]=p.useState(!1),[i,c]=p.useState(!1),{t:l}=A("account"),d=Ge(),u=V(s,"choose-offer"),h=V(s,"welcome"),g=V(s,null),_=()=>t(u),{selectedOffer:f,offerType:x,paymentMethods:y,order:v,isSubmitting:b,updateOrder:w,submitPaymentWithoutDetails:j,submitPaymentPaypal:S,submitPaymentStripe:C}=Ep({onUpdateOrderSuccess:()=>!!I&&c(!0),onSubmitPaymentWithoutDetailsSuccess:()=>(d(l("checkout.payment_success"),"success"),t(x==="svod"?h:g,{replace:!0})),onSubmitPaypalPaymentSuccess:({redirectUrl:Y})=>{window.location.href=Y},onSubmitStripePaymentSuccess:()=>t(V(s,"waiting-for-payment"),{replace:!0})}),{values:{couponCode:I,paymentMethodId:E},setValue:P,submitting:N,errors:$,handleChange:O,handleSubmit:U}=jt({initialValues:{couponCode:"",paymentMethodId:((ue=(we=y==null?void 0:y[0])==null?void 0:we.id)==null?void 0:ue.toString())||""},onSubmit:({couponCode:Y,paymentMethodId:he})=>(c(!1),w.mutateAsync({couponCode:Y,paymentMethodId:parseInt(he)})),onSubmitSuccess:({couponCode:Y})=>c(!!Y),onSubmitError:({error:Y})=>{var he;Y instanceof Ke&&((he=Y.errors.order)!=null&&he.includes(`Order with id ${v==null?void 0:v.id} not found`))&&t(V(s,"choose-offer"),{replace:!0})}}),H=Y=>{O(Y),w.mutateAsync({couponCode:I,paymentMethodId:parseInt(Y.target.value)})};if(p.useEffect(()=>{if(!f)return t(u,{replace:!0})},[t,u,f]),p.useEffect(()=>{y!=null&&y.length&&P("paymentMethodId",y[0].id.toString())},[y,P]),p.useEffect(()=>()=>c(!1),[]),!f||!v||!y||!x)return n.jsx("div",{style:{height:300},children:n.jsx(xe,{inline:!0})});const T=It("payment-cancelled"),M=It("waiting-for-payment",{offerId:f==null?void 0:f.offerId}),Z=It("payment-error"),Q=x==="svod"?M:Se(window.location.href,{u:""}),q=window.location.href,k=y==null?void 0:y.find(Y=>Y.id===parseInt(E)),L=!(v!=null&&v.requiredPaymentDetails),W=(k==null?void 0:k.methodName)==="card"&&(k==null?void 0:k.provider)==="stripe",X=(k==null?void 0:k.methodName)==="card"&&(k==null?void 0:k.paymentGateway)==="adyen",se=(k==null?void 0:k.methodName)==="paypal";return n.jsxs(Yp,{order:v,offer:f,offerType:x,error:$.form,onBackButtonClick:_,paymentMethods:y,paymentMethodId:E,onPaymentMethodChange:H,onCouponFormSubmit:U,onCouponInputChange:O,onRedeemCouponButtonClick:()=>o(!0),onCloseCouponFormClick:()=>o(!1),couponInputValue:I,couponFormOpen:a,couponFormApplied:i,couponFormSubmitting:N,couponFormError:$.couponCode,submitting:b||e,children:[L&&n.jsx(Zp,{onSubmit:j.mutateAsync,error:((je=j.error)==null?void 0:je.message)||null}),W&&n.jsx(sf,{onPaymentFormSubmit:async Y=>await C.mutateAsync({cardPaymentPayload:Y,referrer:q,returnUrl:M})}),X&&n.jsx(n.Fragment,{children:n.jsx(nf,{paymentSuccessUrl:x==="svod"?h:g,setUpdatingOrder:r,orderId:v.id,type:"card"})}),se&&n.jsx(jc,{onSubmit:()=>S.mutate({successUrl:Q,waitingUrl:M,cancelUrl:T,errorUrl:Z,couponCode:I}),error:((ie=S.error)==null?void 0:ie.message)||null})]})},Zr=()=>{const s=G(St),t=G(fe),{mediaOffers:e,subscriptionOffers:r,switchSubscriptionOffers:a,requestedMediaOffers:o}=ve(({mediaOffers:f,subscriptionOffers:x,switchSubscriptionOffers:y,requestedMediaOffers:v})=>({mediaOffers:f,subscriptionOffers:x,switchSubscriptionOffers:y,requestedMediaOffers:v}),ce),{isLoading:i}=qe({queryKey:["initialiseOffers",o],queryFn:s.initialiseOffers}),c=rt({mutationKey:["chooseOffer"],mutationFn:s.chooseOffer}),l=rt({mutationKey:["switchSubscription"],mutationFn:s.switchSubscription,onSuccess:()=>t.reloadSubscriptions({delay:3e3,retry:10})}),d=e.length>0,u=r.length>0,h=o.some(f=>f.premier),g=(r.length>0||a.length>0)&&d&&!h,_=h||!u?"tvod":"svod";return{isLoading:i||c.isLoading,mediaOffers:e,subscriptionOffers:r,switchSubscriptionOffers:a,chooseOffer:c,switchSubscription:l,hasMultipleOfferTypes:g,defaultOfferType:_}},tr=s=>p.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},p.createElement("path",{d:"M12 2C6.5 2 2 6.5 2 12S6.5 22 12 22 22 17.5 22 12 17.5 2 12 2M10 17L5 12L6.41 10.59L10 14.17L17.59 6.58L19 8L10 17Z"})),af="_title_1h3nw_1",of="_subtitle_1h3nw_7",cf="_offerGroupSwitch_1h3nw_13",lf="_label_1h3nw_19",df="_offers_1h3nw_24",uf="_offer_1h3nw_13",hf="_radio_1h3nw_41",mf="_offerGroupLabel_1h3nw_68",pf="_offerTitle_1h3nw_80",ff="_offerDivider_1h3nw_86",gf="_offerBenefits_1h3nw_93",_f="_fill_1h3nw_114",yf="_offerPrice_1h3nw_118",Ae={title:af,subtitle:of,offerGroupSwitch:cf,label:lf,offers:df,offer:uf,radio:hf,offerGroupLabel:mf,offerTitle:pf,offerDivider:ff,offerBenefits:gf,fill:_f,offerPrice:yf},vf=({offer:s,selected:t,onChange:e})=>{const{t:r}=A("account"),a=c=>{if(c.freeDays)return r("choose_offer.benefits.first_days_free",{count:c.freeDays});if(c.freePeriods){const l=r(`periods.${c.period}`,{count:c.freePeriods});return r("choose_offer.benefits.first_periods_free",{count:c.freePeriods,period:l})}return null},o=(c,l)=>n.jsxs("li",{children:[n.jsx(J,{icon:l}),c,n.jsx("span",{className:"hidden",children:"."})]}),i=({title:c,periodString:l,secondBenefit:d})=>n.jsxs("div",{className:Ae.offer,"aria-labelledby":`title-${s.offerId}`,children:[n.jsx("input",{className:Ae.radio,onChange:e,type:"radio",name:"selectedOfferId",value:s.offerId,id:s.offerId,checked:t,"data-testid":(s.offerId,void 0)}),n.jsx("div",{className:Ae.label,children:n.jsxs("label",{htmlFor:s.offerId,children:[n.jsx("h2",{className:Ae.offerTitle,id:`title-${s.offerId}`,children:c}),n.jsx("span",{className:"hidden",children:"."}),n.jsx("hr",{className:Ae.offerDivider,"aria-hidden":!0}),n.jsxs("ul",{className:Ae.offerBenefits,children:[s.freeDays||s.freePeriods?o(a(s)||"",tr):null,!!d&&o(d,tr),o(r("choose_offer.benefits.watch_on_all_devices"),tr)]}),n.jsx("div",{className:Ae.fill}),n.jsxs("div",{className:Ae.offerPrice,children:[pu(s)," ",!!l&&n.jsxs("small",{children:["/",l]})]})]})})]});if(Vr(s)){const c=s.period==="month";return i({title:r(c?"choose_offer.monthly":"choose_offer.yearly"),secondBenefit:r("choose_offer.benefits.cancel_anytime"),periodString:r(c?"periods.month":"periods.year")})}return i({title:s.offerTitle,secondBenefit:s.durationPeriod&&s.durationAmount?r("choose_offer.tvod_access",{period:s.durationPeriod,count:s.durationAmount}):void 0})},xf=({values:s,errors:t,submitting:e,offers:r,showOfferTypeSwitch:a,onChange:o,onSubmit:i,onBackButtonClickHandler:c})=>{const l=z(g=>g.config.siteName),{t:d}=A("account"),{selectedOfferType:u,selectedOfferId:h}=s;return n.jsxs("form",{onSubmit:i,"data-testid":void 0,noValidate:!0,children:[c?n.jsx(Ic,{onClick:c}):null,n.jsx("h1",{className:Ae.title,children:d("choose_offer.title")}),n.jsx("p",{className:Ae.subtitle,children:d("choose_offer.watch_this_on_platform",{siteName:l})}),t.form?n.jsx(Pe,{variant:"error",children:t.form}):null,a&&n.jsxs("div",{className:Ae.offerGroupSwitch,children:[n.jsx("input",{className:Ae.radio,onChange:o,type:"radio",name:"selectedOfferType",id:"svod",value:"svod",checked:u==="svod"}),n.jsx("label",{className:B(Ae.label,Ae.offerGroupLabel),htmlFor:"svod",children:d("choose_offer.subscription")}),n.jsx("input",{className:Ae.radio,onChange:o,type:"radio",name:"selectedOfferType",id:"tvod",value:"tvod",checked:u==="tvod"}),n.jsx("label",{className:B(Ae.label,Ae.offerGroupLabel),htmlFor:"tvod",children:d("choose_offer.one_time_only")})]}),n.jsx("div",{className:Ae.offers,children:r.length?r.map(g=>n.jsx(vf,{offer:g,selected:h===g.offerId,onChange:o},g.offerId)):n.jsx("p",{children:d("choose_offer.no_pricing_available")})}),e&&n.jsx(xe,{transparentBackground:!0,inline:!0}),n.jsx(D,{label:d("choose_offer.continue"),disabled:e||!r.length,variant:"contained",color:"primary",type:"submit",fullWidth:!0})]})},_i=()=>{const s=oe(),t=le(),{t:e}=A("account"),r=Re("u")==="upgrade-subscription",a=R(({pendingOffer:E})=>({isPendingOffer:!!E})),{isLoading:o,mediaOffers:i,subscriptionOffers:c,switchSubscriptionOffers:l,defaultOfferType:d,hasMultipleOfferTypes:u,chooseOffer:h,switchSubscription:g}=Zr(),_=V(t,"checkout"),f=V(t,"upgrade-subscription-pending"),x=V(t,"upgrade-subscription-success"),y=V(t,"upgrade-subscription-error"),{values:v,errors:b,submitting:w,setValue:j,handleSubmit:S,handleChange:C}=jt({initialValues:{selectedOfferType:d,selectedOfferId:void 0},validationSchema:re().shape({selectedOfferId:ns().required(e("choose_offer.field_required")),selectedOfferType:ns().required(e("choose_offer.field_required"))}),onSubmit:async({selectedOfferType:E,selectedOfferId:P})=>{if(!E||!P)return;const N=I.find($=>$.offerId===P);if(N&&(await h.mutateAsync(N),r))return await g.mutateAsync()},onSubmitSuccess:async()=>{if(r&&a)return s(f);if(r)return s(x);s(_)},onSubmitError:()=>s(y)}),I=v.selectedOfferType==="tvod"?i:r?l:c;return p.useEffect(()=>{var P;if(o||!I.length)return;const E=(P=I[I.length-1])==null?void 0:P.offerId;j("selectedOfferId",E)},[I,v.selectedOfferType,j,o]),p.useEffect(()=>{o||!d||j("selectedOfferType",d)},[o,d,j]),o?n.jsx("div",{style:{height:300},children:n.jsx(xe,{inline:!0})}):n.jsx(xf,{onSubmit:S,onChange:C,values:v,errors:b,submitting:w,offers:I,showOfferTypeSwitch:u})},wf="_container_jvxwc_1",bf="_error_jvxwc_25",Sf="_medium_jvxwc_28",jf="_select_jvxwc_31",Cf="_disabled_jvxwc_38",kf="_option_jvxwc_69",vs={container:wf,error:bf,medium:Sf,select:jf,disabled:Cf,option:kf},Ac=({required:s,className:t,disabled:e,defaultLabel:r,options:a,optionsStyle:o,editing:i=!0,value:c,onChange:l,id:d,name:u,error:h,helperTextId:g,type:_,...f})=>{const x=w=>{if(!i)return w.preventDefault();l==null||l(w)},y=B(vs.container,{[vs.error]:h,[vs.disabled]:e},t),v={"aria-required":!!s,"aria-invalid":!!(s&&h&&c!==""),"aria-describedby":g},b={id:d,name:u,value:c,disabled:e,className:vs.select,readOnly:!i,required:s,...v,...f};return n.jsx("div",{className:B({[y]:i}),children:n.jsxs("select",{...b,onChange:x,children:[r&&n.jsx("option",{className:B(vs.option,o),value:"",disabled:s,children:r}),a&&a.map(w=>n.jsx("option",{className:B(vs.option,o),value:typeof w=="string"?w:w.value,children:typeof w=="string"?w:w.label},typeof w=="string"?w:w.value))]})})},Tc=({name:s,className:t,label:e,error:r,helperText:a,editing:o=!0,required:i=!1,size:c="medium",testId:l,lang:d,...u})=>n.jsx(on,{className:t,error:r,helperText:a,label:e,required:i,editing:o,testId:l,name:s,size:c,lang:d,renderInput:h=>n.jsx(Ac,{name:s,required:i,editing:o,error:r,size:c,...h,...u})}),Ef="_checkbox_13vmv_1",Pf="_error_13vmv_17",Nf="_row_13vmv_68",sr={checkbox:Ef,error:Pf,row:Nf},Dn=({className:s,label:t,checkboxLabel:e,name:r,onChange:a,editing:o=!0,value:i,helperText:c,error:l,required:d,lang:u,size:h,...g})=>{const _=B(sr.checkbox,{[sr.error]:l},s),f=x=>{if(!o)return x.preventDefault();a==null||a(x)};return n.jsx(on,{className:_,name:r,label:t,editing:o,required:d,error:l,helperText:c,renderInput:({id:x,helperTextId:y})=>n.jsxs("div",{className:sr.row,children:[n.jsx("input",{name:r,type:"checkbox",id:x,value:i,"aria-required":d,"aria-describedby":y,...g,onChange:f,readOnly:!o}),n.jsxs("label",{htmlFor:x,lang:u,children:[d?n.jsx("span",{role:"presentation","aria-hidden":"true",children:"*"}):"",e]})]})})},If="_radio_p1qnp_1",Af="_error_p1qnp_6",yi={radio:If,error:Af},Lc=({name:s,onChange:t,label:e,value:r,editing:a=!0,size:o,values:i,helperText:c,error:l,required:d,disabled:u,lang:h,...g})=>{const _=f=>{if(!a)return f.preventDefault();t==null||t(f)};return n.jsx(on,{name:s,label:e,error:l,helperText:c,required:d,renderInput:({id:f,helperTextId:x})=>n.jsx("div",{id:f,children:i.map(({value:y,label:v},b)=>n.jsxs("div",{className:B(yi.radio,{[yi.error]:l}),lang:h,children:[n.jsx("input",{value:y,name:s,type:"radio",id:f+b,onChange:_,checked:r===y,required:d,disabled:u,"aria-describedby":x,...g}),n.jsx("label",{htmlFor:f+b,children:v})]},b))})})},Tf="_container_n2mrr_1",Lf="_error_n2mrr_10",$f="_disabled_n2mrr_13",Of="_leftControl_n2mrr_16",Df="_input_n2mrr_16",Ff="_rightControl_n2mrr_19",Rf="_control_n2mrr_31",Mf="_dateField_n2mrr_62",Bf="_hiddenInput_n2mrr_102",Xt={container:Tf,error:Lf,disabled:$f,leftControl:Of,input:Df,rightControl:Ff,control:Rf,dateField:Mf,hiddenInput:Bf},Uf=s=>{if(!s)return null;const t=new Date(s);return isNaN(t.getTime())?null:t},$c=s=>s>0&&s<10?`0${s}`:s.toString(),Oc=(s,t,e)=>Math.min(e,Math.max(t,s)),nr=(s,t,e)=>{const r=Oc(parseInt(s),t,e);return isNaN(r)?"":s.length>0&&r<10?$c(r):r.toString()},rr=(s,t,e)=>{const r=Oc(parseInt(s),t,e);return isNaN(r)?"":s.length>1&&r<10?$c(r):r.toString()},Dc=({className:s,label:t,error:e,helperText:r,value:a,onChange:o,format:i="YYYY-MM-DD",name:c,editing:l,lang:d,required:u,onFocus:h,testId:g})=>{const _=Uf(a),[f,x]=p.useState({date:(_==null?void 0:_.getDate().toString())||"",month:_?(_.getMonth()+1).toString():"",year:(_==null?void 0:_.getFullYear().toString())||""}),y=ot("text-field",c),v=ot("helper_text",c),b=p.useRef(null),w=B(Xt.dateField,{[Xt.error]:e},s),j=P=>{P.currentTarget.select(),h==null||h(P)},S=P=>{var N;if(P.key==="Backspace"&&f[P.currentTarget.name]==="")return(N=P.currentTarget.previousElementSibling)==null||N.focus(),P.preventDefault();if(!/^[0-9]$/.test(P.key)&&P.key!=="Tab"&&P.key!=="Backspace")return P.preventDefault()},C=P=>{const{name:N,value:$}=P.target;x(O=>{const U=N==="date"?nr($,1,31):O.date,H=N==="month"?nr($,1,12):O.month,T=N==="year"?nr($,1900,2100):O.year;return{date:U,month:H,year:T}})},I=(P,N,$)=>{var T,M;const O=(T=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"value"))==null?void 0:T.set,U=P&&N&&$?i.replace("YYYY",$).replace("MM",N).replace("DD",P):"";O==null||O.call(b.current,U);const H=new Event("input",{bubbles:!0});(M=b.current)==null||M.dispatchEvent(H)},E=P=>{var M;const{name:N,value:$}=P.target,O=(M=P.currentTarget)==null?void 0:M.nextElementSibling,U=N==="date"?rr($,0,31):f.date,H=N==="month"?rr($,0,12):f.month,T=N==="year"?rr($,0,2100).slice(0,4):f.year;x({date:U,month:H,year:T}),I(U,H,T),(O&&N==="month"&&H.length===2||N==="date"&&U.length===2)&&setTimeout(()=>O.focus(),1)};return n.jsx(on,{className:w,name:c,helperText:r,error:e,label:t,editing:l,lang:d,required:u,testId:g,renderInput:()=>n.jsxs("div",{className:Xt.container,children:[n.jsx("input",{ref:b,id:`${y}-hidden`,className:Xt.hiddenInput,name:c,onChange:o,"aria-invalid":e,"aria-describedby":v}),n.jsx("input",{className:Xt.input,name:"date",placeholder:"dd",value:f.date,onFocus:j,onBlur:C,onChange:E,onKeyDown:S,maxLength:2,type:"number",id:`${y}-date`,autoComplete:"bday-day"})," / ",n.jsx("input",{className:Xt.input,name:"month",placeholder:"mm",value:f.month,onFocus:j,onBlur:C,onChange:E,onKeyDown:S,maxLength:2,type:"number",id:`${y}-month`,autoComplete:"bday-month"})," / ",n.jsx("input",{className:Xt.input,name:"year",placeholder:"yyyy",value:f.year,onFocus:j,onBlur:C,onChange:E,onKeyDown:S,maxLength:4,type:"number",id:`${y}-year`,autoComplete:"bday-year"})]})})},Hf="_title_a6ei2_1",vi={title:Hf,continue:"_continue_a6ei2_7"},Wf=({initialValues:s,onSubmit:t,fields:e,questions:r,onQuestionChange:a,questionValues:o,questionErrors:i})=>{var y,v,b,w,j;const{t:c}=A("account"),{setValue:l,handleSubmit:d,handleChange:u,values:h,errors:g,validationSchemaError:_,submitting:f}=jt({initialValues:s,onSubmit:t}),x=({value:S,key:C,question:I,required:E,enabled:P})=>{if(!P)return null;const N=S==null?void 0:S.split(";").map(O=>{const[U,H=U]=O.split(":");return{value:U,label:H}}),$={name:C,onChange:a,error:!!i[C],helperText:i[C],required:E,key:C};return N.length===1&&N[0].value===""?n.jsx(de,{value:o[C],label:I,...$}):N.length===1?n.jsx(Dn,{checked:!!o[C],value:N[0].value,label:I,checkboxLabel:N[0].label,...$}):N.length===2?n.jsx(Lc,{values:N,value:o[C],label:I,...$}):N.length>2?n.jsx(Tc,{options:N,value:o[C],label:I,defaultLabel:c("personal_details.select_answer"),...$}):null};return n.jsxs("form",{onSubmit:d,"data-testid":void 0,noValidate:!0,children:[n.jsx("h2",{className:vi.title,children:c("personal_details.title")}),g.form?n.jsx(Pe,{variant:"error",visible:!_,children:g.form}):null,(y=e.firstNameLastName)!=null&&y.enabled?n.jsxs(Ee.Fragment,{children:[n.jsx(de,{value:h.firstName,onChange:u,label:c("personal_details.fist_name"),placeholder:c("personal_details.fist_name"),error:!!g.firstName,helperText:g.firstName,required:e.firstNameLastName.required,name:"firstName",autoComplete:"given-name"}),n.jsx(de,{value:h.lastName,onChange:u,label:c("personal_details.last_name"),placeholder:c("personal_details.last_name"),error:!!g.lastName,helperText:g.lastName,required:e.firstNameLastName.required,name:"lastName",autoComplete:"family-name"})]}):null,(v=e.companyName)!=null&&v.enabled?n.jsx(de,{value:h.companyName,onChange:u,label:c("personal_details.company_name"),placeholder:c("personal_details.company_name"),error:!!g.companyName,helperText:g.companyName,required:e.companyName.required,name:"companyName",autoComplete:"organization"}):null,(b=e.address)!=null&&b.enabled?n.jsxs(Ee.Fragment,{children:[n.jsx(de,{value:h.address,onChange:u,label:c("personal_details.address"),placeholder:c("personal_details.address"),error:!!g.address,helperText:g.address,required:e.address.required,name:"address",autoComplete:"address-line1"}),n.jsx(de,{value:h.address2,onChange:u,label:c("personal_details.address2"),placeholder:c("personal_details.address2"),error:!!g.address2,helperText:g.address2,name:"address2",autoComplete:"address-line2"}),n.jsx(de,{value:h.city,onChange:u,label:c("personal_details.city"),placeholder:c("personal_details.city"),error:!!g.city,helperText:g.city,required:e.address.required,name:"city",autoComplete:"address-level2"}),n.jsx(de,{value:h.state,onChange:u,label:c("personal_details.state"),placeholder:c("personal_details.state"),error:!!g.state,helperText:g.state,required:e.address.required,name:"state",autoComplete:"address-level1"}),n.jsx(de,{value:h.postCode,onChange:u,label:c("personal_details.post_code"),placeholder:c("personal_details.post_code"),error:!!g.postCode,helperText:g.postCode,required:e.address.required,name:"postCode",autoComplete:"postal-code"})]}):null,(w=e.phoneNumber)!=null&&w.enabled?n.jsx(de,{value:h.phoneNumber,onChange:u,label:c("personal_details.phone_number"),placeholder:c("personal_details.phone_number"),error:!!g.phoneNumber,helperText:g.phoneNumber,required:e.phoneNumber.required,name:"phoneNumber"}):null,(j=e.birthDate)!=null&&j.enabled?n.jsx(Dc,{value:h.birthDate,onChange:S=>l("birthDate",S.currentTarget.value),label:c("personal_details.birth_date"),error:!!g.birthDate,helperText:g.birthDate,required:e.birthDate.required,name:"birthDate"}):null,r.map(S=>x(S)),n.jsx(D,{className:vi.continue,type:"submit",label:c("personal_details.continue"),variant:"contained",color:"primary",size:"large",disabled:f,fullWidth:!0}),f&&n.jsx(xe,{transparentBackground:!0,inline:!0})]})},Et=(s,t)=>s?F().required(t):ns().notRequired(),Vf=()=>{const s=G(fe),t=oe(),e=le(),{t:r}=A("account"),a=z(w=>w.accessModel),{data:o,isLoading:i}=qe("captureStatus",s.getCaptureStatus),{mediaOffers:c}=Zr(),l=c.length>0,[d,u]=p.useState({}),[h,g]=p.useState({}),_=p.useMemo(()=>Object.fromEntries((o==null?void 0:o.settings.map(w=>[w.key,w]))||[]),[o]),f=p.useMemo(()=>(o==null?void 0:o.settings.filter(w=>!!w.question))||[],[o]),x=p.useCallback(()=>{const w=a===$e.SVOD||a===$e.AUTHVOD&&l;t(V(e,w?"choose-offer":"welcome"),{replace:!0})},[t,e,a,l]);p.useEffect(()=>{o&&((!o.isCaptureEnabled||!o.shouldCaptureBeDisplayed)&&x(),f&&u(Object.fromEntries(f.map(w=>[w.key,""]))))},[o,x,f]);const y=p.useMemo(()=>{const[w,j]=(()=>{var S,C;if((S=_.firstNameLastName)!=null&&S.enabled){const I=(C=_.firstNameLastName)==null?void 0:C.answer;return[(I==null?void 0:I.firstName)||"",(I==null?void 0:I.lastName)||""]}return["",""]})();return{firstName:w,lastName:j,birthDate:"",companyName:"",phoneNumber:"",address:"",address2:"",city:"",state:"",postCode:"",country:""}},[_]),v=w=>{const j=w.target.type==="checkbox"&&!w.target.checked?"":w.target.value;u(S=>({...S,[w.target.name]:j}))},b=async(w,{setErrors:j,setSubmitting:S,setValidationSchemaError:C,validate:I})=>{var $,O,U,H,T,M,Z,Q,q,k;const E=r("personal_details.this_field_is_required"),P=re().shape({firstName:Et(!!(($=_.firstNameLastName)!=null&&$.required),E),lastName:Et(!!((O=_.firstNameLastName)!=null&&O.required),E),address1:Et(!!((U=_.address)!=null&&U.required),E),address2:Et(!!((H=_.address)!=null&&H.required),E),postCode:Et(!!((T=_.address)!=null&&T.required),E),state:Et(!!((M=_.address)!=null&&M.required),E),city:Et(!!((Z=_.address)!=null&&Z.required),E),companyName:Et(!!((Q=_.companyName)!=null&&Q.required),E),birthDate:(q=_.birthDate)!=null&&q.required?F().required(E).matches(/\d{4}-\d{2}-\d{2}/,r("personal_details.birth_date_not_valid")):ns().notRequired(),phoneNumber:Et(!!((k=_.phoneNumber)!=null&&k.required),E)}),N={};if(f.forEach(L=>{L.enabled&&L.required&&!d[L.key]&&(N[L.key]=r("personal_details.this_field_is_required"))}),g(N),!I(P)||Object.keys(N).length){S(!1),C(!0);return}try{const L=X=>Object.fromEntries(Object.keys(X).filter(se=>X[se]!=="").map(se=>[se,X[se]])),W=f.map(X=>({question:X.question,questionId:X.key,value:d[X.key]}));await s.updateCaptureAnswers(L({...w,customAnswers:W})),x()}catch(L){L instanceof Error&&j({form:L.message})}S(!1)};return i?n.jsx("div",{style:{height:400},children:n.jsx(xe,{inline:!0})}):n.jsx(Wf,{initialValues:y,fields:_,questions:f,onQuestionChange:v,questionValues:d,questionErrors:h,onSubmit:b})};function Fc(s){const t=G(fe),{data:e,error:r}=qe(["socialUrls",s],()=>t.getSocialLoginUrls(s),{enabled:t.getFeatures().hasSocialURLs,retry:!1}),a=p.useMemo(()=>e?e.reduce((o,i)=>({...o,...i}),{}):null,[e]);return r||!a?null:a}const Rc=({type:s,value:t="",label:e,options:r,editing:a,lang:o,...i})=>{const{t:c,i18n:l}=A(),d=p.useMemo(()=>s&&["country","us_state"].includes(s)?Object.keys(l.getResourceBundle(l.language,s)).map(h=>({value:h,label:c(`${s}:${h}`)})):r?Object.entries(r).map(([u,h])=>({value:u,label:h})):[],[s,r,l,c]);switch(s){case"input":return n.jsx(de,{...i,value:String(t),label:e,testId:void 0});case"radio":return n.jsx(Lc,{...i,label:e,values:d,value:String(t),"data-testid":void 0,lang:o});case"select":case"country":case"us_state":return n.jsx(Tc,{...i,options:d,value:String(t),label:e,defaultLabel:i.placeholder,testId:void 0,lang:o});case"datepicker":return n.jsx(Dc,{...i,value:String(t),label:e,testId:void 0});default:return n.jsx(Dn,{...i,checkboxLabel:e,checked:os(t),"data-testid":void 0,lang:o})}},qf="_link_1nyb9_1",zf={link:qf},Zs=({to:s,href:t,children:e,className:r,onClick:a,target:o,...i})=>{const c=B(zf.link,r);return s?n.jsx(en,{to:s,className:c,onClick:a,...i,children:e}):n.jsx("a",{href:t,className:c,onClick:a,target:o,rel:o==="_blank"?"noreferrer":void 0,...i,children:e})},Gf="_title_io7pr_1",Jf="_bottom_io7pr_11",Yf="_alreadyAccount_io7pr_16",Kf="_login_io7pr_20",Qf="_customFields_io7pr_27",yn={title:Gf,continue:"_continue_io7pr_7",bottom:Jf,alreadyAccount:Yf,login:Kf,customFields:Qf},Zf=({onSubmit:s,onChange:t,onBlur:e,values:r,errors:a,submitting:o,validationError:i,loading:c,publisherConsents:l,consentValues:d,onConsentChange:u,consentErrors:h})=>{const{t:g,i18n:_}=A("account"),f=le(),x=p.useRef(null),y=_.language!==K.APP_DEFAULT_LANGUAGE?K.APP_DEFAULT_LANGUAGE:void 0,v=b=>{const w=$r.sanitize(b),j=/<a(.|\n)*?>/.test(w),S=/<\/a(.|\n)*?>/.test(w);return j&&S?n.jsx("span",{dangerouslySetInnerHTML:{__html:b}}):b};return p.useEffect(()=>{var b;a.form&&((b=x.current)==null||b.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}))},[a.form]),n.jsxs("form",{onSubmit:s,"data-testid":void 0,noValidate:!0,children:[n.jsx("div",{ref:x,children:a.form?n.jsx(Pe,{variant:"error",visible:!i,children:a.form}):null}),n.jsx("h2",{className:yn.title,children:g("registration.sign_up")}),n.jsx(de,{value:r.email,onChange:t,onBlur:e,label:g("registration.email"),placeholder:g("registration.email"),error:!!a.email,helperText:a.email,name:"email",type:"email",autoComplete:"email",required:!0}),n.jsx(Ys,{value:r.password,onChange:t,onBlur:e,label:g("registration.password"),placeholder:g("registration.password"),error:!!a.password,name:"password",autoComplete:"new-password",required:!0}),l&&n.jsx("div",{className:yn.customFields,"data-testid":"custom-reg-fields",children:l.map(b=>{const w=h.find(j=>j===b.name);return n.jsx(Rc,{type:b.type,name:b.name,options:b.options,label:v(b.label),placeholder:b.placeholder,value:d[b.name]||"",required:b.required,error:!!w,helperText:w?g("registration.field_required"):void 0,onChange:u,lang:y},b.name)})}),n.jsx(D,{className:yn.continue,type:"submit",label:g("registration.continue"),variant:"contained",color:"primary",size:"large",disabled:o,fullWidth:!0}),n.jsxs("p",{className:yn.bottom,children:[g("registration.already_account")," ",n.jsx(Zs,{to:V(f,"login"),children:g("login.sign_in")})]}),(c||o)&&n.jsx(xe,{transparentBackground:!0,inline:!0})]})},Xf=()=>{const s=G(fe),t=oe(),e=le(),{t:r}=A("account"),a=Ge(),[o,i]=p.useState({}),[c,l]=p.useState([]),{publisherConsents:d,publisherConsentsLoading:u,loading:h}=R(({publisherConsents:S,publisherConsentsLoading:C,loading:I})=>({publisherConsents:S,publisherConsentsLoading:C,loading:I})),g=({currentTarget:S})=>{if(!S)return;const{name:C,type:I}=S,E=I==="checkbox"?S.checked:S.value;i(P=>({...P,[C]:E})),l(P=>P.filter(N=>N!==C))};p.useEffect(()=>{if(!d){s.getPublisherConsents();return}i(iu(d))},[s,d]);const _=Fc(It("personal-details")),{handleSubmit:f,handleChange:x,handleBlur:y,values:v,errors:b,validationSchemaError:w,submitting:j}=jt({initialValues:{email:"",password:""},validationSchema:re().shape({email:F().email(r("registration.field_is_not_valid_email")).required(r("registration.field_required",{field:r("registration.email")})),password:F().matches(/^(?=.*[a-z])(?=.*[0-9]).{8,}$/,r("registration.invalid_password",{field:r("registration.password")})).required(r("registration.field_required",{field:r("registration.password")}))}),validateOnBlur:!0,onSubmit:async({email:S,password:C})=>{const{consentsErrors:I}=cu(d||[],o);if(I.length)throw l(I),new Error(r("registration.consents_error"));await s.register(S,C,window.location.href,kn(d,o))},onSubmitSuccess:()=>{a(r("registration.success"),"success"),t(V(e,"personal-details"))}});return n.jsx(Zf,{onSubmit:f,onChange:x,onConsentChange:g,onBlur:y,values:v,errors:b,consentErrors:c,validationError:w,submitting:j,consentValues:o,publisherConsents:d,loading:h||u,socialLoginURLs:_})},eg="_title_8jji7_1",tg="_link_8jji7_7",sg="_bottom_8jji7_11",ng="_top_8jji7_16",ar={title:eg,link:tg,bottom:sg,top:ng},rg=({onSubmit:s,onChange:t,values:e,errors:r,validationError:a,submitting:o,siteName:i})=>{const[c,l]=Jr(),{t:d}=A("account"),u=le();return n.jsxs("form",{onSubmit:s,"data-testid":void 0,noValidate:!0,children:[r.form?n.jsx(Pe,{variant:"error",visible:!a,children:r.form}):null,n.jsx("h2",{className:ar.title,children:d("login.sign_in")}),n.jsx(de,{value:e.email,onChange:t,label:d("login.email"),placeholder:d("login.email"),error:!!r.email,helperText:r.email,name:"email",type:"email",required:!0,testId:"login-email-input",autoComplete:"email"}),n.jsx(de,{value:e.password,onChange:t,label:d("login.password"),placeholder:d("login.password"),error:!!r.password,helperText:r.password,name:"password",type:c?"text":"password",rightControl:n.jsx(ze,{"aria-label":d("login.view_password"),onClick:()=>l(),"aria-pressed":c,children:n.jsx(J,{icon:c?Yr:Kr})}),required:!0,testId:"login-password-input",autoComplete:"current-password"}),o&&n.jsx(xe,{transparentBackground:!0,inline:!0}),n.jsx(Zs,{className:ar.link,to:V(u,"forgot-password"),children:d("login.forgot_password")}),n.jsx(D,{type:"submit",label:d("login.sign_in"),variant:"contained",color:"primary",size:"large",disabled:o,fullWidth:!0}),n.jsxs("p",{className:ar.bottom,children:[d("login.not_registered",{siteName:i})," ",n.jsx(Zs,{to:V(u,"create-account"),children:d("login.sign_up")})]})]})},ag=()=>{const s=G(fe),{siteName:t}=z(_=>_.config),e=oe(),r=le(),{t:a}=A("account"),o=Ge(),i=Fc(window.location.href.split("?")[0]),{values:c,errors:l,submitting:d,validationSchemaError:u,handleSubmit:h,handleChange:g}=jt({initialValues:{email:"",password:""},validationSchema:re().shape({email:F().email(a("login.field_is_not_valid_email")).required(a("login.field_required",{field:a("login.email")})),password:F().required(a("login.field_required",{field:a("login.password")}))}),onSubmit:({email:_,password:f})=>s.login(_,f,window.location.href),onSubmitSuccess:()=>{o(a("login.sign_in_success"),"success"),e(V(r,null))},onSubmitError:({resetValue:_})=>_("password")});return n.jsx(rg,{values:c,validationError:u,errors:l,submitting:d,siteName:t,socialLoginURLs:i,onSubmit:h,onChange:g})},og="_banner_ygdsu_1",ig={banner:og},cg=["login","create-account","forgot-password","reset-password","send-confirmation","edit-password"],lg=()=>{const s=oe(),t=le(),e=Re("u"),r=p.useRef(e),a=Re("message"),{loading:o,user:i}=R(({loading:v,user:b})=>({loading:v,user:b}),ce),c=z(v=>v.config),{assets:{banner:l},siteName:d}=c,u=e&&cg.includes(e),h=ge(()=>{s(V(t,"login"))}),g=p.useMemo(()=>(e&&(r.current=e),r.current),[e]);p.useEffect(()=>{e&&!o&&!i&&!u&&h()},[e,o,u,i,h]);const _=ge(()=>{s(xc(t,{u:null,message:null}))}),f=()=>{if(!i&&o&&!u)return n.jsx("div",{style:{height:300},children:n.jsx(xe,{inline:!0})});switch(g){case"login":return n.jsx(ag,{});case"create-account":return n.jsx(Xf,{});case"personal-details":return n.jsx(Vf,{});case"choose-offer":return n.jsx(_i,{});case"edit-card":return n.jsx(Vm,{});case"upgrade-subscription":return n.jsx(_i,{});case"upgrade-subscription-error":return n.jsx(Jn,{type:"error",onCloseButtonClick:_});case"upgrade-subscription-success":return n.jsx(Jn,{type:"success",onCloseButtonClick:_});case"upgrade-subscription-pending":return n.jsx(Jn,{type:"pending",onCloseButtonClick:_});case"checkout":return n.jsx(rf,{});case"payment-error":return n.jsx(ni,{type:"error",message:a,onCloseButtonClick:_});case"payment-cancelled":return n.jsx(ni,{type:"cancelled",message:a,onCloseButtonClick:_});case"welcome":return n.jsx(hh,{onCloseButtonClick:_,onCountdownCompleted:_,siteName:d});case"reset-password":return n.jsx(Xn,{type:"reset"});case"forgot-password":return n.jsx(Xn,{type:"forgot"});case"add-password":return n.jsx(fi,{type:"add"});case"delete-account":case"delete-account-confirmation":return n.jsx(am,{});case"warning-account-deletion":return n.jsx(bm,{});case"send-confirmation":return n.jsx(Xn,{type:"confirmation"});case"edit-password":return n.jsx(fi,{});case"unsubscribe":return n.jsx(hp,{});case"renew-subscription":return n.jsx(op,{});case"payment-method":case"payment-method-success":return n.jsx(Om,{onCloseButtonClick:_});case"waiting-for-payment":return n.jsx(hm,{});case"finalize-payment":return n.jsx(cm,{})}},x=!["delete-account","delete-account-confirmation","edit-card","warning-account-deletion"].includes(g??""),y=["delete-account-confirmation"].includes(g??"")?"large":"small";return n.jsxs(Gr,{size:y,open:!!e,onClose:_,children:[x&&l&&n.jsx("div",{className:ig.banner,children:n.jsx("img",{src:l,alt:""})}),f()]})},dg={jwpAuth:{id:"9qqwmnbx",label:"JWP AUTHVOD"},jwpSvod:{id:"a2kbjdv0",label:"JWP SVOD"},jwpAuthNoWatchlist:{id:"oqrsyxin",label:"JWP Authvod (No WL)"},basicNoAuth:{id:"gnnuzabk",label:"Demo App (No Auth)"},noStyling:{id:"kujzeu1b",label:"No Styling (No Auth)"},inlinePlayer:{id:"ata6ucb8",label:"Inline Player"},cleengAuthvod:{id:"nvqkufhy",label:"Cleeng Authvod"},cleengAuthvodNoWatchlist:{id:"7weyqrua",label:"Cleeng Authvod (No WL)"},svod:{id:"ozylzc5m",label:"Cleeng SVOD"}},ug=dg;[...Object.values(ug).map(({id:s,label:t})=>({value:s,label:`${s.length>8?"ext-json":s} - ${t}`}))];const hg=G(Hr),mg=(s,t)=>{const e=Or(),r=()=>e.invalidateQueries({queryKey:["entitlements"]}),{data:a,isLoading:o,error:i,isSuccess:c,refetch:l}=qe("config-init",()=>hg.initializeApp(s,r),{refetchInterval:!1,retry:1,onSettled:d=>{Nt("Bootstrap","Initialized application",{...d}),t(d==null?void 0:d.config)},cacheTime:Ns,staleTime:Is});return{data:a,isLoading:o,error:i,isSuccess:c,refetch:l}},pg=s=>{const t=document.querySelector(":root"),{backgroundColor:e,highlightColor:r,headerBackground:a}=s.styling||{},o=K.APP_BODY_FONT,i=K.APP_BODY_ALT_FONT;t&&(t.style.setProperty("--highlight-color",r||"#fff"),t.style.setProperty("--highlight-contrast-color",r?Vn(r):"#000"),a&&(t.style.setProperty("--header-background",a),t.style.setProperty("--header-contrast-color",Vn(a))),e&&(t.style.setProperty("--body-background-color",e),t.style.setProperty("--background-contrast-color",Vn(e))),o&&t.style.setProperty("--body-font-family",o),i&&t.style.setProperty("--body-alt-font-family",i))},fg="_title_gkrmh_1",gg="_body_gkrmh_8",_g="_confirmButton_gkrmh_12",or={title:fg,body:gg,confirmButton:_g},yg=({open:s,title:t,body:e,onConfirm:r,onClose:a,busy:o})=>{const{t:i}=A("common");return n.jsxs(Gr,{open:s,onClose:a,role:"alertdialog",children:[n.jsx("h2",{className:or.title,children:t}),n.jsx("p",{className:or.body,children:e}),n.jsx(D,{className:or.confirmButton,label:i("confirmation_dialog.confirm"),variant:"contained",color:o?"default":"primary",onClick:r,fullWidth:!0,disabled:o,busy:o}),n.jsx(D,{label:i("confirmation_dialog.close"),variant:"outlined",onClick:a,fullWidth:!0,disabled:o})]})},vg=()=>{const s=Ol();return n.jsx(et,{error:s})},xg="_markdown_dgrjv_1",wg={markdown:xg},bg={link(s,t,e){const r=/^(https?|www\.|\/\/)/.test(s||""),a=r?'target="_blank"':void 0,o=r?'rel="noopener"':void 0,i=t?`title="${t}"`:void 0,c=[a,o,i].filter(Boolean);return`<a href="${s}" ${c.join(" ")}>${e}</a>`}};wr.use({renderer:bg});const Xr=({markdownString:s,className:t,tag:e="div",inline:r=!1})=>{const a=p.useMemo(()=>{const i=(r?wr.parseInline:wr.parse)(s);return $r.sanitize(i,{ADD_ATTR:["target"]})},[r,s]);return Ee.createElement(e,{dangerouslySetInnerHTML:{__html:a},className:B(wg.markdown,t)})},Sg="_about_c4gxs_1",jg={about:Sg},Cg=()=>n.jsx(Xr,{className:jg.about,markdownString:`# About JW OTT Webapp
  
JW OTT Webapp is an open-source, dynamically generated video website built around JW Player and JW Platform services. It enables you to easily publish your JW Player-hosted video content with no coding and minimal configuration.

To see an example of JW OTT Webapp in action, see [https://app-preview.jwplayer.com/](https://app-preview.jwplayer.com/).

## Supported Features

- Works with any JW Player edition, from Free to Enterprise (note that usage will count against your monthly JW streaming limits). Only cloud-hosted JW Players are supported.
- It looks great on any device. The responsive UI automatically optimizes itself for desktop, tablet, and mobile screens.
- Populates your site's media content using JSON feeds. If you are using JW Platform, this happens auto-magically based on playlists that you specify. Using feeds from other sources will require you to hack the source code.
- Video titles, descriptions and hero images are populated from JW Platform JSON feed metadata.
- Playback of HLS video content from the JW Platform CDN. You can add external URLs (for example, URLS from your own server or CDN) to your playlists in the Content section of your JW Player account dashboard, but they must be HLS streams (\`.m3u8\` files).
- Support for live video streams (must be registered as external .m3u8 URLs in your JW Dashboard).
- Customize the user interface with your own branding. The default app is configured for JW Player branding and content, but you can easily change this to use your own assets by modifying the \`config.json\` file. Advanced customization is possible (for example, editing the CSS files), but you will need to modify the source code and build from source.
- Site-wide video search and related video recommendations powered by [JW Recommendations](https://docs.jwplayer.com/platform/docs/vdh-learn-about-recommendations).
- Basic playback analytics is reported to your JW Dashboard.
- Ad integrations (VAST, VPAID, GoogleIMA, etc.). These features require a JW Player Ads Edition license. For more information, see the [JW Player pricing page](https://www.jwplayer.com/pricing/).
- A "Favorites" feature for users to save videos for watching later. A separate list for "Continue Watching" is also kept so users can resume watching videos from where they left off. The lists are per-browser at this time (i.e., lists do not sync across user's browsers or devices). The "Continue Watching" list can be disabled in your JW OTT Webapp's \`config.json\` file.
- A grid view for a particular playlist of videos, with the ability to deep-link to the playlist through a static URL.
- Social sharing options using the device native sharing dialog.

## Unsupported Features

- Security-related features (encrypted HLS, DRM, signed URLs)
- Self-hosted JW Players`}),kg=hc(30),Mc=({type:s,contentId:t,siteId:e,enabled:r,usePlaceholderData:a,params:o={},queryClient:i})=>{const c=G(Me);return{enabled:!!t&&r,queryKey:["playlist",s,t],queryFn:async()=>{var l;if(s===Jt.playlist){const d=await c.getPlaylistById(t,o);return(l=d==null?void 0:d.playlist)==null||l.forEach(u=>{i.setQueryData(["media",u.mediaid],u)}),d}else if(s===Jt.content_list)return await c.getContentList({siteId:e,id:t})},placeholderData:t&&a?kg:void 0,refetchInterval:l=>l&&(os(l.refetch)||l.playlist.some(Ki))?1e3*30:!1,retry:!1}};function cn(s,t={},e=!0,r=!0,a=Jt.playlist){const o=Or(),i=z(l=>l.config.siteId),c=Mc({type:a,contentId:s,siteId:i,params:t,queryClient:o,enabled:e,usePlaceholderData:r});return qe(c)}const Eg=s=>!nd.some(t=>t===s),Pg=(s,t=void 0)=>{const e=rd.toString(),r=Or(),a=z(d=>d.config.siteId),o=lt(d=>d.getPlaylist()),i=ut(d=>d.getPlaylist()),c=Ui(s.map(({contentId:d,type:u},h)=>Eg(u)?Mc({enabled:!t||t>h,type:u,siteId:a,contentId:d,queryClient:r,usePlaceholderData:!0,params:{page_limit:e}}):{enabled:!1}));return s.map(({type:d},u)=>{if(d===ht.Favorites)return{data:o,isLoading:!1,isSuccess:!0};if(d===ht.ContinueWatching)return{data:i,isLoading:!1,isSuccess:!0};const{data:h,isSuccess:g,error:_,isPlaceholderData:f}=c[u];return{data:h,isSuccess:g,error:_,isPlaceholderData:f}})},Bc=s=>p.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},p.createElement("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})),ea=s=>p.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},p.createElement("path",{d:"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"})),vn=(s,t)=>{typeof s.addEventListener>"u"?s.addListener(t):s.addEventListener("change",t)},xn=(s,t)=>{typeof s.removeEventListener>"u"?s.removeListener(t):s.removeEventListener("change",t)},Pr=matchMedia("screen and (max-width: 479px)"),Nr=matchMedia("screen and (min-width: 480px) and (max-width: 767px)"),Ir=matchMedia("screen and (min-width: 768px) and (max-width: 1023px)"),Ar=matchMedia("screen and (min-width: 1024px) and (max-width: 1199px)");var te=(s=>(s[s.xs=0]="xs",s[s.sm=1]="sm",s[s.md=2]="md",s[s.lg=3]="lg",s[s.xl=4]="xl",s))(te||{});const xi=()=>Pr.matches?0:Nr.matches?1:Ir.matches?2:Ar.matches?3:4,Ne=()=>{const[s,t]=p.useState(()=>xi());return p.useEffect(()=>{const e=()=>t(xi());return vn(Pr,e),vn(Nr,e),vn(Ir,e),vn(Ar,e),()=>{xn(Pr,e),xn(Nr,e),xn(Ir,e),xn(Ar,e)}},[]),s},ta=s=>p.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},p.createElement("path",{fill:"currentColor",d:"M12,17A2,2 0 0,0 14,15C14,13.89 13.1,13 12,13A2,2 0 0,0 10,15A2,2 0 0,0 12,17M18,8A2,2 0 0,1 20,10V20A2,2 0 0,1 18,22H6A2,2 0 0,1 4,20V10C4,8.89 4.9,8 6,8H7V6A5,5 0 0,1 12,1A5,5 0 0,1 17,6V8H18M12,3A3,3 0 0,0 9,6V8H15V6A3,3 0 0,0 12,3Z"})),sa=s=>p.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},p.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),p.createElement("path",{d:"M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM7 10h5v5H7z"})),Ng="_image_f8aiq_1",Ig={image:Ng},Ag=(s,t)=>Se(s,{width:t}),ir=new Map,Tg=async(s,t)=>{const e=Ag(s,t);let r=e;if(ir.has(e))return ir.get(e);try{const a=await fetch(e);a.redirected&&(r=a.url.replace("-1920",`-${t}`)),ir.set(e,r)}catch(a){Xi("Image","Failed to fetch image",{error:a,url:r})}return r},Lg=({className:s,image:t,onLoad:e,alt:r="",width:a=640})=>{const[o,i]=p.useState(null);return p.useEffect(()=>{if(!t)return;(async()=>{const l=await Tg(t,a);i(l),e==null||e()})()},[t,a,e]),o?n.jsx("img",{className:`${s} ${Ig.image}`,src:o,alt:r}):null},$s=Ee.memo(Lg),$g="_card_1s56n_1",Og="_poster_1s56n_18",Dg="_featured_1s56n_22",Fg="_title_1s56n_22",Rg="_tag_1s56n_36",Mg="_meta_1s56n_45",Bg="_disabled_1s56n_53",Ug="_current_1s56n_73",Hg="_posterImage_1s56n_82",Wg="_currentLabel_1s56n_90",Vg="_aspect11_1s56n_106",qg="_aspect21_1s56n_110",zg="_aspect23_1s56n_114",Gg="_aspect43_1s56n_118",Jg="_aspect53_1s56n_122",Yg="_aspect169_1s56n_126",Kg="_aspect916_1s56n_130",Qg="_aspect913_1s56n_134",Zg="_titleContainer_1s56n_138",Xg="_loading_1s56n_161",e_="_scheduledStart_1s56n_176",t_="_tags_1s56n_198",s_="_lock_1s56n_220",n_="_live_1s56n_229",r_="_scheduled_1s56n_176",a_="_progressContainer_1s56n_239",o_="_progressBar_1s56n_249",pe={card:$g,poster:Og,featured:Dg,title:Fg,tag:Rg,meta:Mg,disabled:Bg,current:Ug,posterImage:Hg,currentLabel:Wg,aspect11:Vg,aspect21:qg,aspect23:zg,aspect43:Gg,aspect53:Jg,aspect169:Yg,aspect916:Kg,aspect913:Qg,titleContainer:Zg,loading:Xg,scheduledStart:e_,tags:t_,lock:s_,live:n_,scheduled:r_,progressContainer:a_,progressBar:o_};function i_({onHover:s,progress:t,item:e,posterAspect:r="16:9",featured:a=!1,disabled:o=!1,loading:i=!1,isCurrent:c=!1,isLocked:l=!0,currentLabel:d,headingLevel:u=3,url:h,tabIndex:g=0}){const{title:_,duration:f,episodeNumber:x,seasonNumber:y,cardImage:v,mediaStatus:b,scheduledStart:w}=e,{t:j,i18n:{language:S}}=A(["common","video"]),C=B(pe.card,{[pe.featured]:a,[pe.disabled]:o}),I=r?pe[`aspect${r.replace(":","")}`]:void 0,E=B(pe.poster,I,{[pe.current]:c}),P=sc(e),N=b===Tt.LIVE||rc(e),$=b===Tt.SCHEDULED,O=()=>{if(i||!_)return null;if(P)return n.jsx("div",{className:pe.tag,children:j("video:series")});if(x)return n.jsx("div",{className:pe.tag,children:Ln(y,x)});if(f)return n.jsx("div",{className:pe.tag,children:Wr(f)});if(N)return n.jsx("div",{className:B(pe.tag,pe.live),children:j("live")});if($)return n.jsxs("div",{className:pe.tag,children:[n.jsx(J,{icon:sa,className:pe.scheduled}),j("scheduled")]})},U=Ee.createElement(`h${u}`,{className:B(pe.title,{[pe.loading]:i})},i?"":_);return n.jsxs(en,{role:"button",to:h,className:C,onClick:o?H=>H.preventDefault():void 0,onMouseEnter:s,tabIndex:o?-1:g,"data-testid":void 0,children:[!a&&n.jsxs("div",{className:pe.titleContainer,children:[U,!!w&&Yi(e)&&n.jsx("div",{className:B(pe.scheduledStart,{[pe.loading]:i}),children:En(w,S)})]}),n.jsxs("div",{className:E,children:[n.jsx($s,{className:pe.posterImage,image:v,width:a?640:320,alt:""}),!i&&n.jsxs("div",{className:pe.meta,children:[a&&U,n.jsxs("div",{className:pe.tags,children:[l&&n.jsx("div",{className:B(pe.tag,pe.lock),"aria-label":j("card_lock"),role:"img",children:n.jsx(J,{icon:ta})}),O()]})]}),c&&n.jsx("div",{className:pe.currentLabel,children:d}),t?n.jsx("div",{className:pe.progressContainer,children:n.jsx("div",{className:pe.progressBar,style:{width:`${Math.round(t*100)}%`}})}):null]})]})}const Uc=p.memo(i_),c_="_shelf_1x4ps_1",l_="_chevron_1x4ps_6",d_="_loadingTitle_1x4ps_10",u_="_title_1x4ps_18",h_="_slider_1x4ps_31",m_="_dots_1x4ps_73",p_="_dot_1x4ps_73",f_="_active_1x4ps_91",g_="_error_1x4ps_96",_t={shelf:c_,chevron:l_,loadingTitle:d_,title:u_,slider:h_,dots:m_,dot:p_,active:f_,error:g_},__={[te.xs]:1,[te.sm]:2,[te.md]:3,[te.lg]:4,[te.xl]:5},y_={[te.xs]:1,[te.sm]:1,[te.md]:1,[te.lg]:1,[te.xl]:1},v_=({playlist:s,type:t,onCardHover:e,title:r,watchHistory:a,featured:o=!1,loading:i=!1,error:c=null,accessModel:l,isLoggedIn:d,hasSubscription:u,posterAspect:h,visibleTilesDelta:g=0})=>{const _=Ne(),{t:f}=A("common"),x=(o?y_[_]:__[_])+g,y=p.useCallback(({item:j,isVisible:S})=>{const C=Le({media:j,playlistId:s.feedid,play:t===ht.ContinueWatching});return n.jsx(Uc,{progress:a?a[j.mediaid]:void 0,onHover:typeof e=="function"?()=>e(j):void 0,featured:o,disabled:!S,loading:i,isLocked:Tn(l,d,u,j),posterAspect:h,item:j,url:C},j.mediaid)},[a,e,o,i,l,d,u,h,s.feedid,t]),v=p.useCallback(({onClick:j})=>n.jsx("button",{className:_t.chevron,"aria-label":f("slide_next"),onClick:j,children:n.jsx(J,{icon:ea})}),[f]),b=p.useCallback(({onClick:j})=>n.jsx("button",{className:_t.chevron,"aria-label":f("slide_previous"),onClick:j,children:n.jsx(J,{icon:Bc})}),[f]),w=({page:j,pages:S})=>{const C=Array.from({length:S},(I,E)=>E);return n.jsxs(n.Fragment,{children:[n.jsx("div",{"aria-live":"polite",className:"hidden",children:f("slide_indicator",{page:j+1,pages:S})}),o&&n.jsx("div",{"aria-hidden":"true",className:_t.dots,children:C.map(I=>n.jsx("span",{className:B(_t.dot,{[_t.active]:j===I})},I))})]})};return c||!(s!=null&&s.playlist)?n.jsx("h2",{className:_t.error,children:"Could not load items"}):n.jsxs("div",{className:B(_t.shelf),children:[o?null:i?n.jsx("div",{className:_t.loadingTitle}):n.jsx("h2",{className:B(_t.title),children:r||s.title}),n.jsx(Dl,{className:_t.slider,items:s.playlist,tilesToShow:x,cycleMode:Fl,showControls:!i,spacing:8,renderLeftControl:b,renderRightControl:v,renderPagination:w,renderTile:y})]})},x_="_infiniteScrollLoader_6rn4e_1",w_={infiniteScrollLoader:x_},na=()=>n.jsx("div",{className:w_.infiniteScrollLoader,children:n.jsx(is,{})}),b_="_shelfList_fypeb_1",S_="_shelfContainer_fypeb_6",j_="_featured_fypeb_10",cr={shelfList:b_,shelfContainer:S_,featured:j_},wi=6,C_=4,Hc=({rows:s})=>{const{accessModel:t}=z(({accessModel:u})=>({accessModel:u}),ce),[e,r]=p.useState(wi),{t:a}=A("error"),o=ut(u=>u.getDictionaryWithSeries()),{user:i,subscription:c}=R(({user:u,subscription:h})=>({user:u,subscription:h}),ce),l=Pg(s,e);return p.useEffect(()=>()=>r(wi),[s]),l.every(({data:u,isSuccess:h})=>{var g;return h&&!((g=u==null?void 0:u.playlist)!=null&&g.length)})?n.jsx(et,{title:a("empty_shelves_heading"),message:a("empty_shelves_description")}):n.jsx("div",{className:cr.shelfList,children:n.jsx(Dr,{style:{overflow:"hidden"},loadMore:()=>r(u=>u+C_),hasMore:e<s.length,loader:n.jsx(na,{},"loader"),useWindow:!1,children:s.slice(0,e).map(({type:u,featured:h,title:g},_)=>{var w;const{data:f,isPlaceholderData:x,error:y}=l[_];if(!((w=f==null?void 0:f.playlist)!=null&&w.length))return null;const v=mc(f.cardImageAspectRatio||f.shelfImageAspectRatio),b=pc(v);return n.jsx("section",{className:B(cr.shelfContainer,{[cr.featured]:h}),"data-testid":(`${h?"featured":u==="playlist"?ac(g||(f==null?void 0:f.title)):u}`,void 0),"aria-label":g||(f==null?void 0:f.title),children:n.jsx(v_,{loading:x,error:y,type:u,playlist:f,watchHistory:u===ht.ContinueWatching?o:void 0,title:g||(f==null?void 0:f.title),featured:h,accessModel:t,isLoggedIn:!!i,hasSubscription:!!c,posterAspect:v,visibleTilesDelta:b})},`${_}_${f.id}`)})})})},k_=()=>{const{config:s}=z(({config:r,accessModel:a})=>({config:r,accessModel:a}),ce),t=s==null?void 0:s.content,{t:e}=A("common");return n.jsxs(n.Fragment,{children:[n.jsx("h1",{className:"hideUntilFocus",children:e("home")}),n.jsx(Hc,{rows:t})]})},De=As("UIStore",()=>({searchQuery:"",searchActive:!1,userMenuOpen:!1,sideBarOpen:!1,languageMenuOpen:!1})),E_=()=>{const s=p.useRef(!0);return p.useEffect(()=>{s.current=!1},[]),s.current},P_=(s,t)=>{const e=p.useRef(),r=p.useRef(dd((...a)=>{e.current&&e.current(...a)},t));return p.useEffect(()=>{e.current=s},[s]),r.current},Wc=()=>{const s=oe(),t=P_(a=>{s(`/q/${encodeURIComponent(a)}`)},350),e=p.useCallback(a=>{De.setState({searchQuery:a}),t(a)},[t]),r=p.useCallback(()=>{const a=De.getState().preSearchPage;De.setState({searchQuery:"",preSearchPage:void 0}),s(a||"/")},[s]);return{updateSearchQuery:e,resetSearchQuery:r}},N_=hc(30),I_=({siteId:s,enabled:t,query:e})=>{const r=G(Me);return qe(["app-search",e],async()=>await r.getContentSearch({siteId:s,params:{searchTerm:e}}),{placeholderData:t?N_:void 0,enabled:t,staleTime:Is,cacheTime:Ns})},A_=s=>{var c,l;const{config:t}=z(({config:d})=>({config:d}),ce),e=t==null?void 0:t.siteId,r=(c=t==null?void 0:t.features)==null?void 0:c.searchPlaylist,a=os((l=t==null?void 0:t.custom)==null?void 0:l.appContentSearch),o=cn(r||"",{search:s||""},!a,!!s),i=I_({siteId:e,enabled:a,query:s});return a?{data:i.data,isFetching:i.isFetching,error:i.error}:{isFetching:o.isFetching,error:o.error,data:o.data}},T_="_row_3w89x_1",L_="_cell_3w89x_5",bi={row:T_,cell:L_},$_=ud(function(s){s.scrollIntoView({behavior:"smooth",block:"center"})},300),O_=({className:s,columnCount:t,data:e,renderCell:r})=>{const[a,o]=p.useState(0),[i,c]=p.useState(0),l=p.useRef(null),d=Math.ceil(e.length/t),u=(g,_)=>{const f=document.getElementById(`layout_grid_${g}-${_}`),y=(f==null?void 0:f.querySelector('button, a, input, [tabindex]:not([tabindex="-1"])'))||f;o(g),c(_),y&&(y.focus({preventScroll:!0}),$_(y))},h=ge(g=>{const{key:_,ctrlKey:f}=g;if(!["ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Home","End","PageUp","PageDown"].includes(_))return;g.preventDefault();const x=d-1,y=i===0,v=i===t-1,b=a===0,w=a===x,j=(e.length%t||t)-1,S=w?j:t-1,C=Math.min(a+1,x),I=Math.max(a-1,0);switch(_){case"ArrowLeft":return y&&!b?u(I,t-1):u(a,Math.max(i-1,0));case"ArrowRight":return v&&!w?u(C,0):u(a,Math.min(i+1,S));case"ArrowUp":return u(I,i);case"ArrowDown":return u(C,C===x?Math.min(i,j):i);case"Home":return u(f?0:a,0);case"End":return f?u(x,j):u(a,S);case"PageUp":return u(I,i);case"PageDown":return u(C,C===x?Math.min(j,i):i);default:return}});return p.useEffect(()=>{var _;if(!((_=l.current)!=null&&_.contains(document.activeElement)))return;const g=(e.length%t||t)-1;if(i>t-1)return u(a,t-1);if(a===d-1&&i>g)return u(a,g)},[t]),n.jsx("div",{role:"grid",ref:l,"aria-rowcount":d,className:s,onKeyDown:h,children:Array.from({length:d}).map((g,_)=>n.jsx("div",{role:"row","aria-rowindex":_,className:bi.row,children:e.slice(_*t,_*t+t).map((f,x)=>n.jsx("div",{role:"gridcell",id:`layout_grid_${_}-${x}`,"aria-colindex":x,className:bi.cell,style:{width:`${Math.round(100/t)}%`},children:r(f,a===_&&i===x?0:-1)},x))},_))})},D_="_cell_1k7g3_1",F_="_container_1k7g3_6",Si={cell:D_,container:F_,"cols-1":"_cols-1_1k7g3_10","cols-2":"_cols-2_1k7g3_13","cols-3":"_cols-3_1k7g3_16","cols-4":"_cols-4_1k7g3_19","cols-5":"_cols-5_1k7g3_22","cols-6":"_cols-6_1k7g3_25","cols-7":"_cols-7_1k7g3_28","cols-8":"_cols-8_1k7g3_31","cols-9":"_cols-9_1k7g3_34","cols-10":"_cols-10_1k7g3_37"},ji=6,R_=4,M_={[te.xs]:2,[te.sm]:2,[te.md]:3,[te.lg]:4,[te.xl]:5};function Fn({playlist:s,watchHistory:t,isLoading:e=!1,cols:r=M_,currentCardItem:a,currentCardLabel:o,accessModel:i,isLoggedIn:c,hasSubscription:l,hasMore:d,getUrl:u,loadMore:h,onCardHover:g,headingLevel:_}){const f=Ne(),x=mc(s.cardImageAspectRatio||s.shelfImageAspectRatio),y=r[f]+pc(x),[v,b]=p.useState(ji),w=()=>b(S=>S+R_),j=v*y<s.playlist.length;return p.useEffect(()=>{b(ji)},[s.feedid]),n.jsx(Dr,{pageStart:0,loadMore:h??w,hasMore:d??j,loader:n.jsx(na,{},"loader"),useWindow:!1,children:n.jsx(O_,{className:B(Si.container,Si[`cols-${y}`]),data:h?s.playlist:s.playlist.slice(0,v*y),columnCount:y,renderCell:(S,C)=>n.jsx(Uc,{tabIndex:C,progress:t?t[S.mediaid]:void 0,url:u(S),onHover:typeof g=="function"?()=>g(S):void 0,loading:e,isCurrent:a&&a.mediaid===S.mediaid,currentLabel:o,isLocked:Tn(i,c,l,S),posterAspect:x,item:S,headingLevel:_})})})}const B_="_search_fjwvt_1",U_="_header_fjwvt_26",H_="_error_fjwvt_42",W_="_subHeading_fjwvt_47",wn={search:B_,header:U_,error:H_,subHeading:W_},V_=()=>{const{t:s}=A("search"),{config:t,accessModel:e}=z(({config:b,accessModel:w})=>({config:b,accessModel:w}),ce),{siteName:r,features:a}=t,o=ot("search_heading"),i=E_(),c=De(b=>b.searchQuery),{updateSearchQuery:l}=Wc(),u=Ps()["*"],{isFetching:h,error:g,data:_}=A_(u||""),{user:f,subscription:x}=R(({user:b,subscription:w})=>({user:b,subscription:w}),ce),y=b=>Le({media:b,playlistId:a==null?void 0:a.searchPlaylist}),v=p.useMemo(()=>h?s("heading"):u?_!=null&&_.playlist.length?s("title",{count:_.playlist.length,query:u}):s("no_results_heading",{query:u}):s("start_typing"),[h,_==null?void 0:_.playlist.length,u,s]);return p.useEffect(()=>{i&&u&&u!==c&&l(u)},[i,u,c,l]),p.useEffect(()=>()=>{De.setState({searchQuery:"",searchActive:!1})},[]),(g||!_)&&!h?n.jsxs(et,{title:s("error_heading"),children:[n.jsx("h2",{className:wn.subHeading,children:s("error_subheading")}),n.jsx("p",{children:s("error_description")})]}):u?_!=null&&_.playlist.length?n.jsxs("div",{className:wn.search,children:[n.jsx(xt,{children:n.jsxs("title",{children:[v," - ",r]})}),n.jsx("header",{className:wn.header,children:n.jsx("h2",{id:o,"aria-live":h?void 0:"polite",children:v})}),n.jsx(Fn,{"aria-labelledby":o,getUrl:y,playlist:_,isLoading:i,accessModel:e,isLoggedIn:!!f,hasSubscription:!!x})]}):n.jsxs(n.Fragment,{children:[n.jsx(xt,{children:n.jsxs("title",{children:[v," - ",r]})}),n.jsxs(et,{title:v,children:[n.jsx("h2",{className:wn.subHeading,children:s("suggestions")}),n.jsxs("ul",{children:[n.jsx("li",{children:s("tip_one")}),n.jsx("li",{children:s("tip_two")}),n.jsx("li",{children:s("tip_three")})]})]})]}):n.jsx(et,{title:v})},ra=s=>p.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},p.createElement("path",{d:"M12,19.2C9.5,19.2 7.29,17.92 6,16C6.03,14 10,12.9 12,12.9C14,12.9 17.97,14 18,16C16.71,17.92 14.5,19.2 12,19.2M12,5A3,3 0 0,1 15,8A3,3 0 0,1 12,11A3,3 0 0,1 9,8A3,3 0 0,1 12,5M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12C22,6.47 17.5,2 12,2Z"})),Vc=s=>p.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},p.createElement("path",{d:"M5,3C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V16.72C21.59,16.37 22,15.74 22,15V9C22,8.26 21.59,7.63 21,7.28V5A2,2 0 0,0 19,3H5M5,5H19V7H13A2,2 0 0,0 11,9V15A2,2 0 0,0 13,17H19V19H5V5M13,9H20V15H13V9M16,10.5A1.5,1.5 0 0,0 14.5,12A1.5,1.5 0 0,0 16,13.5A1.5,1.5 0 0,0 17.5,12A1.5,1.5 0 0,0 16,10.5Z"})),qc=s=>p.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},p.createElement("path",{d:"M19,3H5C3.89,3 3,3.89 3,5V9H5V5H19V19H5V15H3V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3M10.08,15.58L11.5,17L16.5,12L11.5,7L10.08,8.41L12.67,11H3V13H12.67L10.08,15.58Z"})),aa=s=>p.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},p.createElement("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})),q_="_title_gkrmh_1",z_="_body_gkrmh_8",G_="_confirmButton_gkrmh_12",Ci={title:q_,body:z_,confirmButton:G_},oa=({open:s,message:t,onClose:e,isSuccess:r,actionsOverride:a,titleOverride:o})=>{const{t:i}=A("common"),c=ot("alert-heading");return n.jsxs(Gr,{open:s,onClose:e,role:"alertdialog","aria-modal":"true","aria-labelledby":c,children:[n.jsx("h2",{id:c,className:Ci.title,children:o??i(r?"alert.success":"alert.title")}),n.jsx("p",{className:Ci.body,children:t}),a??n.jsx(D,{label:i("alert.close"),variant:"outlined",onClick:e,fullWidth:!0})]})},J_="_flexBox_17rhj_1",Y_="_controls_17rhj_9",K_="_submitConsents_17rhj_16",ki={flexBox:J_,controls:Y_,submitConsents:K_};function Q_({className:s,panelHeaderClassName:t,label:e,editButton:r,saveButton:a,cancelButton:o,onSubmit:i,content:c,readOnly:l=!1}){const d=ot(e),{formState:{values:u,activeSectionId:h,errors:g,isBusy:_},setFormState:f,isLoading:x,onCancel:y}=p.useContext(zc),v=d===h,b=p.useCallback(({currentTarget:S})=>{if(!S)return;const{name:C,type:I}=S,E=I==="checkbox"?S.checked:S.value;v||y(),f(P=>{const N={...P.values};return C.split(".").reduce(($,O,U,H)=>(U===H.length-1?$[O]=E:$[O]={...$[O]},$[O]),N),{...P,values:N,activeSectionId:d}})},[v,y,d,f]),w=p.useCallback(async function(C){var I;if(C&&C.preventDefault(),i){let E;try{f(P=>({...P,isBusy:!0,errors:[]})),E=await i(u)}catch(P){E={errors:Array.of(P instanceof Error?P.message:P)}}if((I=E==null?void 0:E.errors)!=null&&I.length){f(P=>({...P,errors:E==null?void 0:E.errors,isBusy:!1}));return}}f(E=>({...E,activeSectionId:void 0,isBusy:!1}))},[i,f,u]),j=p.useCallback(function(){v||(y(),f(C=>({...C,activeSectionId:d})))},[v,y,d,f]);return n.jsxs("section",{"aria-labelledby":d,className:s,children:[n.jsx("div",{className:t,children:n.jsx("h2",{id:d,children:e})}),_&&v&&n.jsx(xe,{transparentBackground:!0}),c&&n.jsx("form",{className:ki.flexBox,noValidate:!0,onSubmit:S=>S.preventDefault(),children:c({values:u,isEditing:v,isBusy:_,onChange:b,...v?{errors:g}:{}})}),(a||r||o)&&n.jsx("div",{className:ki.controls,children:v?n.jsxs(n.Fragment,{children:[a&&n.jsx(D,{label:a,type:"submit",onClick:w,disabled:x}),o&&n.jsx(D,{label:o,type:"reset",variant:"text",onClick:y})]}):!l&&r&&(typeof r=="object"?r:n.jsx(D,{label:r,type:"button",onClick:j,disabled:x}))})]})}const zc=p.createContext(void 0);function Z_({isLoading:s,initialValues:t,onReset:e,children:r}){const[a,o]=p.useState({values:t,activeSectionId:void 0,isDirty:!1,isBusy:!1}),i=p.useCallback(function(){o(l=>({...l,values:t,isDirty:!1,activeSectionId:void 0,success:!1,errors:void 0})),e&&e()},[t,e]);return p.useEffect(()=>{a.activeSectionId||o(c=>({...c,values:t}))},[t,a.activeSectionId]),n.jsx(zc.Provider,{value:{isLoading:s,onCancel:i,formState:a,setFormState:o},children:r==null?void 0:r.map((c,l)=>n.jsx(Q_,{...c},l))})}const X_="_textWithButtonContainer_1cz0o_1",ey="_customFields_1cz0o_7",lr={textWithButtonContainer:X_,customFields:ey},ty=({panelClassName:s,panelHeaderClassName:t,canUpdateEmail:e=!0})=>{var Q,q;const r=G(fe),{t:a,i18n:o}=A("user"),i=Ge(),c=oe(),l=le(),[d,u]=Jr(),h=rt(r.exportAccountData),[g,_]=p.useState(!1),f=h.isSuccess?a("account.export_data_success"):a("account.export_data_error"),x=o.language!==K.APP_DEFAULT_LANGUAGE?K.APP_DEFAULT_LANGUAGE:void 0;p.useEffect(()=>{(h.isSuccess||h.isError)&&_(!0)},[h.isSuccess,h.isError]);const{customer:y,customerConsents:v,publisherConsents:b}=R(({user:k,customerConsents:L,publisherConsents:W})=>({customer:k,customerConsents:L,publisherConsents:W}),ce),{canChangePasswordWithOldPassword:w,canExportAccountData:j,canDeleteAccount:S}=r.getFeatures(),C=(Q=y==null?void 0:y.metadata)==null?void 0:Q.register_source,I=C&&C!=="inplayer"||!1,E=I&&!((q=y==null?void 0:y.metadata)!=null&&q.has_password)||!1;p.useEffect(()=>{if(!b){r.getPublisherConsents();return}},[r,b]);const[P,N]=p.useMemo(()=>{const k=[],L=[];return b==null||b.forEach(W=>{!(W!=null&&W.type)||(W==null?void 0:W.type)==="checkbox"?k.push(W):L.push(W)}),[k,L]},[b]),$=p.useMemo(()=>ou(b,v),[b,v]),O=p.useMemo(()=>au(b,v),[b,v]),U=p.useMemo(()=>({...y,consents:$,consentsValues:O,confirmationPassword:""}),[y,$,O]),H=k=>{const L=$r.sanitize(k),W=/<a(.|\n)*?>/.test(L),X=/<\/a(.|\n)*?>/.test(L);return W&&X?n.jsx("span",{dangerouslySetInnerHTML:{__html:k}}):k};function T(k){const L={};return k==null||k.flatMap(W=>W.split(",")).forEach(W=>{switch(W.trim()){case"Invalid param email":L.form=a("account.errors.validation_error"),L.email=a("account.errors.invalid_param_email");break;case"Customer email already exists":L.form=a("account.errors.validation_error"),L.email=a("account.errors.email_exists");break;case"Please enter a valid e-mail address.":L.form=a("account.errors.validation_error"),L.email=a("account.errors.please_enter_valid_email");break;case"Invalid confirmationPassword":{L.form=a("account.errors.validation_error"),L.confirmationPassword=a("account.errors.invalid_password");break}case"firstName can have max 50 characters.":{L.form=a("account.errors.validation_error"),L.firstName=a("account.errors.first_name_too_long");break}case"lastName can have max 50 characters.":{L.form=a("account.errors.validation_error"),L.lastName=a("account.errors.last_name_too_long");break}case"Email update not supported":{L.form=a("account.errors.email_update_not_supported");break}case"Wrong email/password combination":{L.form=a("account.errors.wrong_combination");break}default:{L.form=a("account.errors.unknown_error"),Ve("Account","Unknown error",{error:W});break}}}),L}function M(k){return{...k,className:s,panelHeaderClassName:t,saveButton:a("account.save"),cancelButton:a("account.cancel"),content:L=>{var X;const W=T(L.errors);return n.jsxs(n.Fragment,{children:[W!=null&&W.form?n.jsx(Pe,{variant:"error",children:W.form}):null,(X=k.content)==null?void 0:X.call(k,{...L,errors:W})]})}}}const Z=async()=>{if(y){if(I&&E)return await r.resetPassword(y.email,""),c(V(l,"add-password"));c(V(l,w?"edit-password":"reset-password"))}};return n.jsxs(n.Fragment,{children:[n.jsx("h1",{className:"hideUntilFocus",children:a("nav.account")}),n.jsx(Z_,{initialValues:U,children:[M({label:a("account.about_you"),editButton:a("account.edit_information"),onSubmit:async k=>{const L=kn(b,{...k.metadata,...k.consentsValues}),W=await r.updateUser({firstName:k.firstName||"",lastName:k.lastName||"",metadata:{...k.metadata,...Er(L),consents:JSON.stringify(L)}});return i(a("account.update_success",{section:a("account.about_you")}),"success"),W},content:k=>{var L,W,X,se;return n.jsxs(n.Fragment,{children:[n.jsx(de,{name:"firstName",label:a("account.firstname"),value:k.values.firstName||"",onChange:k.onChange,error:!!((L=k.errors)!=null&&L.firstName),helperText:(W=k.errors)==null?void 0:W.firstName,disabled:k.isBusy,editing:k.isEditing,autoComplete:"given-name",lang:x}),n.jsx(de,{name:"lastName",label:a("account.lastname"),value:k.values.lastName||"",onChange:k.onChange,error:!!((X=k.errors)!=null&&X.lastName),helperText:(se=k.errors)==null?void 0:se.lastName,disabled:k.isBusy,editing:k.isEditing,autoComplete:"family-name",lang:x})]})}}),M({label:a("account.email"),onSubmit:async k=>{if(!k.email||!k.confirmationPassword)throw new Error("Wrong email/password combination");const L=await r.updateUser({email:k.email||"",confirmationPassword:k.confirmationPassword});return i(a("account.update_success",{section:a("account.email")}),"success"),L},editButton:a("account.edit_account"),readOnly:!e,content:k=>{var L,W,X,se;return n.jsxs(n.Fragment,{children:[n.jsx(de,{name:"email",label:a("account.email"),value:k.values.email||"",onChange:k.onChange,error:!!((L=k.errors)!=null&&L.email),helperText:(W=k.errors)==null?void 0:W.email,disabled:k.isBusy,editing:k.isEditing,autoComplete:"email",required:!0}),k.isEditing&&n.jsx(de,{name:"confirmationPassword",label:a("account.confirm_password"),value:k.values.confirmationPassword,onChange:k.onChange,error:!!((X=k.errors)!=null&&X.confirmationPassword),helperText:(se=k.errors)==null?void 0:se.confirmationPassword,type:d?"text":"password",disabled:k.isBusy,autoComplete:"current-password",rightControl:n.jsx(ze,{"aria-label":a("account.view_password"),onClick:()=>u(),"aria-pressed":d,children:n.jsx(J,{icon:d?Yr:Kr})}),required:!0})]})}}),M({label:a("account.security"),editButton:n.jsx(D,{label:a(E?"account.add_password":"account.edit_password"),type:"button",onClick:()=>y?Z():null})}),M({label:a("account.terms_and_tracking"),saveButton:a("account.update_consents"),onSubmit:async k=>{const L=await r.updateConsents(kn(b,k.consentsValues));return i(a("account.update_success",{section:a("account.terms_and_tracking")}),"success"),L},content:k=>n.jsx(n.Fragment,{children:P==null?void 0:P.map((L,W)=>{var X;return n.jsx(Dn,{name:`consentsValues.${L.name}`,checked:os((X=k.values.consentsValues)==null?void 0:X[L.name]),onChange:k.onChange,checkboxLabel:H(L.label),disabled:L.required||k.isBusy,required:L.required,lang:x},W)})})}),(N==null?void 0:N.length)&&M({label:a("account.other_registration_details"),saveButton:a("account.update_consents"),onSubmit:k=>r.updateConsents(kn(b,k.consentsValues)),content:k=>n.jsx("div",{className:lr.customFields,"data-testid":void 0,children:N.map(L=>n.jsx(Rc,{type:L.type,name:`consentsValues.${L.name}`,options:L.options,label:H(L.label),placeholder:L.placeholder,value:k.values.consentsValues[L.name],disabled:L.type==="checkbox"&&L.required||k.isBusy,onChange:k.onChange,required:L.required},L.name))})}),j&&M({label:a("account.export_data_title"),content:k=>n.jsxs("div",{className:lr.textWithButtonContainer,children:[n.jsx("div",{children:n.jsx(Rl,{t:a,i18nKey:"account.export_data_body",values:{email:k.values.email}})}),n.jsx("div",{children:n.jsx(D,{label:a("account.export_data_title"),type:"button",disabled:h.isLoading,onClick:async()=>{h.mutate()}})})]})}),S&&M({label:a("account.delete_account.title"),content:()=>n.jsxs("div",{className:lr.textWithButtonContainer,children:[n.jsx("div",{children:a("account.delete_account.body")}),n.jsx("div",{children:n.jsx(D,{label:a("account.delete_account.title"),type:"button",variant:"danger",onClick:()=>{c(V(l,E?"warning-account-deletion":"delete-account"))}})})]})})].filter(_d)}),j&&n.jsx(oa,{open:g,message:f,onClose:()=>_(!1),isSuccess:h.isSuccess})]})},sy="_header_1mj0c_1",ny={header:sy},ry={[te.xs]:2,[te.sm]:3,[te.md]:3,[te.lg]:3,[te.xl]:3},ay=({playlist:s,accessModel:t,hasSubscription:e,onCardHover:r,onClearFavoritesClick:a})=>{const{t:o}=A("user"),i=c=>Le({media:c,playlistId:c.feedid});return n.jsxs("div",{children:[n.jsxs("div",{className:ny.header,children:[n.jsx("h1",{children:o("favorites.title")}),s.playlist.length>0?n.jsx(D,{label:o("favorites.clear"),onClick:a}):null]}),s.playlist.length>0?n.jsx(Fn,{getUrl:i,playlist:s,onCardHover:r,cols:ry,isLoading:!1,accessModel:t,isLoggedIn:!0,hasSubscription:e}):n.jsx("p",{children:o("favorites.no_favorites")})]})},oy=(s,t,e,r)=>{const a=G(fe),o=G(St),i=rt(a.updateUser,{onSuccess:()=>{R.setState({loading:!1})}});return rt(o.changeSubscription,{onSuccess:()=>{!s&&t&&i.mutate({firstName:(e==null?void 0:e.firstName)||"",lastName:(e==null?void 0:e.lastName)||"",metadata:{[`${r}_pending_downgrade`]:t}})}})},iy="_user_1awlz_1",cy="_leftColumn_1awlz_19",ly="_button_1awlz_30",dy="_logoutLi_1awlz_42",uy="_mainColumn_1awlz_51",hy="_panel_1awlz_56",my="_panelHeader_1awlz_73",py="_checkbox_1awlz_86",Ye={user:iy,leftColumn:cy,button:ly,logoutLi:dy,mainColumn:uy,panel:hy,panelHeader:my,checkbox:py},fy=s=>p.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},p.createElement("path",{d:"M14,3V5H17.59L7.76,14.83L9.17,16.24L19,6.41V10H21V3M19,19H5V5H12V3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V12H19V19Z"})),gy="_offerSwitchContainer_booqe_1",_y="_activeOfferSwitchContainer_booqe_13",yy="_offerSwitchInfoContainer_booqe_18",vy="_offerSwitchPlanContainer_booqe_28",xy="_currentPlanHeading_booqe_36",wy="_activeCurrentPlanHeading_booqe_41",by="_nextBillingDate_booqe_45",Sy="_price_booqe_51",jy="_paymentFrequency_booqe_57",Pt={offerSwitchContainer:gy,activeOfferSwitchContainer:_y,offerSwitchInfoContainer:yy,offerSwitchPlanContainer:vy,currentPlanHeading:xy,activeCurrentPlanHeading:wy,nextBillingDate:by,price:Sy,paymentFrequency:jy},Cy=({isCurrentOffer:s,pendingDowngradeOfferId:t,offer:e,selected:r,onChange:a,expiresAt:o})=>{const{t:i,i18n:c}=A(["user","account"]),{customerPriceInclTax:l,customerCurrency:d,period:u}=e,h=t===e.offerId;return n.jsxs("div",{className:B(Pt.offerSwitchContainer,{[Pt.activeOfferSwitchContainer]:r}),children:[n.jsx(Dn,{disabled:h,name:e.offerId,checked:r,onChange:()=>a(e.offerId)}),n.jsxs("div",{className:Pt.offerSwitchInfoContainer,children:[(s||h)&&n.jsxs("div",{className:B(Pt.currentPlanHeading,{[Pt.activeCurrentPlanHeading]:r}),children:[s&&i("user:payment.current_plan").toUpperCase(),h&&i("user:payment.pending_downgrade").toUpperCase()]}),n.jsxs("div",{className:Pt.offerSwitchPlanContainer,children:[n.jsx("div",{children:i(`user:payment.${u==="month"?"monthly":"annual"}_subscription`)}),(s||h)&&o&&n.jsxs("div",{className:Pt.nextBillingDate,children:[s&&!t&&i("user:payment.next_billing_date_on",{date:vt(new Date(o*1e3),c.language)}),h&&i("user:payment.downgrade_on",{date:vt(new Date(o*1e3),c.language)})]})]})]}),n.jsxs("div",{className:Pt.price,children:[nt(l,d,void 0),n.jsxs("span",{className:Pt.paymentFrequency,children:["/",i(`account:periods.${u}_one`)]})]})]})},ky="_infoBox_18i51_1",Ey="_transactionItem_18i51_22",Py="_pendingSwitch_18i51_31",Ny="_transactionDetails_18i51_36",Iy="_transactionPrice_18i51_56",Ay="_price_18i51_60",Ty="_explanation_18i51_69",Ly="_cardDetails_18i51_73",$y="_paypal_18i51_78",Oy="_upgradeSubscription_18i51_90",Dy="_changePlanContainer_18i51_99",Fy="_changePlanButtons_18i51_105",Ry="_changePlanCancelButton_18i51_112",My="_editCard_18i51_116",Ue={infoBox:ky,transactionItem:Ey,pendingSwitch:Py,transactionDetails:Ny,transactionPrice:Iy,price:Ay,explanation:Ty,cardDetails:Ly,paypal:$y,upgradeSubscription:Oy,changePlanContainer:Dy,changePlanButtons:Fy,changePlanCancelButton:Ry,editCard:My},Ei=4,By=({accessModel:s,activePaymentDetail:t,activeSubscription:e,pendingOffer:r,transactions:a,customer:o,isLoading:i,panelClassName:c,panelHeaderClassName:l,onShowAllTransactionsClick:d,showAllTransactions:u,onShowReceiptClick:h,canRenewSubscription:g=!1,canShowReceipts:_=!1,canUpdatePaymentMethod:f,onUpgradeSubscriptionClick:x,offerSwitchesAvailable:y,offers:v=[],pendingDowngradeOfferId:b="",changeSubscriptionPlan:w,onChangePlanClick:j,selectedOfferId:S,setSelectedOfferId:C,isUpgradeOffer:I,setIsUpgradeOffer:E,isExternalPaymentProvider:P,paymentProvider:N,paymentProviderLink:$})=>{var Ie;const O=ot("subscription-details"),U=ot("payment-method"),H=ot("billing-history"),{t:T,i18n:M}=A(["user","account"]),Z=a?(a==null?void 0:a.length)-Ei:0,Q=Z>0,q=oe(),k=le(),L=(e==null?void 0:e.period)==="granted",X=Ne()===te.xs,[se,we]=p.useState(!1);p.useEffect(()=>{se||C((e==null?void 0:e.accessFeeId)??null)},[e,se,C]),p.useEffect(()=>{we(!1)},[e==null?void 0:e.status,e==null?void 0:e.pendingSwitchId]),p.useEffect(()=>{var ee,Be;S&&v&&E((((ee=v.find(Je=>Je.offerId===S))==null?void 0:ee.customerPriceInclTax)??0)>(((Be=v.find(Je=>Je.offerId===(e==null?void 0:e.accessFeeId)))==null?void 0:Be.customerPriceInclTax)??0))},[S,v,e,E]);function ue(){q(V(k,"choose-offer"))}function je(){q(V(k,"edit-card"))}function ie(){q(V(k,"unsubscribe"))}function Y(){q(V(k,"renew-subscription"))}function he(ee){switch(ee){case"month":return T("user:payment.monthly_subscription");case"year":return T("user:payment.annual_subscription");case"day":return T("user:payment.daily_subscription");case"week":return T("user:payment.weekly_subscription");case"granted":return T("user:payment.granted_subscription");default:return T("user:payment.other")}}const me=!P&&y||!se&&!g;return n.jsxs(n.Fragment,{children:[n.jsx(oa,{isSuccess:!w.isError,message:w.isError?T("user:payment.change_plan_error"):I?T("user:payment.upgrade_plan_success"):T("user:payment.downgrade_plan_success",{date:(e==null?void 0:e.expiresAt)&&vt(new Date(e.expiresAt*1e3),M.language)}),open:se&&(w.isSuccess||w.isError),onClose:()=>{w.reset(),we(!1)}}),n.jsx("h1",{className:"hideUntilFocus",children:T("nav.payments")}),s===$e.SVOD&&n.jsxs("section",{"aria-labelledby":O,className:c,children:[n.jsx("div",{className:l,children:n.jsx("h2",{id:O,children:T(se?"user:payment.change_plan":"user:payment.subscription_details")})}),e?n.jsxs(Ee.Fragment,{children:[!se&&n.jsxs("div",{className:Ue.infoBox,children:[n.jsxs("p",{children:[n.jsx("strong",{children:he(e.period)})," ",n.jsx("br",{}),e.status==="active"&&!L&&!b?T("user:payment.next_billing_date_on",{date:vt(new Date(e.expiresAt*1e3),M.language)}):T("user:payment.subscription_expires_on",{date:vt(new Date(e.expiresAt*1e3),M.language)}),(r||b)&&e.status!=="cancelled"&&n.jsx("span",{className:Ue.pendingSwitch,children:T("user:payment.pending_offer_switch",{title:he((r==null?void 0:r.period)||((Ie=v.find(ee=>ee.offerId===b))==null?void 0:Ie.period)||"month")})})]}),!L&&n.jsxs("p",{className:Ue.price,children:[n.jsx("strong",{children:nt(e.nextPaymentPrice,e.nextPaymentCurrency,o.country)}),n.jsxs("small",{children:["/",T(`account:periods.${e.period}`)]})]})]},e.subscriptionId),P?n.jsxs("p",{className:Ue.explanation,children:[T("account:external_payment.explanation",{paymentProvider:N})," ",n.jsx(Zs,{href:$,target:"_blank",children:T("account:external_payment.manage_subscription")})]}):me&&n.jsx(D,{className:Ue.upgradeSubscription,label:T("user:payment.change_subscription"),disabled:!g&&e.status==="cancelled",onClick:()=>{v.length>1&&!g?we(!0):x==null||x()},fullWidth:X,color:"primary","data-testid":"change-subscription-button"}),(e.status==="active"||e.status==="active_trial")&&!L&&!se&&g?n.jsx(D,{label:T("user:payment.cancel_subscription"),onClick:ie,fullWidth:X,"data-testid":"cancel-subscription-button"}):g?n.jsx(D,{label:T("user:payment.renew_subscription"),onClick:Y}):null]}):i?null:n.jsxs(Ee.Fragment,{children:[n.jsx("p",{children:T("user:payment.no_subscription")}),n.jsx(D,{variant:"contained",color:"primary",label:T("user:payment.complete_subscription"),onClick:ue})]}),se&&n.jsxs("div",{className:Ue.changePlanContainer,children:[v.filter(ee=>ee.planSwitchEnabled).map(ee=>n.jsx(Cy,{isCurrentOffer:ee.offerId===(e==null?void 0:e.accessFeeId),pendingDowngradeOfferId:b,offer:ee,selected:S===ee.offerId,onChange:Be=>C(Be),expiresAt:e==null?void 0:e.expiresAt},ee.offerId)),n.jsxs("div",{className:Ue.changePlanButtons,children:[n.jsx(D,{label:T("user:account.save"),onClick:j,disabled:S===(e==null?void 0:e.accessFeeId)||w.isLoading}),n.jsx(D,{label:T("user:account.cancel"),onClick:()=>we(!1),variant:"text"}),(e==null?void 0:e.status)!=="cancelled"&&n.jsx(D,{className:Ue.changePlanCancelButton,label:T("user:payment.cancel_subscription"),onClick:ie,variant:"danger","data-testid":"cancel-subscription-button"})]})]})]}),n.jsxs("section",{"aria-labelledby":U,className:c,children:[n.jsx("div",{className:l,children:n.jsx("h2",{id:U,children:T("user:payment.payment_method")})}),t?t.paymentMethod==="paypal"?n.jsxs("div",{children:[n.jsxs("div",{className:Ue.paypal,children:[n.jsx(J,{icon:Qr})," ",T("account:payment.paypal")]}),t.currency]}):n.jsxs("div",{children:[n.jsx(de,{label:T("user:payment.card_number"),name:"cardNumber",value:`•••• •••• •••• ${t.paymentMethodSpecificParams.lastCardFourDigits||""}`,"aria-label":T("user:payment.card_number_hidden",{number:t.paymentMethodSpecificParams.lastCardFourDigits}),editing:!1,autoComplete:"cc-number"}),n.jsxs("div",{className:Ue.cardDetails,children:[n.jsx(de,{label:T("user:payment.expiry_date"),name:"cardExpiry",value:t.paymentMethodSpecificParams.cardExpirationDate,editing:!1,autoComplete:"cc-exp"}),n.jsx(de,{label:T("user:payment.security_code"),name:"cardSecurityCode",value:"******",editing:!1,"aria-label":T("user:payment.security_code_hidden"),autoComplete:"cc-csc"})]}),n.jsx(D,{className:B({[Ue.editCard]:f}),label:T("account:payment.edit_card"),variant:"outlined",onClick:je})]},t.id):n.jsx("div",{children:n.jsx("p",{children:!i&&T("user:payment.no_payment_methods")})}),f&&n.jsx(D,{label:T("user:payment.update_payment_details"),type:"button",onClick:()=>q(V(k,"payment-method"))})]}),n.jsxs("section",{"aria-labelledby":H,className:c,children:[n.jsx("div",{className:l,children:n.jsx("h2",{id:H,children:T("user:payment.billing_history")})}),a!=null&&a.length?n.jsxs(Ee.Fragment,{children:[a==null?void 0:a.slice(0,u?9999:Ei).map(ee=>n.jsxs("div",{className:Ue.infoBox,children:[n.jsxs("p",{className:Ue.transactionItem,children:[n.jsx("strong",{children:vt(new Date(ee.transactionDate*1e3),M.language)}),n.jsx("span",{children:ee.offerTitle}),n.jsx("span",{children:ee.transactionId})]}),n.jsxs("div",{className:Ue.transactionDetails,children:[n.jsx("div",{className:Ue.transactionPrice,children:!L&&T("user:payment.price_paid_with",{price:nt(parseFloat(ee.transactionPriceInclTax),ee.transactionCurrency,ee.customerCountry),method:ee.paymentMethod})}),_&&n.jsx(ze,{"aria-label":T("user:payment.show_receipt"),onClick:()=>!i&&h((ee==null?void 0:ee.trxToken)??ee.transactionId),children:n.jsx(J,{icon:fy})})]})]},ee.transactionId)),!u&&Q?n.jsxs(Ee.Fragment,{children:[n.jsx("p",{children:T("user:payment.hidden_transactions",{count:Z})}),n.jsx(D,{label:T("user:payment.show_all"),onClick:d})]}):null]}):n.jsx("div",{children:n.jsx("p",{children:!i&&T("user:payment.no_transactions")})})]}),i&&n.jsx(xe,{inline:!0})]})},Uy=(s,t)=>{if(s instanceof Blob){const e=window.URL.createObjectURL(new Blob([s])),r=document.createElement("a");r.href=e,r.setAttribute("download",`receipt_${t}.pdf`),document.body.appendChild(r),r.click()}else{const e=window.open("",`Receipt ${t}`,""),r=window.atob(s);e&&(e.opener=null,e.document.write(r),e.document.close())}},Hy=["Apple In-App","Google In-App","Roku In-App"],Wy={apple:"https://support.apple.com/118428",google:"https://support.google.com/googleplay/answer/7018481",roku:"https://support.roku.com/article/208756478"},Vy=()=>{var T;const s=G(fe),t=oe(),{accessModel:e}=z(({accessModel:M})=>({accessModel:M}),ce),{user:r,subscription:a,transactions:o,activePayment:i,pendingOffer:c,loading:l}=R(),{canUpdatePaymentMethod:d,canShowReceipts:u,canRenewSubscription:h}=s.getFeatures(),{subscriptionOffers:g,switchSubscriptionOffers:_}=Zr(),[f,x]=p.useState(!1),[y,v]=p.useState(!1),[b,w]=p.useState((a==null?void 0:a.accessFeeId)??null),[j,S]=p.useState(void 0),C=le(),I=async()=>t(V(C,"upgrade-subscription")),E=async M=>{v(!0);try{const Z=await s.getReceipt(M);Z&&Uy(Z,M)}catch(Z){throw new Error("Couldn't parse receipt. "+(Z instanceof Error?Z.message:""))}v(!1)},P=oy(j??!1,b,r,a==null?void 0:a.subscriptionId),N=async()=>{b&&(a!=null&&a.subscriptionId)&&P.mutate({accessFeeId:b.slice(1),subscriptionId:`${a.subscriptionId}`})};if(!r)return n.jsx(xe,{});const $=((T=r.metadata)==null?void 0:T[`${a==null?void 0:a.subscriptionId}_pending_downgrade`])||"",O=!!a&&Hy.includes(a.paymentMethod),U=(a==null?void 0:a.paymentMethod.split(" ")[0])||"unknown",H=Wy[U.toLowerCase()];return n.jsx(By,{accessModel:e,activeSubscription:a,activePaymentDetail:i,transactions:o,customer:r,pendingOffer:c,isLoading:l||y,panelClassName:Ye.panel,panelHeaderClassName:Ye.panelHeader,onShowAllTransactionsClick:()=>x(!0),showAllTransactions:f,canUpdatePaymentMethod:d,canRenewSubscription:h,onUpgradeSubscriptionClick:I,offerSwitchesAvailable:_.length>0,canShowReceipts:u,onShowReceiptClick:E,offers:g,pendingDowngradeOfferId:$,changeSubscriptionPlan:P,onChangePlanClick:N,selectedOfferId:b,setSelectedOfferId:M=>w(M),isUpgradeOffer:j,setIsUpgradeOffer:M=>S(M),isExternalPaymentProvider:O,paymentProvider:U,paymentProviderLink:H})},qy=()=>{const s=G(ks),t=G(fe),{accessModel:e,favoritesList:r}=z(y=>{var v;return{accessModel:y.accessModel,favoritesList:(v=y.config.features)==null?void 0:v.favoritesList}},ce),a=oe(),{t:o}=A("user"),i=Ne(),[c,l]=p.useState(!1),d=i>te.md,{user:u,subscription:h,loading:g}=R(),{canUpdateEmail:_}=t.getFeatures(),f=lt(y=>y.getPlaylist()),x=p.useCallback(async()=>{await t.logout()},[t]);return p.useEffect(()=>{!g&&!u&&a("/",{replace:!0})},[a,u,g]),u?n.jsxs("div",{className:Ye.user,children:[d&&n.jsx("nav",{className:Ye.leftColumn,children:n.jsx("div",{className:Ye.panel,children:n.jsxs("ul",{children:[n.jsx("li",{children:n.jsx(D,{to:Gs,label:o("nav.account"),variant:"text",startIcon:n.jsx(J,{icon:ra}),className:Ye.button})}),r&&n.jsx("li",{children:n.jsx(D,{to:Sr,label:o("nav.favorites"),variant:"text",startIcon:n.jsx(J,{icon:aa}),className:Ye.button})}),e!==$e.AVOD&&n.jsx("li",{children:n.jsx(D,{to:jr,label:o("nav.payments"),variant:"text",startIcon:n.jsx(J,{icon:Vc}),className:Ye.button})}),n.jsx("li",{className:Ye.logoutLi,children:n.jsx(D,{onClick:x,label:o("nav.logout"),variant:"text",startIcon:n.jsx(J,{icon:qc}),className:Ye.button})})]})})}),n.jsx("div",{className:Ye.mainColumn,children:n.jsxs(Hi,{children:[n.jsx(He,{path:Gs,element:n.jsx(ty,{panelClassName:Ye.panel,panelHeaderClassName:Ye.panelHeader,canUpdateEmail:_})}),r&&n.jsx(He,{path:Sr,element:n.jsxs(n.Fragment,{children:[n.jsx(ay,{playlist:f,onClearFavoritesClick:()=>l(!0),accessModel:e,hasSubscription:!!h}),n.jsx(yg,{open:c,title:o("favorites.clear_favorites_title"),body:o("favorites.clear_favorites_body"),onConfirm:async()=>{await s.clear(),l(!1)},onClose:()=>l(!1)})]})}),n.jsx(He,{path:jr,element:e!==$e.AVOD?n.jsx(Vy,{}):n.jsx(rs,{to:Gs})}),n.jsx(He,{path:"*",element:n.jsx(rs,{to:Gs})})]})})]}):n.jsx("div",{className:Ye.user,children:n.jsx(xe,{inline:!0})})},ia=(s,t)=>{const e=[],r=fc(s.duration);return s.pubdate&&e.push(String(new Date(s.pubdate*1e3).getFullYear())),!t&&r&&e.push(r),t&&e.push(t),s.genre&&e.push(s.genre),s.rating&&e.push(s.rating),e},zy=(s,t)=>{const e=[];return t&&e.push(t),s.genre&&e.push(s.genre),s.rating&&e.push(s.rating),e},Gy=(s,t)=>{const e=[],r=mu(t,s.scheduledStart,s.scheduledEnd),a=fc(s.duration);return r&&e.push(r),a&&e.push(a),s.genre&&e.push(s.genre),s.rating&&e.push(s.rating),e},Jy=["data","isLoading"],Os=s=>{const{accessModel:t}=z(),{user:e,subscription:r}=R(({user:h,subscription:g})=>({user:h,subscription:g}),ce),a=G(St,!1),o=s&&!Tn(t,!!e,!!r,s),i=(s==null?void 0:s.mediaOffers)||[],c=Ui(i.map(({offerId:h})=>({queryKey:["entitlements",h],queryFn:()=>a==null?void 0:a.getEntitlements({offerId:h}),enabled:!!s&&!!e&&!!e.id&&!!h&&!o,refetchOnMount:"always",notifyOnChangeProps:Jy}))),l=!!e&&c.some(h=>{var g,_;return h.isSuccess&&((_=(g=h.data)==null?void 0:g.responseData)==null?void 0:_.accessGranted)}),d=!l&&c.some(h=>h.isLoading);return{isEntitled:!!s&&(o||l),isMediaEntitlementLoading:d,mediaOffers:i}};function Yt(s,t=!0){const e=G(Me);return qe(["media",s],()=>e.getMediaById(s),{enabled:!!s&&t,refetchInterval:(r,a)=>r&&Ki(r)?1e3*30:!1,staleTime:60*1e3*10})}const Rn=s=>p.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},p.createElement("path",{d:"M19,19H5V5H19M19,3H5A2,2 0 0,0 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3M10,8V16L15,12L10,8Z"})),Yy="_filterRow_1pd69_1",Ky="_dropDown_1pd69_10",Qy="_filterDropDown_1pd69_17",dr={filterRow:Yy,dropDown:Ky,filterDropDown:Qy},Gc=({name:s,value:t,defaultLabel:e,options:r,setValue:a,forceDropdown:o=!1})=>{const{t:i}=A("common"),c=Ne();if(!r.length)return null;const l=u=>a(u.target.value),d=!o&&c>=te.md&&r.length<6;return n.jsx(p.Fragment,{children:d?n.jsxs("div",{className:dr.filterRow,role:"listbox","aria-label":i("filter_videos_by",{name:s}),children:[r.map(u=>{const h=typeof u=="string"?u:u.label,g=typeof u=="string"?u:u.value,_=t===g;return n.jsx(D,{label:h,onClick:()=>a(g),active:_,role:"option","aria-selected":_},g)}),n.jsx(D,{label:e,onClick:()=>a(""),active:t==="",role:"option","aria-selected":t===""},e)]}):n.jsx("div",{className:dr.filterDropDown,children:n.jsx(Ac,{className:dr.dropDown,size:"small",options:r,defaultLabel:e,name:s,value:t,onChange:l,"aria-label":i("filter_videos_by",{name:s})})})})},Zy="_truncatedText_vuggl_1",Xy={truncatedText:Zy},ca=({text:s,maximumLines:t,className:e})=>n.jsx("div",{className:B(Xy.truncatedText,e),style:{maxHeight:`calc(1.5em * ${t})`,WebkitLineClamp:t},children:s}),ev="_collapsibleText_1ve3l_1",tv="_dummyDiv_1ve3l_6",sv="_textContainer_1ve3l_11",nv="_collapsed_1ve3l_15",rv="_chevron_1ve3l_20",av="_expanded_1ve3l_33",Ws={collapsibleText:ev,dummyDiv:tv,textContainer:sv,collapsed:nv,chevron:rv,expanded:av},la=({text:s,className:t})=>{const e=p.useRef(),r=Ne(),[a,o]=p.useState(!1),[i,c]=p.useState(!1),l=i?"Collapse":"Expand",d=4,u=60;return p.useEffect(()=>{e.current&&o(e.current.scrollHeight>e.current.offsetHeight+d||u<e.current.offsetHeight)},[u,s,r]),n.jsxs("div",{className:B(Ws.collapsibleText),children:[n.jsx("p",{ref:e,id:"collapsible-content",className:B(Ws.textContainer,t,{[Ws.collapsed]:!i&&a}),style:{maxHeight:i?e.current.scrollHeight:u},children:s}),a&&n.jsx(ze,{"aria-label":l,"aria-expanded":i,"aria-controls":"collapsible-content",className:B(Ws.chevron,{[Ws.expanded]:i}),onClick:()=>c(!i),children:n.jsx(J,{icon:ea})})]})},ov="_video_18fkd_1",iv="_mainPadding_18fkd_8",cv="_main_18fkd_8",lv="_hidden_18fkd_31",dv="_info_18fkd_35",uv="_title_18fkd_60",hv="_metaContainer_18fkd_78",mv="_primaryMetadata_18fkd_83",pv="_secondaryMetadata_18fkd_97",fv="_description_18fkd_112",gv="_buttonBar_18fkd_121",_v="_poster_18fkd_142",yv="_posterFade_18fkd_169",vv="_playIcon_18fkd_179",Qe={video:ov,mainPadding:iv,main:cv,hidden:lv,info:dv,title:uv,metaContainer:hv,primaryMetadata:mv,secondaryMetadata:pv,description:fv,buttonBar:gv,poster:_v,posterFade:yv,playIcon:vv},Jc=({title:s,description:t,primaryMetadata:e,secondaryMetadata:r,image:a,startWatchingButton:o,shareButton:i,favoriteButton:c,trailerButton:l,children:d})=>{const h=Ne()===te.xs;return n.jsxs("div",{"data-testid":void 0,children:[n.jsx("header",{className:Qe.video,"data-testid":void 0,id:"video-details",children:n.jsxs("div",{className:B(Qe.main,Qe.mainPadding),children:[n.jsx($s,{className:Qe.poster,image:a,alt:"",width:1280}),n.jsx("div",{className:Qe.posterFade}),n.jsxs("div",{className:Qe.info,children:[n.jsx("h1",{className:Qe.title,children:s}),n.jsxs("div",{className:Qe.metaContainer,children:[n.jsx("div",{className:Qe.primaryMetadata,children:e}),r&&n.jsx("div",{className:Qe.secondaryMetadata,children:r})]}),h?n.jsx(la,{text:t,className:Qe.description}):n.jsx(ca,{text:t,maximumLines:12,className:Qe.description}),n.jsxs("div",{className:Qe.buttonBar,children:[o,l,c,i]})]})]})}),d]})},xv="_details_1sstp_1",wv="_inlinePlayerMetadata_1sstp_24",bv="_title_1sstp_40",Sv="_primaryMetadata_1sstp_67",jv="_buttonBar_1sstp_79",Cv="_description_1sstp_100",es={details:xv,inlinePlayerMetadata:wv,title:bv,primaryMetadata:Sv,buttonBar:jv,description:Cv},kv=({title:s,description:t,primaryMetadata:e,shareButton:r,favoriteButton:a,trailerButton:o})=>{const c=Ne()===te.xs,l=typeof s=="string"?"h1":"div";return n.jsxs("div",{className:es.details,"data-testid":void 0,children:[n.jsx(l,{className:es.title,children:s}),n.jsxs("div",{className:es.inlinePlayerMetadata,children:[n.jsx("div",{className:es.primaryMetadata,children:e}),n.jsxs("div",{className:es.buttonBar,children:[o,a,r]})]}),c?n.jsx(la,{text:t,className:es.description}):n.jsx(ca,{text:t,maximumLines:12,className:es.description})]})},Ev="_listItem_6fjkv_1",Pv="_poster_6fjkv_20",Nv="_posterImage_6fjkv_39",Iv="_visible_6fjkv_48",Av="_activeLabel_6fjkv_58",Tv="_title_6fjkv_91",Lv="_titleContainer_6fjkv_105",$v="_scheduledStart_6fjkv_110",Ov="_tags_6fjkv_121",Dv="_lock_6fjkv_128",Fv="_scheduled_6fjkv_110",Rv="_tag_6fjkv_121",Mv="_live_6fjkv_156",Bv="_progressContainer_6fjkv_160",Uv="_progressBar_6fjkv_170",ke={listItem:Ev,poster:Pv,posterImage:Nv,visible:Iv,activeLabel:Av,title:Tv,titleContainer:Lv,scheduledStart:$v,tags:Ov,lock:Dv,scheduled:Fv,tag:Rv,live:Mv,progressContainer:Bv,progressBar:Uv};function Hv({onHover:s,progress:t,activeLabel:e,item:r,url:a,loading:o=!1,isActive:i=!1,isLocked:c=!0}){const{title:l,duration:d,seasonNumber:u,episodeNumber:h,cardImage:g,mediaStatus:_,scheduledStart:f}=r,{t:x,i18n:{language:y}}=A("common"),[v,b]=p.useState(!1),w=B(ke.posterImage,{[ke.visible]:v}),j=sc(r),S=_===Tt.LIVE||rc(r),C=_===Tt.SCHEDULED,I=()=>{if(o||!l)return null;if(j)return n.jsx("div",{className:ke.tag,children:x("video:series")});if(h)return n.jsx("div",{className:ke.tag,children:Ln(u,h)});if(d)return n.jsx("div",{className:ke.tag,children:Wr(d)});if(S)return n.jsx("div",{className:B(ke.tag,ke.live),children:x("live")});if(C)return n.jsxs("div",{className:ke.tag,children:[n.jsx(J,{icon:sa,className:ke.scheduled}),x("scheduled")]})};return n.jsxs(en,{role:"button",to:a,className:ke.listItem,onMouseEnter:s,tabIndex:0,"data-testid":void 0,children:[n.jsxs("div",{className:ke.titleContainer,children:[n.jsx("h3",{className:ke.title,children:l}),!!f&&n.jsx("div",{className:ke.scheduledStart,children:En(f,y)})]}),n.jsxs("div",{className:ke.poster,children:[n.jsx($s,{className:w,image:g,onLoad:()=>b(!0),width:320,alt:""}),n.jsxs("div",{className:ke.tags,children:[c&&n.jsx("div",{className:B(ke.tag,ke.lock),"aria-label":x("card_lock"),children:n.jsx(J,{icon:ta})}),I()]}),i&&n.jsx("div",{className:ke.activeLabel,children:e}),t?n.jsx("div",{className:ke.progressContainer,children:n.jsx("div",{className:ke.progressBar,style:{width:`${Math.round(t*100)}%`}})}):null]})]})}const Wv=p.memo(Hv),Vv="_container_co6q3_1",qv="_content_co6q3_6",zv="_list_co6q3_13",ur={container:Vv,content:qv,list:zv},Pi=()=>{};function Gv({playlist:s,header:t,onListItemHover:e,isLoading:r=!1,watchHistory:a,activeMediaId:o,activeLabel:i,className:c,accessModel:l,isLoggedIn:d,hasSubscription:u,hasMore:h,loadMore:g=Pi,getUrl:_}){var f;return n.jsxs("div",{className:B(ur.container,!!c&&c),"data-testid":void 0,children:[!!t&&t,n.jsx("div",{className:ur.content,children:n.jsx(Dr,{element:"ul",pageStart:0,loadMore:g??Pi,hasMore:h??!1,className:ur.list,loader:n.jsx(na,{},"loader"),useWindow:!1,children:(f=s==null?void 0:s.playlist)==null?void 0:f.map(x=>n.jsx("li",{children:n.jsx(Wv,{url:_(x),progress:a?a[x.mediaid]:void 0,onHover:()=>e&&e(x),loading:r,isActive:o===x.mediaid,activeLabel:i,isLocked:Tn(l,d,u,x),item:x})},x.mediaid))})})]})}const Jv="_videoInlineLayout_mojbs_1",Yv="_player_mojbs_34",Kv="_videoDetailsInline_mojbs_58",Qv="_relatedVideosList_mojbs_63",Zv="_relatedVideosListHeader_mojbs_67",Xv="_relatedVideos_mojbs_63",ex="_relatedVideosGrid_mojbs_99",tx="_inlineLayout_mojbs_106",sx="_relatedVideosGridTitle_mojbs_122",nx="_relatedVideosListTitle_mojbs_131",rx="_filters_mojbs_139",ax="_filtersInline_mojbs_145",ox="_filterMetadata_mojbs_150",Ze={videoInlineLayout:Jv,player:Yv,videoDetailsInline:Kv,relatedVideosList:Qv,relatedVideosListHeader:Zv,relatedVideos:Xv,relatedVideosGrid:ex,inlineLayout:tx,relatedVideosGridTitle:sx,relatedVideosListTitle:nx,filters:rx,filtersInline:ax,filterMetadata:ox},Mn=({inlineLayout:s,player:t,playlist:e,accessModel:r,isLoading:a,isLoggedIn:o,item:i,hasSubscription:c,title:l,description:d,image:u,primaryMetadata:h,secondaryMetadata:g,shareButton:_,favoriteButton:f,startWatchingButton:x,trailerButton:y,relatedTitle:v,watchHistory:b,activeLabel:w,filters:j,setFilter:S,filterMetadata:C,currentFilter:I="",defaultFilterLabel:E="",children:P,hasMore:N,loadMore:$,getURL:O})=>{const U=Ne(),H=U===te.sm||U===te.md,T=j&&j.length>1,M=T&&S,Z=q=>n.jsxs("div",{className:B(Ze.filters,{[Ze.filtersInline]:s}),children:[!!C&&s&&n.jsx("span",{className:Ze.filterMetadata,children:C}),M&&n.jsx(Gc,{name:"season",value:I,defaultLabel:E,options:j,setValue:S,forceDropdown:q})]}),Q=(q=!0)=>e?q?n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:B(Ze.relatedVideosGrid,{[Ze.inlineLayout]:s}),children:[n.jsx("h2",{className:Ze.relatedVideosGridTitle,children:v||" "}),T&&Z(s)]}),n.jsx(Fn,{playlist:e,isLoading:a,watchHistory:b,accessModel:r,isLoggedIn:o,currentCardItem:i,currentCardLabel:w,hasSubscription:c,hasMore:N,loadMore:$,getUrl:O})]}):n.jsx("div",{className:Ze.relatedVideosList,children:n.jsx(Gv,{header:n.jsxs("div",{className:Ze.relatedVideosListHeader,children:[l&&n.jsx("h2",{className:Ze.relatedVideosListTitle,children:v}),T&&Z(!0)]}),activeMediaId:i==null?void 0:i.mediaid,activeLabel:w,playlist:e,watchHistory:b,isLoading:a,accessModel:r,isLoggedIn:o,hasSubscription:c,hasMore:N,loadMore:$,getUrl:O})}):null;return s?n.jsxs("div",{className:Ze.videoInlineLayout,"data-testid":void 0,children:[n.jsx("div",{className:Ze.player,children:t}),n.jsx("div",{className:Ze.videoDetailsInline,children:n.jsx(kv,{title:g||l,live:(i==null?void 0:i.duration)===0,description:d,primaryMetadata:h,shareButton:_,favoriteButton:f,trailerButton:y})}),Q(H),P]}):n.jsxs(Jc,{title:l,description:d,image:u,startWatchingButton:x,favoriteButton:f,trailerButton:y,shareButton:_,primaryMetadata:h,secondaryMetadata:g,children:[e&&n.jsx("section",{className:Ze.relatedVideos,children:Q(!0)}),P,t]})},da=({className:s,open:t=!0,duration:e=250,delay:r=0,onOpenAnimationEnd:a,onCloseAnimationEnd:o,keepMounted:i,children:c})=>{const d=`opacity ${e/1e3}s ease-in-out`,u=h=>({transition:d,opacity:h==="opening"||h==="open"?1:0,willChange:"opacity"});return n.jsx(qr,{className:s,createStyle:h=>u(h),open:t,duration:e,delay:r,onOpenAnimationEnd:a,onCloseAnimationEnd:o,keepMounted:i,children:c})},ix=3e5,cx=(s,t,e)=>{const r=p.useRef(null),a=G(Qs),{features:o}=z(u=>u.config),c=!!(o==null?void 0:o.continueWatchingList),l=p.useCallback(()=>{if(!c||!r.current)return;const{item:u,seriesItem:h,progress:g}=r.current;a.saveItem(u,h,g),r.current=null},[c,a]),d=ge(u=>{var g;if(u.duration<0)return;const h=Number((u.position/u.duration).toFixed(5));!isNaN(h)&&isFinite(h)&&(r.current={item:t,seriesItem:e,progress:h,timestamp:((g=r.current)==null?void 0:g.timestamp)||Date.now()},Date.now()-r.current.timestamp>ix&&l())});p.useEffect(()=>{if(!(!s||!c))return s.on("time",d),s.on("pause",l),s.on("complete",l),s.on("remove",l),()=>{s.off("time",d),s.off("pause",l),s.off("complete",l),s.off("remove",l)}},[s,c,l,d]),p.useEffect(()=>()=>{l()},[t==null?void 0:t.mediaid,l]),p.useLayoutEffect(()=>{const u=()=>document.visibilityState==="hidden"&&l();return window.addEventListener("pagehide",l),window.addEventListener("visibilitychange",u),()=>{window.removeEventListener("pagehide",l),window.removeEventListener("visibilitychange",u)}},[l])},lx=(s,t,e)=>{const{features:r}=z(c=>c.config),o=!!(r==null?void 0:r.continueWatchingList);cx(s,t,e);const i=ut(c=>t&&o?c.getItem(t):void 0);return p.useMemo(()=>{const c=i==null?void 0:i.progress;return c&&c>Gt.Min&&c<Gt.Max?c*t.duration:0},[t.duration,i==null?void 0:i.progress])},dx=(s,t)=>{const e=r=>{if(!s)return r;const a=[s,t].filter(Boolean).join("-");return{...r,allSources:void 0,sources:r.sources.map(o=>({...o,file:Se(o.file,{t:a})}))}};return ge(async r=>e(r))},Ni=60*1e3*20,ux=({adScheduleId:s,enabled:t})=>{const e=G(Me),{isLoading:r,data:a}=qe(["ad-schedule",s],async()=>e.getAdSchedule(s),{enabled:t&&!!s,cacheTime:Ni,staleTime:Ni});return{isLoading:r,data:a}},hx=({mediaId:s})=>{const{adSchedule:t,adConfig:e,adScheduleUrls:r,adDeliveryMethod:a}=z(d=>d.config),o=!!e&&a!=="ssai",{data:i,isLoading:c}=ux({adScheduleId:t,enabled:!!t}),l=o?{client:"vast",schedule:Se((r==null?void 0:r.xml)||"",{media_id:s})}:void 0;return{isLoading:o?!1:c,data:o?l:i}},mx=(s,t,e,r={},a=!0,o)=>{var w;const i=G(lc),c=G(dc),{configId:l,signingConfig:d,contentProtection:u,jwp:h,urlSigning:g}=z(({config:j})=>{var S;return{configId:j.id,signingConfig:j.contentSigningService,contentProtection:j.contentProtection,jwp:j.integrations.jwp,urlSigning:os((S=j==null?void 0:j.custom)==null?void 0:S.urlSigning)}}),_=d==null?void 0:d.host,f=((w=u==null?void 0:u.drm)==null?void 0:w.defaultPolicyId)??(d==null?void 0:d.drmPolicyId),x=!!g||!!_||!!f&&!_,{data:y,isLoading:v}=qe(["token",s,t,r],async()=>{if(t&&_){const S=await G(fe).getAuthData(),{host:C,drmPolicyId:I}=d;return i.getMediaToken(C,t,S==null?void 0:S.jwt,r,I)}if(h&&l&&t&&x)return c.getJWPMediaToken(l,t)},{enabled:x&&a&&!!t,keepPreviousData:!1,staleTime:15*60*1e3}),b=qe([s,t,r,y],async()=>e(y,f),{enabled:!!t&&a&&(!x||!!y),placeholderData:t?o:void 0,retry:2,retryDelay:1e3,keepPreviousData:!1});return{...b,isLoading:v||b.isLoading}};function px(s){const t=G(Me),e=mx("media",s.mediaid,(o,i)=>t.getMediaById(s.mediaid,o,i)),{isLoading:r,data:a}=qe(["media","geo",s.mediaid],()=>{var i;const o=(i=e.data)==null?void 0:i.sources.find(c=>c.file.indexOf(".m3u8")!==-1);return o?fetch(o.file,{method:"HEAD"}).then(c=>c.status===403):!1},{enabled:e.isFetched});return{...e,isGeoBlocked:a,isLoading:e.isLoading||r}}const fx=(s,t="")=>{const e=z(u=>u.config.analyticsToken),r=R(u=>u.user),{config:a}=z(u=>u),o=r!=null&&r.id?Number(r.id):void 0,i=a==null?void 0:a.id,c=K.APP_VERSION,[l,d]=p.useState(null);return p.useEffect(()=>{const u="jwpltx"in window?window.jwpltx:void 0;if(!u||!e||!l||!s)return;const h=({position:v,duration:b})=>{u.time(v,b)},g=({offset:v})=>{u.seek(v,l.getDuration())},_=()=>{u.seeked()},f=()=>{e&&s&&u.ready(e,window.location.hostname,t,s.mediaid,s.title,o,i,c)},x=()=>{u.complete()},y=()=>{u.adImpression()};return l.on("playlistItem",f),l.on("complete",x),l.on("time",h),l.on("seek",g),l.on("seeked",_),l.on("adImpression",y),()=>{u.remove(),l.off("playlistItem",f),l.off("complete",x),l.off("time",h),l.off("seek",g),l.off("seeked",_),l.off("adImpression",y)}},[l,s,e,t,o,i,c]),d},gx=(s,t,e,r)=>r.some(a=>s===`${t}/manifests/${e}.${a}`),_x=(s,t,e,r)=>r.some(a=>s===`${t}/live/broadcast/${e}.${a}`),yx=({item:s,baseUrl:t,config:e,user:r})=>{const{sources:a,mediaid:o}=s,{adConfig:i,siteId:c,adDeliveryMethod:l}=e,d=r==null?void 0:r.id,u=!!i&&l==="ssai";return a.map(h=>{const g=new URL(h.file),_=g.href,f=_x(_,t,o,["m3u8","mpd"]),x=gx(_,t,o,["m3u8","mpd"]),y=g.searchParams.has("exp")&&g.searchParams.has("sig");return x&&u&&!y?(g.href=`${t}/v2/sites/${c}/media/${o}/ssai.m3u8`,g.searchParams.set("ad_config_id",i)):(x||f)&&d&&g.searchParams.set("user_id",d),h.file=g.toString(),h})},vx=({item:s,baseUrl:t})=>{const e=z(a=>a.config),r=R(a=>a.user);return p.useMemo(()=>yx({item:s,baseUrl:t,config:e,user:r}),[s,t,e,r])},xx="_container_79xjy_1",wx={container:xx},Yc=({item:s,adsData:t,onReady:e,onPlay:r,onPause:a,onComplete:o,onUserActive:i,onUserInActive:c,onBeforePlay:l,onFirstFrame:d,onRemove:u,onPlaylistItem:h,onPlaylistItemCallback:g,onNext:_,onBackClick:f,feedId:x,startTime:y=0,autostart:v})=>{const b=p.useRef(null),w=p.useRef(),j=p.useRef(!1),S=p.useRef(!1),[C,I]=p.useState(!!window.jwplayer),E=p.useRef(y),P=vx({item:s,baseUrl:K.APP_API_BASE_URL}),N=fx(s,x),{settings:$}=z(Y=>Y),O=$.playerId,U=$.playerLicenseKey,H=ge(l),T=ge(r),M=ge(a),Z=ge(o),Q=ge(i),q=ge(c),k=ge(()=>{var me;const Y=(me=w.current)==null?void 0:me.getContainer(),he=Y==null?void 0:Y.querySelector('.jw-controlbar [aria-label="Play"], .jw-button-container [aria-label="Pause"]');he==null||he.focus(),d==null||d()}),L=ge(u),W=ge(h),X=ge(g),se=ge(_),we=ge(()=>{S.current=!0,f==null||f()}),ue=ge(()=>e&&e(w.current)),je=p.useCallback(()=>{var Y,he,me,Ie,ee,Be,Je,mt,ls,Lt,Qt,$t,pt;(Y=w.current)==null||Y.on("ready",ue),(he=w.current)==null||he.on("beforePlay",H),(me=w.current)==null||me.on("complete",Z),(Ie=w.current)==null||Ie.on("play",T),(ee=w.current)==null||ee.on("pause",M),(Be=w.current)==null||Be.on("userActive",Q),(Je=w.current)==null||Je.on("userInactive",q),(mt=w.current)==null||mt.on("firstFrame",k),(ls=w.current)==null||ls.on("remove",L),(Lt=w.current)==null||Lt.on("playlistItem",W),(Qt=w.current)==null||Qt.on("nextClick",se),($t=w.current)==null||$t.on("backClick",we),(pt=w.current)==null||pt.setPlaylistItemCallback(X)},[ue,H,Z,T,M,Q,q,k,L,W,se,X,we]),ie=p.useCallback(()=>{var Y,he,me,Ie,ee,Be,Je,mt;(Y=w.current)==null||Y.off("ready"),(he=w.current)==null||he.off("beforePlay"),(me=w.current)==null||me.off("complete"),(Ie=w.current)==null||Ie.off("play"),(ee=w.current)==null||ee.off("pause"),(Be=w.current)==null||Be.off("userActive"),(Je=w.current)==null||Je.off("userInactive"),(mt=w.current)==null||mt.off("firstFrame")},[]);return p.useEffect(()=>{if(!window.jwplayer&&!j.current){j.current=!0;const Y=`${K.APP_API_BASE_URL}/libraries/${O}.js`;wc(Y).then(()=>{I(!0),j.current=!1})}},[O]),p.useEffect(()=>{E.current=y},[y]),p.useEffect(()=>{const Y=()=>{var Ie,ee;if(!s||!w.current)return;const me=(Ie=w.current)==null?void 0:Ie.getPlaylistItem();if(me&&me.mediaid===s.mediaid){Xi("Player","Calling loadPlaylist with the same item, check the dependencies");return}typeof v<"u"&&((ee=w.current)==null||ee.setConfig({autostart:v})),w.current.load([Uo({...s,starttime:E.current,feedid:x})])},he=()=>{if(!window.jwplayer||!b.current)return;w.current=window.jwplayer(b.current);const me={advertising:{...t,showCountdown:!0},timeSlider:{showAdMarkers:!1},aspectratio:!1,controls:!0,displaytitle:!1,displayHeading:!1,displaydescription:!1,floating:{mode:"never"},height:"100%",mute:!1,playbackRateControls:!0,pipIcon:"disabled",playlist:[Uo({...s,starttime:E.current,feedid:x,sources:P})],repeat:!1,cast:{},stretching:"uniform",width:"100%"};typeof v<"u"&&(me.autostart=v),U&&(me.key=U),w.current.setup(me),N(w.current),je()};if(w.current)return Y();C&&he()},[C,s,ie,je,O,N,v,t,U,P,x]),p.useEffect(()=>()=>{if(w.current){if(ie(),S.current){S.current=!1;return}w.current.remove()}},[ie,S]),n.jsx("div",{className:wx.container,"data-testid":void 0,children:n.jsx("div",{ref:b})})},bx="_error_4iaxi_1",Sx="_title_4iaxi_11",Ii={error:bx,title:Sx};var Kc=(s=>(s.GEO_BLOCKED="GEO_BLOCKED",s))(Kc||{});const jx=()=>{const{t:s}=A("video");return n.jsxs("div",{className:Ii.error,children:[n.jsx("h2",{className:Ii.title,children:s("player_error.geo_blocked_title")}),n.jsx("p",{children:s("player_error.geo_blocked_description")})]})},Qc=({item:s,seriesItem:t,feedId:e,onPlay:r,onPause:a,onComplete:o,onUserActive:i,onUserInActive:c,onNext:l,onBackClick:d,liveEndDateTime:u,liveFromBeginning:h,liveStartDateTime:g,autostart:_})=>{const{data:f,isLoading:x}=hx({mediaId:s==null?void 0:s.mediaid}),{data:y,isLoading:v,isGeoBlocked:b}=px(s),[w,j]=p.useState(),S=lx(w,s,t),C=p.useCallback(P=>{j(P)},[]),I=p.useCallback(()=>{h&&(w==null||w.seek(0))},[h,w]),E=dx(g,u);return!y||v||x?n.jsx(xe,{inline:!0}):b?n.jsx(jx,{error:Kc.GEO_BLOCKED}):n.jsx(Yc,{feedId:e,item:y,adsData:f,onReady:C,onFirstFrame:I,onPlay:r,onPause:a,onComplete:o,onUserActive:i,onUserInActive:c,onNext:l,onBackClick:d,onPlaylistItemCallback:E,startTime:S,autostart:_})},Cx="_inlinePlayer_ytzkx_1",kx="_paywall_ytzkx_10",Ex="_poster_ytzkx_26",Px="_lock_ytzkx_47",Nx="_title_ytzkx_62",Ix="_text_ytzkx_89",xs={inlinePlayer:Cx,paywall:kx,poster:Ex,lock:Px,title:Nx,text:Ix},Bn=({item:s,seriesItem:t,onPlay:e,onPause:r,onComplete:a,feedId:o,liveStartDateTime:i,liveEndDateTime:c,liveFromBeginning:l,startWatchingButton:d,isLoggedIn:u,isEntitled:h,autostart:g,playable:_=!0,hasMediaOffers:f})=>{const x=z(S=>S.config.siteName),{t:y}=A(),v=oe(),b=le(),w=()=>{v(V(b,"login"))},j=y(f?"video:buy_to_start_watching":"video:sign_up_to_start_watching");return n.jsxs("div",{className:xs.inlinePlayer,children:[n.jsx(da,{open:!_||!h,children:n.jsxs("div",{className:xs.paywall,children:[n.jsx($s,{className:xs.poster,image:s.backgroundImage,alt:s.title,width:1280}),!h&&n.jsxs(n.Fragment,{children:[n.jsx(J,{icon:ta,className:xs.lock}),n.jsx("h2",{className:xs.title,children:j}),n.jsx("span",{className:xs.text,children:y("account:choose_offer.watch_this_on_platform",{siteName:x})}),d,!u&&n.jsx(D,{onClick:w,label:y("common:sign_in")})]})]})}),h&&_&&n.jsx(Qc,{item:s,seriesItem:t,feedId:o,autostart:g,onPlay:e,onPause:r,onComplete:a,liveEndDateTime:c,liveFromBeginning:l,liveStartDateTime:i})]})},Zc=s=>p.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},p.createElement("path",{d:"M8,5.14V19.14L19,12.14L8,5.14Z"})),Ax="_progressRail_14udi_1",Tx="_progress_14udi_1",Ai={progressRail:Ax,progress:Tx},ln=({item:s,playUrl:t,disabled:e=!1,onClick:r})=>{const{t:a}=A("video"),o=oe(),i=le(),c=Ne(),l=z(w=>w.accessModel),u=!!R(w=>w.user),h=ut(w=>s&&w.getItem(s)),g=h==null?void 0:h.progress,_=ve(w=>w.setRequestedMediaOffers),{isEntitled:f,mediaOffers:x}=Os(s),y=!!x.length,v=p.useMemo(()=>a(f?typeof g=="number"?"continue_watching":"start_watching":y?"buy":u?"complete_your_subscription":"sign_up_to_start_watching"),[f,u,y,g,a]),b=p.useCallback(()=>{if(f){if(r){r();return}return t&&o(t)}return o(u?y?V(i,"choose-offer"):"/u/payments":V(i,"create-account"))},[f,t,o,u,i,y,r]);return p.useEffect(()=>(_(x),()=>_([])),[x,_]),l===$e.AVOD&&!f?null:n.jsx(D,{color:"primary",variant:"contained",size:"large",label:v,startIcon:f?n.jsx(J,{icon:Zc}):void 0,onClick:b,fullWidth:c<te.md,disabled:e,children:g?n.jsx("div",{className:Ai.progressRail,children:n.jsx("div",{className:Ai.progress,style:{width:`${g*100}%`}})}):null})},Lx="_cinemaContainer_mksdu_1",$x="_cinema_mksdu_1",Ox="_overlayFade_mksdu_13",Dx="_playerOverlay_mksdu_18",Fx="_playerContent_mksdu_35",Rx="_backButton_mksdu_45",Mx="_title_mksdu_57",Bx="_metaContainer_mksdu_74",Ux="_primaryMetadata_mksdu_79",Hx="_secondaryMetadata_mksdu_93",yt={cinemaContainer:Lx,cinema:$x,overlayFade:Ox,playerOverlay:Dx,playerContent:Fx,backButton:Rx,title:Mx,metaContainer:Bx,primaryMetadata:Ux,secondaryMetadata:Hx},dn=({open:s,item:t,seriesItem:e,title:r,primaryMetadata:a,secondaryMetadata:o,onPlay:i,onPause:c,onComplete:l,onClose:d,onNext:u,feedId:h,liveStartDateTime:g,liveEndDateTime:_,liveFromBeginning:f})=>{const{t:x}=A(),[y,v]=p.useState(!1),[b,w]=p.useState(!1),[j,S]=p.useState(!0),C=p.useCallback(()=>{v(!0),i&&i()},[i]),I=p.useCallback(()=>{v(!1),c&&c()},[c]),E=p.useCallback(()=>{l&&l()},[l]),P=p.useCallback(()=>{u&&u()},[u]),N=p.useCallback(()=>S(!0),[]),$=p.useCallback(()=>S(!1),[]);return p.useEffect(()=>{s&&S(!0)},[s]),n.jsx($n,{open:s,animationContainerClassName:yt.cinemaContainer,onClose:d,"aria-label":x("videoplayer"),children:n.jsxs("div",{className:yt.cinema,children:[n.jsx(da,{className:yt.overlayFade,open:!y||j||b,keepMounted:!0,children:n.jsx("div",{className:yt.playerOverlay,onFocus:()=>w(!0),onBlur:()=>w(!1),children:n.jsxs("div",{className:yt.playerContent,children:[n.jsx(ze,{"aria-label":x("common:back"),onClick:d,className:yt.backButton,children:n.jsx(J,{icon:Nc})}),n.jsxs("div",{children:[n.jsx("h1",{className:yt.title,children:r}),n.jsxs("div",{className:yt.metaContainer,children:[o&&n.jsx("div",{className:yt.secondaryMetadata,children:o}),n.jsx("div",{className:yt.primaryMetadata,children:a})]})]})]})})}),n.jsx(Qc,{item:t,seriesItem:e,feedId:h,autostart:!0,onPlay:C,onPause:I,onComplete:E,onUserActive:N,onUserInActive:$,onNext:P,onBackClick:d,liveEndDateTime:_,liveFromBeginning:f,liveStartDateTime:g})]})})},Wx="_container_1tbgz_1",Vx="_playerOverlay_1tbgz_13",qx="_title_1tbgz_24",hr={container:Wx,playerOverlay:Vx,title:qx},Un=({item:s,open:t,title:e,onClose:r})=>{const[a,o]=p.useState(!1),[i,c]=p.useState(!0),l=p.useCallback(()=>o(!0),[]),d=p.useCallback(()=>o(!1),[]),u=p.useCallback(()=>c(!0),[]),h=p.useCallback(()=>c(!1),[]);return s?n.jsx($n,{open:t,onClose:r,"aria-labelledby":"trailer-modal-title",centered:!0,children:n.jsxs("div",{className:hr.container,children:[n.jsx(Yc,{item:s,onPlay:l,onPause:d,onComplete:r,onUserActive:u,onUserInActive:h,autostart:!0}),n.jsxs(da,{open:!a||i,keepMounted:!0,children:[n.jsx("div",{className:hr.playerOverlay,children:n.jsx("h1",{id:"trailer-modal-title",className:hr.title,children:e})}),n.jsx(bc,{onClick:r})]})]})}):null},zx=s=>p.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},p.createElement("path",{d:"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"})),Gx=s=>p.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},p.createElement("path",{d:"M18,16.08C17.24,16.08 16.56,16.38 16.04,16.85L8.91,12.7C8.96,12.47 9,12.24 9,12C9,11.76 8.96,11.53 8.91,11.3L15.96,7.19C16.5,7.69 17.21,8 18,8A3,3 0 0,0 21,5A3,3 0 0,0 18,2A3,3 0 0,0 15,5C15,5.24 15.04,5.47 15.09,5.7L8.04,9.81C7.5,9.31 6.79,9 6,9A3,3 0 0,0 3,12A3,3 0 0,0 6,15C6.79,15 7.5,14.69 8.04,14.19L15.16,18.34C15.11,18.55 15.08,18.77 15.08,19C15.08,20.61 16.39,21.91 18,21.91C19.61,21.91 20.92,20.61 20.92,19A2.92,2.92 0 0,0 18,16.08Z"})),Jx=s=>{const t=document.activeElement,e=document.createElement("input");e.style.zIndex="-10",e.style.position="absolute",e.style.left="-1000",e.value=s,document.body.appendChild(e),e.select(),document.execCommand("copy"),e.blur(),document.body.removeChild(e),t==null||t.focus()},un=({title:s,description:t,url:e})=>{const{t:r}=A(),a=Ne(),[o,i]=p.useState(!1),c=async()=>{if(typeof navigator.share=="function"){await navigator.share({title:s,text:t,url:e});return}Jx(window.location.href),i(!0),setTimeout(()=>i(!1),2e3)};return n.jsx(D,{label:r(o?"video:copied_url":"video:share"),startIcon:o?n.jsx(J,{icon:zx}):n.jsx(J,{icon:Gx}),onClick:c,active:o,fullWidth:a<te.md})},Yx=s=>p.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},p.createElement("path",{d:"M12.1,18.55L12,18.65L11.89,18.55C7.14,14.24 4,11.39 4,8.5C4,6.5 5.5,5 7.5,5C9.04,5 10.54,6 11.07,7.36H12.93C13.46,6 14.96,5 16.5,5C18.5,5 20,6.5 20,8.5C20,11.39 16.86,14.24 12.1,18.55M16.5,3C14.76,3 13.09,3.81 12,5.08C10.91,3.81 9.24,3 7.5,3C4.42,3 2,5.41 2,8.5C2,12.27 5.4,15.36 10.55,20.03L12,21.35L13.45,20.03C18.6,15.36 22,12.27 22,8.5C22,5.41 19.58,3 16.5,3Z"})),Hn=({item:s})=>{const{t}=A(),e=Ne(),r=G(ks),{isFavorite:a,clearWarning:o,warning:i}=lt(l=>({isFavorite:!!s&&l.hasItem(s),clearWarning:l.clearWarning,warning:l.warning})),c=p.useCallback(async()=>{await r.toggleFavorite(s)},[s,r]);return p.useEffect(()=>()=>o(),[o]),n.jsxs(n.Fragment,{children:[n.jsx(D,{label:t("video:favorite"),"aria-label":t("video:favorite"),startIcon:a?n.jsx(J,{icon:aa}):n.jsx(J,{icon:Yx}),onClick:c,"aria-pressed":a,color:a?"primary":"default",fullWidth:e<te.md}),n.jsx(oa,{open:i!==null,message:i,onClose:o})]})},Kx="_loading_1bc17_1",Qx={loading:Kx},cs=()=>n.jsx("div",{className:Qx.loading,children:n.jsx(is,{})}),Zx="_separator_14n07_1",Xx={separator:Zx},Es=({attributes:s,separator:t="•"})=>n.jsx("div",{children:s.map((e,r)=>n.jsxs(Ee.Fragment,{children:[n.jsx("span",{children:e}),r<s.length-1&&n.jsx("span",{className:Xx.separator,"aria-hidden":"true",children:t})]},e))});function Pn(s,t=!1){if(!s)return"";const e=new Date(s?s*1e3:0),r=e.getUTCHours(),a=e.getUTCMinutes(),o=e.getUTCSeconds();if(!t)return e.toISOString();let i="PT";return r>0&&(i+=r+"H"),a>0&&(i+=a+"M"),o>0&&(i+=o+"S"),i}const e1=()=>{const s=new Date(Date.UTC(2022,6,20,18,0,0));return/am|pm/.test(s.toLocaleTimeString())},t1=s=>((s==null?void 0:s.playlist)||[]).reduce((t,e)=>t.some(r=>(r==null?void 0:r.value)===(e==null?void 0:e.seasonNumber))?t:t.concat(e.seasonNumber?[{label:_e.t("video:season_number_filter_template",{seasonNumber:e.seasonNumber}),value:e.seasonNumber}]:[]),[]).slice().sort(),s1=(s,t)=>{if(s)return t===""?s:{...s,playlist:s.playlist.filter(({seasonNumber:e})=>e===t)}},n1=(s,t)=>{var r,a;if(!s||!t)return;const e=(r=t==null?void 0:t.playlist)==null?void 0:r.findIndex(({mediaid:o})=>o===s.mediaid);return(a=t==null?void 0:t.playlist)==null?void 0:a[e+1]},r1=(s,t)=>{var e;if(t)return(e=t.playlist.filter(r=>r.seasonNumber===(s==null?void 0:s.seasonNumber)))==null?void 0:e.length},a1=(s,t)=>({"@type":"TVSeries","@id":`${window.location.origin}/s/${t}`,name:s.title,numberOfEpisodes:String(s.playlist.length),numberOfSeasons:String(s.playlist.reduce(function(r,a){return!a.seasonNumber||r.includes(a.seasonNumber)?r:r.concat(a.seasonNumber)},[]).length)}),o1=(s,t,e,r)=>{const a=`${window.location.origin}${ts({episodeId:t==null?void 0:t.mediaid,seriesId:r})}`,o=a1(s,r);return JSON.stringify(t?{"@context":"http://schema.org/","@type":"TVEpisode","@id":a,episodeNumber:e==null?void 0:e.episodeNumber,seasonNumber:e==null?void 0:e.seasonNumber,name:t.title,uploadDate:Pn(t.pubdate),partOfSeries:o}:o)},i1=()=>{var pt,Ds;const s=Ne(),{t}=A("video"),[e,r]=p.useState(!1),a=oe(),i=Ps().id||"",c=Re("play")==="1",l=Re("r"),d=Re("e"),{isLoading:u,data:h,isError:g}=cn(i,{},!0,!1),{isLoading:_,data:f}=Yt(d||""),{isLoading:x,data:y}=Yt((f==null?void 0:f.trailerId)||""),v=p.useMemo(()=>({episodeNumber:(f==null?void 0:f.episodeNumber)||"0",seasonNumber:(f==null?void 0:f.seasonNumber)||"0"}),[f]),b=f||h,w=(b==null?void 0:b.image)||"",{config:j,accessModel:S}=z(({config:be,accessModel:Fs})=>({config:be,accessModel:Fs}),ce),{features:C,siteName:I,custom:E}=j,P=!!(C!=null&&C.favoritesList),N=!!(E!=null&&E.inlinePlayer),$=p.useMemo(()=>t1(h),[h]),[O,U]=p.useState(void 0),H=p.useMemo(()=>{var be;return(be=h==null?void 0:h.playlist)==null?void 0:be[0]},[h]),T=p.useMemo(()=>s1(h,O),[h,O]),M=r1(f,h),Z=p.useMemo(()=>n1(f,h),[f,h]),Q=ut(be=>be.getDictionaryWithEpisodes()),{user:q,subscription:k}=R(({user:be,subscription:Fs})=>({user:be,subscription:Fs}),ce),{isEntitled:L,mediaOffers:W}=Os(f||H),X=!!W.length,se=!!q,we=!!k,ue=()=>f&&a(ts({episodeId:f.mediaid,seriesId:i,play:!1,playlistId:l})),je=be=>h?ts({episodeId:be.mediaid,seriesId:i,play:!1,playlistId:l}):"",ie=p.useCallback(async()=>{a(ts({episodeId:Z==null?void 0:Z.mediaid,seriesId:i,play:!!Z,playlistId:l}))},[a,Z,i,l]);p.useEffect(()=>{var be;(document.scrollingElement||document.body).scroll({top:0}),(be=document.querySelector("#video-details button"))==null||be.focus()},[f]),p.useEffect(()=>{var be;u||_||O===void 0&&U(parseInt(v==null?void 0:v.seasonNumber,10)?v==null?void 0:v.seasonNumber:((be=$==null?void 0:$[0])==null?void 0:be.value)||"")},[v,O,u,_,$]);const Y=u||_;if(Y)return n.jsx(cs,{});if(g||!h||!b||!H)return n.jsx(et,{title:t("series_error")});const he=`${b.title} - ${I}`,me=(b==null?void 0:b.description)||"",Ie=`${window.location.origin}${ts({episodeId:f==null?void 0:f.mediaid,seriesId:i})}`,ee=b.backgroundImage||void 0,Be=f?n.jsx(Es,{attributes:ia(f,t("video:total_episodes",{count:(pt=h==null?void 0:h.playlist)==null?void 0:pt.length}))}):n.jsx(Es,{attributes:zy(h,t("video:total_episodes",{count:(Ds=h==null?void 0:h.playlist)==null?void 0:Ds.length}))}),Je=v&&f&&n.jsxs(n.Fragment,{children:[n.jsx("strong",{children:Ln(v.seasonNumber,v.episodeNumber)})," - ",f.title]}),mt=v&&` ${t("video:season")} ${v.seasonNumber}/${$==null?void 0:$.length} - ${t("video:episode")} ${v.episodeNumber}/${M}`,ls=n.jsx(un,{title:b==null?void 0:b.title,description:me,url:Ie}),Lt=n.jsx(ln,{item:f||H,playUrl:ts({episodeId:(f==null?void 0:f.mediaid)||(H==null?void 0:H.mediaid),seriesId:i,play:!0,playlistId:l})},d),Qt=P&&n.jsx(Hn,{item:f||H}),$t=(!!y||x)&&n.jsx(D,{label:t("video:trailer"),"aria-label":t("video:watch_trailer"),startIcon:n.jsx(J,{icon:Rn}),onClick:()=>r(!0),active:e,fullWidth:s<te.md,disabled:!y});return n.jsxs(Ee.Fragment,{children:[n.jsxs(xt,{children:[n.jsx("title",{children:he}),n.jsx("link",{rel:"canonical",href:Ie}),n.jsx("meta",{name:"description",content:me}),n.jsx("meta",{property:"og:description",content:me}),n.jsx("meta",{property:"og:title",content:he}),n.jsx("meta",{property:"og:type",content:f?"video.episode":"video.series"}),w&&n.jsx("meta",{property:"og:image",content:w==null?void 0:w.replace(/^https:/,"http:")}),w&&n.jsx("meta",{property:"og:image:secure_url",content:w==null?void 0:w.replace(/^http:/,"https:")}),w&&n.jsx("meta",{property:"og:image:width",content:w?"720":""}),w&&n.jsx("meta",{property:"og:image:height",content:w?"406":""}),n.jsx("meta",{name:"twitter:title",content:he}),n.jsx("meta",{name:"twitter:description",content:me}),w&&n.jsx("meta",{name:"twitter:image",content:w}),n.jsx("meta",{property:"og:video",content:Ie.replace(/^https:/,"http:")}),n.jsx("meta",{property:"og:video:secure_url",content:Ie.replace(/^http:/,"https:")}),n.jsx("meta",{property:"og:video:type",content:"text/html"}),n.jsx("meta",{property:"og:video:width",content:"1280"}),n.jsx("meta",{property:"og:video:height",content:"720"}),b.tags?String(b.tags).split(",").map(be=>n.jsx("meta",{property:"og:video:tag",content:be},be)):null,h&&b?n.jsx("script",{type:"application/ld+json",children:o1(h,f,v,i)}):null]}),n.jsx(Mn,{item:f,title:b.title,description:me,inlineLayout:N,primaryMetadata:Be,secondaryMetadata:Je,image:ee,shareButton:ls,favoriteButton:Qt,trailerButton:$t,startWatchingButton:Lt,isLoading:Y,accessModel:S,isLoggedIn:se,hasSubscription:we,playlist:T,relatedTitle:N?b.title:t("episodes"),setFilter:U,currentFilter:O,defaultFilterLabel:t("all_seasons"),activeLabel:t("current_episode"),watchHistory:Q,filterMetadata:mt,filters:$,getURL:je,player:N&&(f||H)?n.jsx(Bn,{isLoggedIn:se,item:f||H,onComplete:ie,feedId:l??void 0,startWatchingButton:Lt,isEntitled:L,hasMediaOffers:X,autostart:c||void 0}):n.jsx(dn,{open:c&&L,onClose:ue,item:f||H,title:(f==null?void 0:f.title)||H.title,primaryMetadata:Be,secondaryMetadata:Je,onComplete:ie,feedId:l??void 0})}),f&&n.jsx(Un,{item:y,title:`${f.title} - Trailer`,open:e,onClose:()=>r(!1)})]})};class ua{constructor(){m(this,"defaultScreen");m(this,"definitions",[])}register(t,e){this.definitions.push({component:t,predicate:e})}registerByContentType(t,e){this.register(t,r=>!!r&&nn(r,e))}registerDefault(t){this.defaultScreen=t}getScreen(t){var r;const e=(r=this.definitions.find(({predicate:a})=>a(t)))==null?void 0:r.component;if(e)return e;if(!this.defaultScreen)throw new Error("Default screen not defined");return this.defaultScreen}}const c1="_mediaStaticPage_v6zr1_1",l1={mediaStaticPage:c1},d1=({data:s})=>{const{config:t}=z(({config:o})=>({config:o}),ce),{siteName:e}=t,r=`${s.title} - ${e}`,a=s?`${window.location.origin}${Le({media:s})}`:window.location.href;return p.useEffect(()=>{(document.scrollingElement||document.body).scroll({top:0})},[s.mediaid]),n.jsxs(n.Fragment,{children:[n.jsxs(xt,{children:[n.jsx("title",{children:r}),n.jsx("link",{rel:"canonical",href:a}),n.jsx("meta",{property:"og:title",content:r}),n.jsx("meta",{name:"twitter:title",content:r})]}),n.jsx("div",{className:l1.mediaStaticPage,children:n.jsx(Xr,{markdownString:s.markdown||s.description})})]})},ha=(s,t)=>{const e=`${t}${Le({media:s})}`;return JSON.stringify({"@context":"http://schema.org/","@type":"VideoObject","@id":e,name:s.title,description:s.description,duration:Pn(s.duration,!0),thumbnailUrl:s.image,uploadDate:Pn(s.pubdate)})},u1=(s,t,e,r)=>({"@type":"TVSeries","@id":`${r}/m/${e}`,name:t.title,numberOfEpisodes:String((s==null?void 0:s.episode_count)||0),numberOfSeasons:String((s==null?void 0:s.season_count)||0)}),h1=(s,t,e,r,a)=>{const o=`${e}/m/${s.series_id}?e=${r==null?void 0:r.mediaid}`,i=u1(s,t,s.series_id,e);return JSON.stringify(r?{"@context":"http://schema.org/","@type":"TVEpisode","@id":o,episodeNumber:(a==null?void 0:a.episodeNumber)||"0",seasonNumber:(a==null?void 0:a.seasonNumber)||"0",name:r.title,uploadDate:Pn(r.pubdate),partOfSeries:i}:i)},Xc=({data:s,isLoading:t})=>{var X,se,we;const{t:e}=A("video"),[r,a]=p.useState(!1),o=Ne(),i=oe(),l=Ps().id||"",d=Re("play")==="1",u=Re("r"),{config:h,accessModel:g}=z(({config:ue,accessModel:je})=>({config:ue,accessModel:je}),ce),{siteName:_,features:f,custom:x}=h,y=!!(f!=null&&f.favoritesList),v=!!(x!=null&&x.inlinePlayer),{isLoading:b,data:w}=Yt((s==null?void 0:s.trailerId)||""),{isLoading:j,data:S}=cn((f==null?void 0:f.recommendationsPlaylist)||"",{related_media_id:l}),{user:C,subscription:I}=R(({user:ue,subscription:je})=>({user:ue,subscription:je}),ce),{isEntitled:E,mediaOffers:P}=Os(s),N=!!P.length,$=()=>s&&i(Le({media:s,playlistId:u,play:!1})),O=ue=>Le({media:ue,playlistId:f==null?void 0:f.recommendationsPlaylist}),U=p.useCallback(()=>{if(!l||!S)return;const ue=S.playlist.findIndex(({mediaid:ie})=>ie===l),je=S.playlist[ue+1];return je&&i(Le({media:je,playlistId:f==null?void 0:f.recommendationsPlaylist,play:!0}))},[l,S,i,f==null?void 0:f.recommendationsPlaylist]);p.useEffect(()=>{var ue;(document.scrollingElement||document.body).scroll({top:0}),(ue=document.querySelector("#video-details button"))==null||ue.focus()},[l]);const H=`${s.title} - ${_}`,T=s?`${window.location.origin}${Le({media:s})}`:window.location.href,M=n.jsx(Es,{attributes:ia(s)}),Z=n.jsx(un,{title:s.title,description:s.description,url:T}),Q=n.jsx(ln,{item:s,playUrl:Le({media:s,playlistId:u,play:!0})},l),q=y&&n.jsx(Hn,{item:s}),k=(!!w||b)&&n.jsx(D,{label:e("video:trailer"),"aria-label":e("video:watch_trailer"),startIcon:n.jsx(J,{icon:Rn}),onClick:()=>a(!0),active:r,fullWidth:o<te.md,disabled:!w}),L=!!C,W=!!I;return n.jsxs(Ee.Fragment,{children:[n.jsxs(xt,{children:[n.jsx("title",{children:H}),n.jsx("link",{rel:"canonical",href:T}),n.jsx("meta",{name:"description",content:s.description}),n.jsx("meta",{property:"og:description",content:s.description}),n.jsx("meta",{property:"og:title",content:H}),n.jsx("meta",{property:"og:type",content:"video.other"}),s.image&&n.jsx("meta",{property:"og:image",content:(X=s.image)==null?void 0:X.replace(/^https:/,"http:")}),s.image&&n.jsx("meta",{property:"og:image:secure_url",content:(se=s.image)==null?void 0:se.replace(/^http:/,"https:")}),n.jsx("meta",{property:"og:image:width",content:s.image?"720":""}),n.jsx("meta",{property:"og:image:height",content:s.image?"406":""}),n.jsx("meta",{name:"twitter:title",content:H}),n.jsx("meta",{name:"twitter:description",content:s.description}),n.jsx("meta",{name:"twitter:image",content:s.image}),n.jsx("meta",{property:"og:video",content:T.replace(/^https:/,"http:")}),n.jsx("meta",{property:"og:video:secure_url",content:T.replace(/^http:/,"https:")}),n.jsx("meta",{property:"og:video:type",content:"text/html"}),n.jsx("meta",{property:"og:video:width",content:"1280"}),n.jsx("meta",{property:"og:video:height",content:"720"}),(we=s.tags)==null?void 0:we.split(",").map(ue=>n.jsx("meta",{property:"og:video:tag",content:ue},ue)),s?n.jsx("script",{type:"application/ld+json",children:ha(s,window.location.origin)}):null]}),n.jsx(Mn,{item:s,inlineLayout:v,isLoading:t||j,accessModel:g,isLoggedIn:L,hasSubscription:W,title:s.title,description:s.description,image:s.backgroundImage,primaryMetadata:M,shareButton:Z,favoriteButton:q,trailerButton:k,startWatchingButton:Q,playlist:S,relatedTitle:S==null?void 0:S.title,getURL:O,activeLabel:e("current_video"),player:v?n.jsx(Bn,{isLoggedIn:L,item:s,onComplete:U,feedId:u??void 0,startWatchingButton:Q,isEntitled:E,hasMediaOffers:N,autostart:d||void 0}):n.jsx(dn,{open:d&&E,onClose:$,item:s,title:s.title,primaryMetadata:M,onComplete:U,feedId:u??void 0,onNext:U})}),n.jsx(Un,{item:w,title:`${s.title} - Trailer`,open:r,onClose:()=>a(!1)})]})},m1=s=>s&&"seasons"in s?s.seasons.map(t=>({label:t.season_title||String(t.season_number),value:String(t.season_number)})):[],p1=(s,t)=>{var e;return(e=((t==null?void 0:t.seasons)||[]).find(r=>r.season_number===Number(s==null?void 0:s.seasonNumber)))==null?void 0:e.episode_count},f1=s=>{const t=G(Me),{data:e,isLoading:r,error:a}=qe(["series",s],async()=>await t.getSeries(s||""),{enabled:!!s,staleTime:Is,cacheTime:Ns,retry:(o,i)=>i.code!==404&&o<2});return{data:e,isLoading:r,error:a}},g1=s=>{const{page:t,page_limit:e,total:r}=s;if(!(e*t>=r))return t},_1=(s,t,e)=>{const r=G(Me),{data:a,fetchNextPage:o,isLoading:i,hasNextPage:c=!1}=Ml([s,t],async({pageParam:l=0})=>{if(Number(t)){const d=await r.getSeasonWithEpisodes({seriesId:s,seasonNumber:Number(t),pageOffset:l});return{pagination:d.pagination,episodes:d.episodes}}else return await r.getEpisodes({seriesId:s,pageOffset:l})},{getNextPageParam:l=>g1(l==null?void 0:l.pagination),enabled:e.enabled,staleTime:Is,cacheTime:Ns});return{data:(a==null?void 0:a.pages)||[],isLoading:i,fetchNextPage:o,hasNextPage:c}},el=s=>{const t=G(Me),{isLoading:e,data:r}=qe(["seriesLookup",s],async()=>{var i;if(!s)return;const a=await t.getSeriesByMediaIds([s]);return(i=a==null?void 0:a[s])==null?void 0:i[0]},{staleTime:Is,cacheTime:Ns,enabled:!!s});return{isLoading:e,data:r}},y1=({series:s,episodeId:t})=>{const e=G(Me),{isLoading:r,data:a}=qe(["next-episode",s==null?void 0:s.series_id,t],async()=>{var i;const o=await e.getEpisodes({seriesId:s==null?void 0:s.series_id,pageLimit:1,afterId:t});return(i=o==null?void 0:o.episodes)==null?void 0:i[0]},{staleTime:Is,cacheTime:Ns,enabled:!!(s!=null&&s.series_id&&t)});return{isLoading:r,data:a}},tl=({data:s})=>{var fa,ga,_a;const t=Ne(),{t:e}=A("video"),[r,a]=p.useState(!1),[o,i]=Xs(),c=s.mediaid,l=o.get("play")==="1",d=o.get("r"),u=o.get("e"),{isLoading:h,data:g,error:_}=f1(c),{isLoading:f,data:x}=Yt(u||""),{isLoading:y,data:v}=Yt((x==null?void 0:x.trailerId)||""),{data:b,isLoading:w}=el(x==null?void 0:x.mediaid),j=x||s,{config:S,accessModel:C}=z(({config:ne,accessModel:ds})=>({config:ne,accessModel:ds}),ce),{features:I,siteName:E,custom:P}=S,N=!!(I!=null&&I.favoritesList),$=!!(P!=null&&P.inlinePlayer),O=p.useMemo(()=>m1(g),[g]),[U,H]=p.useState(void 0),{data:T,fetchNextPage:M,hasNextPage:Z}=_1(c,U,{enabled:U!==void 0&&!!g}),Q=p.useMemo(()=>{var ne,ds;return(ds=(ne=T==null?void 0:T[0])==null?void 0:ne.episodes)==null?void 0:ds[0]},[T]),q=p.useMemo(()=>b&&{episodeNumber:b!=null&&b.episode_number?String(b.episode_number):"",seasonNumber:b!=null&&b.season_number?String(b.season_number):""},[b]),k=p.useMemo(()=>({title:s.title,description:s.description,feedid:g==null?void 0:g.series_id,playlist:(T==null?void 0:T.flatMap(ne=>ne.episodes))||[]}),[s,g,T]),L=p1(q,g),{data:W}=y1({series:g,episodeId:(x==null?void 0:x.mediaid)||(Q==null?void 0:Q.mediaid)}),X=ut(ne=>ne.watchHistory),se=ut(ne=>ne.getDictionaryWithEpisodes()),we=X.find(ne=>(ne==null?void 0:ne.seriesId)===c&&ne.progress>Gt.Min&&ne.progress<Gt.Max),{user:ue,subscription:je}=R(({user:ne,subscription:ds})=>({user:ne,subscription:ds}),ce),{isEntitled:ie,mediaOffers:Y}=Os(x||Q),he=!!Y.length,me=!!ue,Ie=!!je,ee=le(),Be=ne=>xc(ee,{e:ne.mediaid}),Je=p.useCallback(()=>{i({...o,e:x==null?void 0:x.mediaid,r:d||""})},[i,o,x,d]),mt=p.useCallback(async()=>{var ne;i({...o,e:(ne=W||x)==null?void 0:ne.mediaid,r:d||"",play:W?"1":"0"})},[i,W,x,d,o]),ls=p.useCallback(async()=>{x||i({...o,e:Q==null?void 0:Q.mediaid,r:d||"",play:"1"})},[i,Q,d,x,o]);p.useEffect(()=>{var ne;(document.scrollingElement||document.body).scroll({top:0}),(ne=document.querySelector("#video-details button"))==null||ne.focus()},[x]),p.useEffect(()=>{we&&!o.get("e")&&i({...o,e:we.mediaid,r:d||""},{replace:!0})},[we,i,o,d]),p.useEffect(()=>{var ne;if(!(h||f||w)){if(!u&&U===void 0){H(((ne=O[0])==null?void 0:ne.value)||"");return}U===void 0&&q&&H(q.seasonNumber)}},[q,U,h,f,w,O,u]);const Lt=p.useMemo(()=>n.jsx(ln,{item:x||Q,onClick:()=>{i({...o,e:(x||Q).mediaid,r:d||"",play:"1"},{replace:!0})}},u),[u,x,Q,i,o,d]),Qt=h||w||f;if(Qt)return n.jsx(cs,{});if((_==null?void 0:_.code)===404){const ne=cc(s,l,d);return n.jsx(rs,{to:ne,replace:!0})}if(!s||!g)return n.jsx(et,{title:e("series_error")});const $t=`${j.title} - ${E}`,pt=`${window.location.origin}${Le({media:s,episodeId:x==null?void 0:x.mediaid})}`,Ds=n.jsx(Es,{attributes:ia(j,e("video:total_episodes",{count:g.episode_count}))}),be=q&&x&&n.jsxs(n.Fragment,{children:[n.jsx("strong",{children:Ln(q.seasonNumber,q.episodeNumber)})," - ",x.title]}),Fs=q&&` ${e("video:season")} ${q.seasonNumber}/${O==null?void 0:O.length} - ${e("video:episode")} ${q.episodeNumber}/${L}`,dl=n.jsx(un,{title:j==null?void 0:j.title,description:j.description,url:pt}),ul=N&&n.jsx(Hn,{item:s||Q}),hl=(!!v||y)&&n.jsx(D,{label:e("video:trailer"),"aria-label":e("video:watch_trailer"),startIcon:n.jsx(J,{icon:Rn}),onClick:()=>a(!0),active:r,fullWidth:t<te.md,disabled:!v});return n.jsxs(Ee.Fragment,{children:[n.jsxs(xt,{children:[n.jsx("title",{children:$t}),n.jsx("link",{rel:"canonical",href:pt}),n.jsx("meta",{name:"description",content:j.description}),n.jsx("meta",{property:"og:description",content:j.description}),n.jsx("meta",{property:"og:title",content:$t}),n.jsx("meta",{property:"og:type",content:x?"video.episode":"video.series"}),j.image&&n.jsx("meta",{property:"og:image",content:(fa=j.image)==null?void 0:fa.replace(/^https:/,"http:")}),j.image&&n.jsx("meta",{property:"og:image:secure_url",content:(ga=j.image)==null?void 0:ga.replace(/^http:/,"https:")}),j.image&&n.jsx("meta",{property:"og:image:width",content:j.image?"720":""}),j.image&&n.jsx("meta",{property:"og:image:height",content:j.image?"406":""}),n.jsx("meta",{name:"twitter:title",content:$t}),n.jsx("meta",{name:"twitter:description",content:j.description}),n.jsx("meta",{name:"twitter:image",content:j.image}),n.jsx("meta",{property:"og:video",content:pt.replace(/^https:/,"http:")}),n.jsx("meta",{property:"og:video:secure_url",content:pt.replace(/^http:/,"https:")}),n.jsx("meta",{property:"og:video:type",content:"text/html"}),n.jsx("meta",{property:"og:video:width",content:"1280"}),n.jsx("meta",{property:"og:video:height",content:"720"}),(_a=j.tags)==null?void 0:_a.split(",").map(ne=>n.jsx("meta",{property:"og:video:tag",content:ne},ne)),j?n.jsx("script",{type:"application/ld+json",children:h1(g,s,window.location.origin,x,q)}):null]}),n.jsx(Mn,{item:j,title:$?j.title:s.title,description:j.description||s.description,inlineLayout:$,primaryMetadata:Ds,secondaryMetadata:be,image:j.backgroundImage,shareButton:dl,favoriteButton:ul,trailerButton:hl,startWatchingButton:Lt,isLoading:Qt,accessModel:C,isLoggedIn:me,hasSubscription:Ie,playlist:k,relatedTitle:$?s.title:e("episodes"),getURL:Be,setFilter:H,currentFilter:U,defaultFilterLabel:e("all_seasons"),activeLabel:e("current_episode"),watchHistory:se,filterMetadata:Fs,filters:O,hasMore:Z,loadMore:M,player:$&&(x||Q)?n.jsx(Bn,{isLoggedIn:me,item:x||Q,seriesItem:s,onComplete:mt,feedId:d??void 0,onPlay:ls,startWatchingButton:Lt,isEntitled:ie,hasMediaOffers:he,autostart:l||void 0}):n.jsx(dn,{open:l&&ie,onClose:Je,item:x||Q,seriesItem:s,title:s.title,primaryMetadata:Ds,secondaryMetadata:be,onComplete:mt,feedId:d??void 0})}),x&&n.jsx(Un,{item:v,title:`${x.title} - Trailer`,open:r,onClose:()=>a(!1)})]})},v1=({data:s,isLoading:t})=>{const e=s.liveChannelsId;return t?n.jsx(cs,{}):e?n.jsx(rs,{to:Ss(e,s.mediaid),replace:!0}):n.jsx(Xc,{data:s,isLoading:t})},sl=({data:s,isLoading:t})=>{const e=s.mediaid,[r]=Xs(),a=r.get("play")==="1",o=r.get("r"),{data:i,isLoading:c}=el(s.mediaid),{isLoading:l,data:d}=Yt((i==null?void 0:i.series_id)||"");return t||c||l?n.jsx(cs,{}):i?n.jsx(rs,{to:Le({episodeId:e,media:d,play:a,playlistId:o}),replace:!0}):n.jsx(rs,{to:cc(s,a,o),replace:!0})};function x1(s){return{isLiveEvent:Yi(s),isPlayable:vd(s)}}const w1="_tag_gc1jh_1",b1="_normal_gc1jh_11",S1="_large_gc1jh_20",j1="_live_gc1jh_31",mr={tag:w1,normal:b1,large:S1,live:j1},Tr=({children:s,className:t,isLive:e=!1,size:r="normal"})=>n.jsx("div",{className:B(t,mr.tag,mr[r],{[mr.live]:e}),children:s}),C1="_icon_1fdnv_1",Ti={icon:C1};function k1({mediaStatus:s}){const{t}=A("video");return s===Tt.SCHEDULED||s===Tt.VOD?n.jsx(J,{icon:sa,className:Ti.icon}):s===Tt.LIVE?n.jsx(Tr,{isLive:!0,className:Ti.icon,children:t("live")}):null}const E1=({data:s,isLoading:t})=>{var we,ue,je;const{t:e,i18n:r}=A("video"),[a,o]=p.useState(!1),i=Ne(),c=oe(),d=Ps().id||"",u=Re("play")==="1",h=Re("r"),{config:g,accessModel:_}=z(({config:ie,accessModel:Y})=>({config:ie,accessModel:Y}),ce),{siteName:f,features:x,custom:y}=g,v=!!(x!=null&&x.favoritesList),b=!!(y!=null&&y.inlinePlayer),{isLoading:w,data:j}=Yt((s==null?void 0:s.trailerId)||""),{isLoading:S,data:C}=cn(h||""),I=x1(s),{user:E,subscription:P}=R(({user:ie,subscription:Y})=>({user:ie,subscription:Y}),ce),{isEntitled:N,mediaOffers:$}=Os(s),O=!!$.length,U=()=>s&&c(Le({media:s,playlistId:h,play:!1})),H=ie=>Le({media:ie,playlistId:h}),T=p.useCallback(()=>{if(!d||!C)return;const ie=C.playlist.findIndex(({mediaid:he})=>he===d),Y=C.playlist[ie+1];if(Y.mediaStatus!==Tt.SCHEDULED)return Y&&c(Le({media:Y,playlistId:h,play:!0}))},[d,C,c,h]);p.useEffect(()=>{var ie;(document.scrollingElement||document.body).scroll({top:0}),(ie=document.querySelector("#video-details button"))==null||ie.focus()},[d]);const M=`${s.title} - ${f}`,Z=s?`${window.location.origin}${Le({media:s})}`:window.location.href,Q=n.jsxs(n.Fragment,{children:[n.jsx(k1,{mediaStatus:s.mediaStatus}),n.jsx(Es,{attributes:Gy(s,r.language)})]}),q=n.jsx(un,{title:s.title,description:s.description,url:Z}),k=n.jsx(ln,{item:s,playUrl:Le({media:s,playlistId:h,play:!0}),disabled:!I.isPlayable},d),L=v&&n.jsx(Hn,{item:s}),W=(!!j||w)&&n.jsx(D,{label:e("video:trailer"),"aria-label":e("video:watch_trailer"),startIcon:n.jsx(J,{icon:Rn}),onClick:()=>o(!0),active:a,fullWidth:i<te.md,disabled:!j}),X=!!E,se=!!P;return n.jsxs(Ee.Fragment,{children:[n.jsxs(xt,{children:[n.jsx("title",{children:M}),n.jsx("link",{rel:"canonical",href:Z}),n.jsx("meta",{name:"description",content:s.description}),n.jsx("meta",{property:"og:description",content:s.description}),n.jsx("meta",{property:"og:title",content:M}),n.jsx("meta",{property:"og:type",content:"video.other"}),s.image&&n.jsx("meta",{property:"og:image",content:(we=s.image)==null?void 0:we.replace(/^https:/,"http:")}),s.image&&n.jsx("meta",{property:"og:image:secure_url",content:(ue=s.image)==null?void 0:ue.replace(/^http:/,"https:")}),n.jsx("meta",{property:"og:image:width",content:s.image?"720":""}),n.jsx("meta",{property:"og:image:height",content:s.image?"406":""}),n.jsx("meta",{name:"twitter:title",content:M}),n.jsx("meta",{name:"twitter:description",content:s.description}),n.jsx("meta",{name:"twitter:image",content:s.image}),n.jsx("meta",{property:"og:video",content:Z.replace(/^https:/,"http:")}),n.jsx("meta",{property:"og:video:secure_url",content:Z.replace(/^http:/,"https:")}),n.jsx("meta",{property:"og:video:type",content:"text/html"}),n.jsx("meta",{property:"og:video:width",content:"1280"}),n.jsx("meta",{property:"og:video:height",content:"720"}),(je=s.tags)==null?void 0:je.split(",").map(ie=>n.jsx("meta",{property:"og:video:tag",content:ie},ie)),s?n.jsx("script",{type:"application/ld+json",children:ha(s,window.location.origin)}):null]}),n.jsx(Mn,{item:s,inlineLayout:b,isLoading:t||S,accessModel:_,isLoggedIn:X,hasSubscription:se,title:s.title,description:s.description,image:s.backgroundImage,primaryMetadata:Q,shareButton:q,favoriteButton:L,trailerButton:W,startWatchingButton:k,playlist:C,relatedTitle:C==null?void 0:C.title,getURL:H,activeLabel:e("current_video"),player:b?n.jsx(Bn,{isLoggedIn:X,item:s,onComplete:T,feedId:h??void 0,startWatchingButton:k,isEntitled:N,hasMediaOffers:O,autostart:I.isPlayable&&(u||void 0),playable:I.isPlayable}):n.jsx(dn,{open:u&&N,onClose:U,item:s,title:s.title,primaryMetadata:Q,onComplete:T,feedId:h??void 0,onNext:T})}),n.jsx(Un,{item:j,title:`${s.title} - Trailer`,open:a,onClose:()=>o(!1)})]})},Ct=new ua;Ct.registerByContentType(tl,bt.series);Ct.registerByContentType(sl,bt.episode);Ct.registerByContentType(v1,bt.liveChannel);Ct.registerByContentType(E1,bt.liveEvent);Ct.registerByContentType(d1,bt.page);Ct.registerDefault(Xc);Ct.register(sl,s=>!!s&&nc(s));Ct.register(tl,s=>!!s&&tc(s));const P1=()=>{const t=Ps().id||"",{isLoading:e,isFetching:r,error:a,data:o}=Yt(t),{t:i}=A("error");if(e)return n.jsx(cs,{});if(a||!o)return n.jsx(et,{title:i("video_not_found")});const c=Ct.getScreen(o);return n.jsx(c,{data:o,isLoading:r})},N1="_playlist_1eoo8_1",I1="_main_1eoo8_26",A1="_header_1eoo8_30",T1="_cell_1eoo8_47",L1="_error_1eoo8_51",pr={playlist:N1,main:I1,header:A1,cell:T1,error:L1},nl=({data:s,isLoading:t})=>{const{config:e,accessModel:r}=z(({config:_,accessModel:f})=>({config:_,accessModel:f}),ce),[a,o]=p.useState(""),i=nu(e,s.feedid),c=p.useMemo(()=>ru(s,a),[s,a]),l=!!i.length,{user:d,subscription:u}=R(({user:_,subscription:f})=>({user:_,subscription:f}),ce);p.useEffect(()=>{o("")},[s.feedid]);const h=`${s.title} - ${e.siteName}`,g=_=>Le({media:_,playlistId:_.feedid});return n.jsxs("div",{className:pr.playlist,children:[n.jsxs(xt,{children:[n.jsx("title",{children:h}),n.jsx("meta",{property:"og:title",content:h}),n.jsx("meta",{name:"twitter:title",content:h})]}),n.jsxs("div",{className:pr.main,children:[n.jsxs("header",{className:pr.header,children:[n.jsx("h1",{children:s.title}),l&&n.jsx(Gc,{name:"genre",value:a,defaultLabel:"All",options:i,setValue:o})]}),n.jsx(Fn,{getUrl:g,playlist:c,accessModel:r,isLoggedIn:!!d,hasSubscription:!!u,isLoading:t,headingLevel:2})]})]})},ma=s=>{const t=new Date(s.startTime),e=new Date(s.endTime);return Wi(t)&&Bl(e)},$1=s=>{const t=new Date(s.endTime);return Wi(t)},O1=(s,t=8)=>{const e=new Date(s.startTime),r=Vi(new Date,t);return Ul(e,r)},bn=s=>s.programs.find(ma),D1=({playlist:s,initialChannelId:t,enableAutoUpdate:e=!0})=>{const r=G(uc),{data:a=[]}=qe(["schedules",...s.map(({mediaid:g})=>g)],()=>r.getSchedules(s),{refetchInterval:ad}),[o,i]=p.useState(e),[c,l]=p.useState(),[d,u]=p.useState();p.useEffect(()=>{if(!o||!e)return;const g=window.setInterval(()=>c&&u(bn(c)),5e3);return()=>clearInterval(g)},[c,o,e]),p.useEffect(()=>{const g=a.find(({id:_})=>_===t)||a[0];if(!c&&g&&(l(g),u(bn(g))),c){const _=a.find(({id:x})=>x===c.id);let f=d&&(_==null?void 0:_.programs.find(({id:x})=>x===(d==null?void 0:d.id)));!f&&_&&(f=bn(_)),l(_),u(f)}},[a]);const h=p.useCallback((g,_)=>{const f=a==null?void 0:a.find(y=>y.id===g);if(!f)return;const x=_?f.programs.find(y=>y.id===_):bn(f);l(f),u(x),i(!x||ma(x))},[a]);return{channel:c,channels:a,program:d,setActiveChannel:h}},F1=({program:s,catchupHours:t})=>{const[e,r]=p.useState(!1),[a,o]=p.useState(!1),[i,c]=p.useState(!1);return p.useEffect(()=>{const l=()=>{r(!!s&&ma(s)),o(!!s&&$1(s)),c(!!s&&O1(s,t))},d=setInterval(l,5e3);return l(),()=>clearInterval(d)},[t,s]),{isLive:e,isVod:a,isWatchableFromBeginning:i}},R1=e1(),M1=({id:s,channelLogoImage:t,backgroundImage:e})=>({uuid:s,logo:t,channelLogoImage:t,backgroundImage:e}),B1=(s,{id:t,title:e,cardImage:r,backgroundImage:a,description:o,endTime:i,startTime:c})=>({channelUuid:s,id:t,title:e,image:r||"",cardImage:r||"",backgroundImage:a||"",description:o||"",till:i,since:c}),U1=({channels:s,sidebarWidth:t,itemHeight:e,highlightColor:r,backgroundColor:a})=>{const[o,i]=p.useMemo(()=>[s.map(M1),s.flatMap(h=>h.programs.map(g=>B1(h.id,g)))],[s]),c=p.useMemo(()=>H1(r,a),[r,a]),l=Hl().toJSON(),[d,u]=p.useMemo(()=>[Wl(new Date(l)),Vl()],[l]);return ql({channels:o,epg:i,dayWidth:7200,sidebarWidth:t,itemHeight:e,isSidebar:!0,isTimeline:!0,isLine:!0,isBaseTimeFormat:R1,startDate:d,endDate:u,theme:c})},H1=(s,t)=>({primary:{600:t||"#141523",900:t||"#141523"},grey:{300:s||"#fff"},white:s||"#fff",green:{300:s||"#fff"},loader:{teal:"",purple:"",pink:"",bg:""},scrollbar:{border:"",thumb:{bg:""}},gradient:{blue:{300:"",600:"",900:""}},text:{grey:{300:"",500:""}},timeline:{divider:{bg:""}}}),W1="_epgChannelBox_hazxl_1",V1="_epgChannel_hazxl_1",q1="_epgChannelLogo_hazxl_27",Sn={epgChannelBox:W1,epgChannel:V1,epgChannelLogo:q1},z1=({channel:s,channelItemWidth:t,sidebarWidth:e,onClick:r,isActive:a,title:o})=>{const{position:i,uuid:c,channelLogoImage:l}=s,d={top:i.top,height:i.height,width:e};return n.jsx("div",{className:Sn.epgChannelBox,style:d,children:n.jsx("div",{className:B(Sn.epgChannel,{[Sn.active]:a}),style:{width:t},onClick:()=>r&&r(s),"data-testid":void 0,role:"button",children:n.jsx($s,{className:Sn.epgChannelLogo,image:l,alt:o,width:320})})})},G1="_epgProgramBox_swcj7_1",J1="_epgProgram_swcj7_1",Y1="_disabled_swcj7_24",K1="_live_swcj7_28",Q1="_selected_swcj7_31",Z1="_epgProgramTitle_swcj7_34",X1="_epgProgramText_swcj7_37",ew="_epgLiveTag_swcj7_50",tw="_epgProgramContent_swcj7_77",sw="_epgProgramImage_swcj7_119",st={epgProgramBox:G1,epgProgram:J1,disabled:Y1,live:K1,selected:Q1,epgProgramTitle:Z1,epgProgramText:X1,epgLiveTag:ew,epgProgramContent:tw,epgProgramImage:sw},nw=({program:s,onClick:t,isActive:e,compact:r,disabled:a,isBaseTimeFormat:o})=>{const{styles:{position:i},formatTime:c,set12HoursTimeFormat:l,isLive:d,isMinWidth:u}=zl({program:s,isBaseTimeFormat:o}),{t:h}=A("common"),{data:g}=s,{image:_,title:f,since:x,till:y}=g,v=c(x,l()).toLowerCase(),b=c(y,l()).toLowerCase(),w=!r&&u,j=!r&&u&&d,S="";return n.jsx("div",{className:st.epgProgramBox,style:i,onClick:()=>t&&t(s),children:n.jsxs("div",{className:B(st.epgProgram,{[st.selected]:e,[st.live]:d,[st.disabled]:a}),style:{width:st.width},"data-testid":(s.data.id,void 0),children:[w&&n.jsx("img",{className:st.epgProgramImage,src:_,alt:S}),j&&n.jsx("div",{className:st.epgLiveTag,children:h("live")}),n.jsxs("div",{className:st.epgProgramContent,children:[r&&d&&n.jsx("div",{className:st.epgLiveTag,children:h("live")}),n.jsx("h2",{className:st.epgProgramTitle,children:f}),n.jsxs("span",{className:st.epgProgramText,children:[v," - ",b]})]})]})})},rw="_timelineBox_10xo1_1",aw="_timelineTime_10xo1_5",ow="_timelineContainer_10xo1_16",iw="_timelineDividers_10xo1_23",cw="_timelineDivider_10xo1_23",Vs={timelineBox:rw,timelineTime:aw,timelineContainer:ow,timelineDividers:iw,timelineDivider:cw},lw=({isBaseTimeFormat:s,dayWidth:t,hourWidth:e,numberOfHoursInDay:r,offsetStartHoursRange:a,isSidebar:o,sidebarWidth:i})=>{const{time:c,dividers:l,formatTime:d}=Gl(r,s),u=()=>l.map((g,_)=>n.jsx("div",{className:Vs.timelineDivider,style:{marginRight:e/4}},_)),h=g=>n.jsxs("div",{className:Vs.timelineBox,style:{width:e},children:[n.jsx("time",{className:Vs.timelineTime,children:d(g+a).toLowerCase()}),n.jsx("div",{className:Vs.timelineDividers,children:u()})]},g);return n.jsx("div",{className:Vs.timelineContainer,style:{width:t,left:o?i:0},children:c.map((g,_)=>h(_))})},dw="_epg_19byb_1",uw="_epgSpinner_19byb_35",hw="_timelineControl_19byb_43",mw="_timelineNowButton_19byb_57",pw="_leftControl_19byb_68",fw="_rightControl_19byb_69",ws={epg:dw,epgSpinner:uw,timelineControl:hw,timelineNowButton:mw,leftControl:pw,rightControl:fw};function gw({channels:s,selectedChannel:t,onChannelClick:e,onProgramClick:r,program:a,config:o}){const i=Ne(),{t:c}=A("common"),l=i<te.sm,d=l?70:184,u=l?d-10:d-24,h=l?80:106,{highlightColor:g,backgroundColor:_}=o.styling,{getEpgProps:f,getLayoutProps:x,onScrollToNow:y,onScrollLeft:v,onScrollRight:b}=U1({channels:s,sidebarWidth:d,itemHeight:h,highlightColor:g,backgroundColor:_}),w=p.useMemo(()=>Object.fromEntries(s.map(S=>[S.id,S.catchupHours])),[s]),j=p.useMemo(()=>Object.fromEntries(s.map(S=>[S.id,S.title])),[s]);return n.jsxs("div",{className:ws.epg,children:[n.jsxs("div",{className:ws.timelineControl,children:[n.jsx(D,{className:ws.timelineNowButton,variant:"contained",label:c("now"),color:"primary",onClick:y,size:"small"}),n.jsx(ze,{className:ws.leftControl,"aria-label":c("slide_left"),onClick:()=>v(),children:n.jsx(J,{icon:Bc})}),n.jsx(ze,{className:ws.rightControl,"aria-label":c("slide_right"),onClick:()=>b(),children:n.jsx(J,{icon:ea})})]}),n.jsx(Jl,{...f(),loader:n.jsx(is,{className:ws.epgSpinner}),children:n.jsx(Yl,{...x(),renderTimeline:S=>n.jsx(lw,{...S}),renderChannel:({channel:S})=>n.jsx(z1,{channel:S,channelItemWidth:u,sidebarWidth:d,onClick:C=>{e(C.uuid),y()},title:j[S.uuid]||"",isActive:(t==null?void 0:t.id)===S.uuid},S.uuid),renderProgram:({program:S,isBaseTimeFormat:C})=>{const I=w[S.data.channelUuid],E=Kl(new Date(S.data.since),Vi(new Date,I));return n.jsx(nw,{program:S,disabled:E,onClick:P=>!E&&r(P.data.id,P.data.channelUuid),isActive:(a==null?void 0:a.id)===S.data.id,compact:l,isBaseTimeFormat:C},S.data.id)}})})]})}const _w="_epgContainer_1b7k0_1",yw="_catchupButton_1b7k0_21",vw="_tag_1b7k0_27",fr={epgContainer:_w,catchupButton:yw,tag:vw},xw=({data:{feedid:s,playlist:t}})=>{var M,Z,Q;const{t:e}=A("epg"),{config:r}=z(({config:q})=>({config:q}),ce),{siteName:a}=r,o=le(),i=oe(),c=p.useMemo(()=>new URLSearchParams(o.search),[o.search]),l=c.get("play")==="1",d=c.get("channel")??void 0,u=c.get("start"),h=c.get("end"),g=c.get("beginning")==="1",_=()=>s&&i(Ss(s,d)),[f]=p.useState(d),{channels:x,channel:y,program:v,setActiveChannel:b}=D1({playlist:t,initialChannelId:f,enableAutoUpdate:!g}),{isLive:w,isVod:j,isWatchableFromBeginning:S}=F1({program:v,catchupHours:y==null?void 0:y.catchupHours}),C=p.useMemo(()=>t.find(({mediaid:q})=>(y==null?void 0:y.id)===q),[y==null?void 0:y.id,t]),{isEntitled:I}=Os(C),E=p.useMemo(()=>v?{title:v.title,description:v.description||"",image:v.backgroundImage,canWatch:w||j&&S,canWatchFromBeginning:I&&w&&S}:{title:(y==null?void 0:y.title)||"",description:(y==null?void 0:y.description)||"",image:y==null?void 0:y.backgroundImage,canWatch:!0,canWatchFromBeginning:!1},[y==null?void 0:y.backgroundImage,y==null?void 0:y.description,y==null?void 0:y.title,I,w,j,S,v]),P=p.useMemo(()=>{if(!y)return"";if(!v)return n.jsx(Tr,{isLive:!0,children:e("common:live")});const q=new Date(v.startTime),k=new Date(v.endTime),L=Ql(k,q),W=Wr(L),X=[e("on_channel",{name:y.title}),W].filter(Boolean);return n.jsxs(n.Fragment,{children:[n.jsx(Tr,{className:fr.tag,isLive:w,children:w?e("common:live"):`${xa(q,"p")} - ${xa(k,"p")}`}),n.jsx(Es,{attributes:X})]})},[y,w,v,e]),N=(q,k)=>{b(k,q),(document.scrollingElement||document.body).scroll({top:0,behavior:"smooth"})},$=q=>{b(q)};if(p.useEffect(()=>{y&&s&&d!==y.id&&i(Ss(s,y.id),{replace:!0})},[i,s,y,d]),!y||!s)return n.jsx(cs,{});const O=`${window.location.origin}${Ss(s,y.id)}`,U=`${y.title} - ${a}`,H=C?n.jsx(un,{title:C.title,description:C.description,url:window.location.href}):null,T=C?n.jsxs(n.Fragment,{children:[n.jsx(ln,{item:C,playUrl:Se(Ss(s,d,!0),{start:j?v==null?void 0:v.startTime:void 0,end:j?v==null?void 0:v.endTime:void 0}),disabled:!E.canWatch}),E.canWatchFromBeginning&&n.jsx(D,{className:fr.catchupButton,onClick:()=>i(Se(Ss(s||"",d,!0),{start:v==null?void 0:v.startTime,beginning:1})),label:e("start_from_beginning"),startIcon:n.jsx(J,{icon:Zc})})]}):null;return n.jsxs(n.Fragment,{children:[n.jsxs(xt,{children:[n.jsx("title",{children:U}),n.jsx("link",{rel:"canonical",href:O}),n.jsx("meta",{name:"description",content:C==null?void 0:C.description}),n.jsx("meta",{property:"og:description",content:C==null?void 0:C.description}),n.jsx("meta",{property:"og:title",content:U}),n.jsx("meta",{property:"og:type",content:"video.other"}),(C==null?void 0:C.image)&&n.jsx("meta",{property:"og:image",content:(M=C.image)==null?void 0:M.replace(/^https:/,"http:")}),(C==null?void 0:C.image)&&n.jsx("meta",{property:"og:image:secure_url",content:(Z=C.image)==null?void 0:Z.replace(/^http:/,"https:")}),n.jsx("meta",{property:"og:image:width",content:C!=null&&C.image?"720":""}),n.jsx("meta",{property:"og:image:height",content:C!=null&&C.image?"406":""}),n.jsx("meta",{name:"twitter:title",content:U}),n.jsx("meta",{name:"twitter:description",content:C==null?void 0:C.description}),n.jsx("meta",{name:"twitter:image",content:C==null?void 0:C.image}),n.jsx("meta",{property:"og:video",content:O.replace(/^https:/,"http:")}),n.jsx("meta",{property:"og:video:secure_url",content:O.replace(/^http:/,"https:")}),n.jsx("meta",{property:"og:video:type",content:"text/html"}),n.jsx("meta",{property:"og:video:width",content:"1280"}),n.jsx("meta",{property:"og:video:height",content:"720"}),(Q=C==null?void 0:C.tags)==null?void 0:Q.split(",").map(q=>n.jsx("meta",{property:"og:video:tag",content:q},q)),C?n.jsx("script",{type:"application/ld+json",children:ha(C,window.location.origin)}):null]}),n.jsxs(Jc,{title:E.title,description:E.description,image:E.image,startWatchingButton:T,shareButton:H,primaryMetadata:P,children:[C&&n.jsx(dn,{open:l&&I,onClose:_,item:C,title:E.title,primaryMetadata:P,feedId:s,liveStartDateTime:u,liveEndDateTime:h,liveFromBeginning:g}),n.jsx("div",{className:fr.epgContainer,children:n.jsx(gw,{channels:x,onChannelClick:$,onProgramClick:N,selectedChannel:y,program:v,config:r})})]})]})},pa=new ua,rl=new ua;pa.registerDefault(nl);pa.registerByContentType(xw,od.live);rl.registerDefault(nl);const Li=({type:s})=>{const e=Ps().id||"",{isLoading:r,isFetching:a,error:o,data:i}=cn(e,{},!0,!0,s),{t:c}=A("error");if(r)return n.jsx(cs,{});if(o||!i)return n.jsx(et,{title:c("playlist_not_found")});if(i.playlist.length===0)return n.jsx(et,{title:c("empty_shelves_heading"),message:c("empty_shelves_description")});const l=s===Jt.content_list?rl.getScreen(i):pa.getScreen(i);return n.jsx(l,{data:i,isLoading:a})},ww="_header_zhko0_1",bw="_fixed_zhko0_7",Sw="_container_zhko0_17",jw="_menu_zhko0_26",Cw="_iconButton_zhko0_30",kw="_brand_zhko0_38",Ew="_nav_zhko0_42",Pw="_skipToContent_zhko0_67",Nw="_actions_zhko0_101",Iw="_search_zhko0_112",Aw="_brandCentered_zhko0_116",Tw="_navButton_zhko0_120",Lw="_searchActive_zhko0_150",at={header:ww,fixed:bw,static:"_static_zhko0_12",container:Sw,menu:jw,iconButton:Cw,brand:kw,nav:Ew,skipToContent:Pw,actions:Nw,search:Iw,brandCentered:Aw,navButton:Tw,searchActive:Lw},$w=({children:s,headerType:t="static",searchActive:e})=>{const r=B(at.header,at[t],{[at.searchActive]:e});return n.jsx("header",{className:r,children:n.jsx("div",{className:at.container,children:s})})},Ow="_footer_ur4vs_1",Dw="_list_ur4vs_16",Fw="_testFixMargin_ur4vs_29",gr={footer:Ow,list:Dw,testFixMargin:Fw},Rw=({text:s})=>{const t=s.split("|").map(a=>a.trim()),e=t.map((a,o)=>n.jsx(Xr,{markdownString:a,inline:!0,tag:t.length>1?"li":"div"},o)),r=t.length>1?n.jsx("ul",{className:gr.list,children:e}):e;return n.jsx("footer",{className:B(gr.footer,{[gr.testFixMargin]:pd}),children:r})},Mw=s=>p.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},p.createElement("path",{d:"M0 0h24v24H0V0z",fill:"none"}),p.createElement("path",{d:"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"})),Bw=({sideBarOpen:s,onClick:t})=>{const{t:e}=A("menu");return n.jsx("div",{className:at.menu,children:n.jsx(ze,{className:at.iconButton,"aria-label":e("open_menu"),"aria-expanded":s,onClick:t,children:n.jsx(J,{icon:Mw})})})},Uw=100,Hw=({navItems:s})=>{const t=p.useRef(null),e=r=>{if(!t.current)return;const a=t.current.getBoundingClientRect(),i=r.target.getBoundingClientRect().left+t.current.scrollLeft-a.left,c=i<a.width/2?0:i-Uw;t.current.scrollTo({left:c,behavior:"smooth"})};return n.jsx("nav",{className:at.nav,ref:t,children:n.jsx("ul",{onFocus:e,children:s.map((r,a)=>n.jsx("li",{children:n.jsx(D,{activeClassname:at.navButton,label:r.label,to:r.to,variant:"text"})},a))})})},Ww="_logo_82l2n_1",Vw={logo:Ww},qw=({src:s,alt:t="logo",onLoad:e})=>{const[r,a]=p.useState({height:void 0,width:void 0}),o=i=>{const{height:c,width:l}=i.currentTarget;a({height:c,width:l}),e()};return n.jsx(en,{to:"/",children:n.jsx("img",{className:Vw.logo,alt:t,src:s,height:r.height,width:r.width,onLoad:o,onError:e})})},zw=({siteName:s,logoSrc:t,setLogoLoaded:e})=>{const{t:r}=A("menu");return t?n.jsx("div",{className:at.brand,children:n.jsx(qw,{alt:r("logo_alt",{siteName:s}),src:t,onLoad:()=>e(!0)})}):null},Gw=({children:s})=>n.jsx("div",{className:at.actions,children:s}),Jw=()=>{const{t:s}=A("menu");return n.jsx("a",{href:"#content",className:at.skipToContent,children:s("skip_to_content")})},Yw="_sidebar_1hxk3_1",Kw="_heading_1hxk3_19",Qw="_group_1hxk3_24",_r={sidebar:Yw,heading:Kw,group:Qw},Zw=({children:s,...t})=>n.jsx(zr,{direction:"left",...t,children:s}),Xw=({isOpen:s,onClose:t,children:e})=>{const{t:r}=A("menu");return n.jsx($n,{open:s,onClose:t,AnimationComponent:Zw,children:n.jsxs("div",{className:_r.sidebar,id:"sidebar",children:[n.jsx("div",{className:_r.heading,children:n.jsx(ze,{onClick:t,"aria-label":r("close_menu"),children:n.jsx(J,{icon:On})})}),n.jsx("nav",{className:_r.group,onClick:t,children:e})]})})},eb="_menuButton_5vhgl_1",tb="_small_5vhgl_24",sb="_startIcon_5vhgl_28",nb="_active_5vhgl_41",bs={menuButton:eb,small:tb,startIcon:sb,active:nb},js=({label:s,to:t,onClick:e,onBlur:r,onFocus:a,tabIndex:o=0,active:i=!1,startIcon:c,small:l=!1,...d})=>{const u=c?n.jsx("div",{className:bs.startIcon,children:c}):null,h=g=>B(bs.menuButton,{[bs.small]:l},{[bs.active]:g});return t?n.jsxs(Bi,{onBlur:r,onFocus:a,onClick:e,className:({isActive:g})=>h(g||i),to:t,tabIndex:o,end:!0,children:[u,n.jsx("span",{className:bs.label,children:s})]}):n.jsxs("div",{role:"button",onBlur:r,onFocus:a,className:h(i),onClick:e,tabIndex:o,...d,children:[u,n.jsx("span",{className:bs.label,children:s})]})},rb="_popover_px6io_1",ab="_menuItems_px6io_5",ob="_divider_px6io_16",ib="_small_px6io_29",cb="_sectionHeader_px6io_43",Js={popover:rb,menuItems:ab,divider:ob,small:ib,sectionHeader:cb},al=({showPaymentItems:s,small:t=!1,onButtonClick:e,favoritesEnabled:r,focusable:a,titleId:o})=>{const{t:i}=A("user"),c=oe(),l=G(fe),d=a?0:-1,u=p.useCallback(async()=>{e&&e(),await l.logout(),c("/",{replace:!0})},[e,c,l]);return n.jsxs(n.Fragment,{children:[n.jsx("h2",{className:Js.sectionHeader,id:o,children:i("nav.settings")}),n.jsxs("ul",{className:Js.menuItems,children:[n.jsx("li",{children:n.jsx(js,{small:t,onClick:e,to:jd,label:i("nav.account"),startIcon:n.jsx(J,{icon:ra}),tabIndex:d})}),r&&n.jsx("li",{children:n.jsx(js,{small:t,onClick:e,to:Cd,label:i("nav.favorites"),startIcon:n.jsx(J,{icon:aa}),tabIndex:d})}),s&&n.jsx("li",{children:n.jsx(js,{small:t,onClick:e,to:kd,label:i("nav.payments"),startIcon:n.jsx(J,{icon:Vc}),tabIndex:d})}),n.jsx("li",{className:B(Js.divider,{[Js.small]:t}),children:n.jsx(js,{small:t,onClick:u,label:i("nav.logout"),startIcon:n.jsx(J,{icon:qc}),tabIndex:d})})]})]})},lb="_buttonContainer_ak6a2_1",db="_separator_ak6a2_10",ol={buttonContainer:lb,separator:db},ub=({sideBarOpen:s,canLogin:t,isLoggedIn:e,favoritesEnabled:r,onLoginClick:a,onSignUpClick:o})=>{const{t:i}=A("menu"),c=ot("usermenu-title");return t?e?n.jsx("section",{"aria-labelledby":c,children:n.jsx(al,{focusable:s,favoritesEnabled:r,titleId:c,showPaymentItems:!0})}):n.jsxs("div",{className:ol.buttonContainer,children:[n.jsx(D,{tabIndex:s?0:-1,onClick:a,label:i("sign_in"),fullWidth:!0}),n.jsx(D,{tabIndex:s?0:-1,variant:"contained",color:"primary",onClick:o,label:i("sign_up"),fullWidth:!0})]}):null},hb=()=>{const{t:s}=A("common"),t=oe(),e=le(),r=De(_=>_.sideBarOpen),{config:{menu:a,features:o},accessModel:i}=z(_=>({config:_.config,accessModel:_.accessModel})),c=R(({user:_})=>!!_),l=!!(o!=null&&o.favoritesList),d=i!==$e.AVOD,u=()=>De.setState({sideBarOpen:!1}),h=()=>{t(V(e,"login"))},g=()=>{t(V(e,"create-account"))};return n.jsxs(Xw,{isOpen:r,onClose:u,children:[n.jsxs("ul",{children:[n.jsx("li",{children:n.jsx(js,{label:s("home"),to:"/"})}),a.map(({contentId:_,type:f,label:x})=>n.jsx("li",{children:n.jsx(js,{label:x,to:f===Jt.content_list?ic(_):oc(_)})},_))]}),n.jsx("hr",{className:ol.separator}),n.jsx(ub,{sideBarOpen:r,favoritesEnabled:l,canLogin:d,isLoggedIn:c,onLoginClick:h,onSignUpClick:g})]})},mb=()=>{const{t:s}=A("common"),{siteName:t,description:e}=z(({config:a})=>a,ce),r=e||s("default_description");return n.jsxs(xt,{children:[n.jsx("title",{children:t}),n.jsx("meta",{name:"description",content:r}),n.jsx("meta",{property:"og:description",content:r}),n.jsx("meta",{property:"og:title",content:t}),n.jsx("meta",{name:"twitter:title",content:t}),n.jsx("meta",{name:"twitter:description",content:r})]})},il=s=>p.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},p.createElement("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"})),pb=s=>p.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},p.createElement("path",{d:"M9 1C4.58 1 1 4.58 1 9s3.58 8 8 8 8-3.58 8-8-3.58-8-8-8zm4 10.87L11.87 13 9 10.13 6.13 13 5 11.87 7.87 9 5 6.13 6.13 5 9 7.87 11.87 5 13 6.13 10.13 9 13 11.87z"})),fb="_searchBar_kqbxa_1",gb="_searchForm_kqbxa_5",_b="_icon_kqbxa_9",yb="_input_kqbxa_15",vb="_clearButton_kqbxa_40",qs={searchBar:fb,searchForm:gb,icon:_b,input:yb,clearButton:vb},xb=({query:s,onQueryChange:t,onClearButtonClick:e,onClose:r,inputRef:a})=>{const{t:o}=A("search"),i=c=>{var l;c.preventDefault(),a==null||a.current.focus(),(l=document.querySelector("#content"))==null||l.focus()};return n.jsxs("div",{className:qs.searchBar,children:[n.jsx(J,{icon:il,className:qs.icon}),n.jsxs("form",{className:qs.searchForm,role:"search",onSubmit:i,children:[n.jsx("label",{htmlFor:"searchbar-input",className:"hidden",children:o("search_bar.search_label")}),n.jsx("input",{className:qs.input,id:"searchbar-input",type:"search",value:s,onChange:t,onKeyDown:c=>c.key==="Escape"&&(r==null?void 0:r()),placeholder:o("search_bar.search_placeholder"),ref:a}),s?n.jsx(ze,{className:qs.clearButton,"aria-label":o("search_bar.clear_search_label"),onClick:e,children:n.jsx(J,{icon:pb})}):null]})]})},Nn=({children:s,className:t,...e})=>n.jsx(ze,{className:B(at.iconButton,t),...e,children:s}),wb="_searchContainer_1tta1_1",bb={searchContainer:wb},Sb=()=>{const s=le(),t=p.useRef(null),e=z(({config:f})=>f),{features:r,custom:a}=e,{searchPlaylist:o}=r||{},i=os(a==null?void 0:a.appContentSearch),c=!!o||i,{searchQuery:l,searchActive:d}=De(({searchQuery:f,searchActive:x,userMenuOpen:y,languageMenuOpen:v})=>({languageMenuOpen:v,searchQuery:f,searchActive:x,userMenuOpen:y}),ce),{updateSearchQuery:u,resetSearchQuery:h}=Wc(),g=()=>{h(),De.setState({searchActive:!1})},_=()=>{De.setState({searchActive:!0,preSearchPage:`${s.pathname}${s.search||""}`})};return p.useEffect(()=>{d&&t.current&&t.current.focus()},[d]),c?d?n.jsxs("div",{className:bb.searchContainer,children:[n.jsx(xb,{query:l,onQueryChange:f=>u(f.target.value),onClearButtonClick:()=>u(""),inputRef:t,onClose:g}),n.jsx(Nn,{"aria-label":"Close search",onClick:g,children:n.jsx(J,{icon:On})})]}):n.jsx(Nn,{"aria-label":"Open search",onClick:_,children:n.jsx(J,{icon:il})}):null},jb=s=>p.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},p.createElement("path",{fill:"currentColor",d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zm6.93 6h-2.95c-.32-1.25-.78-2.45-1.38-3.56 1.84.63 3.37 1.91 4.33 3.56zM12 4.04c.83 1.2 1.48 2.53 1.91 3.96h-3.82c.43-1.43 1.08-2.76 1.91-3.96zM4.26 14C4.1 13.36 4 12.69 4 12s.1-1.36.26-2h3.38c-.08.66-.14 1.32-.14 2 0 .68.06 1.34.14 2H4.26zm.82 2h2.95c.32 1.25.78 2.45 1.38 3.56-1.84-.63-3.37-1.9-4.33-3.56zm2.95-8H5.08c.96-1.66 2.49-2.93 4.33-3.56C8.81 5.55 8.35 6.75 8.03 8zM12 19.96c-.83-1.2-1.48-2.53-1.91-3.96h3.82c-.43 1.43-1.08 2.76-1.91 3.96zM14.34 14H9.66c-.09-.66-.16-1.32-.16-2 0-.68.07-1.35.16-2h4.68c.09.65.16 1.32.16 2 0 .68-.07 1.34-.16 2zm.25 5.56c.6-1.11 1.06-2.31 1.38-3.56h2.95c-.96 1.65-2.49 2.93-4.33 3.56zM16.36 14c.08-.66.14-1.32.14-2 0-.68-.06-1.34-.14-2h3.38c.16.64.26 1.31.26 2s-.1 1.36-.26 2h-3.38z"})),Cb="_panel_jhs6c_1",kb={panel:Cb},cl=({children:s,...t})=>n.jsx("div",{className:kb.panel,...t,children:s}),Eb=({callback:s,children:t})=>{const e=p.useRef();return p.useEffect(()=>{const r=a=>{var o;!e.current||!(a.target instanceof Node)||e.current!==a.target&&!((o=e.current)!=null&&o.contains(a.target))&&s()};return setTimeout(()=>document.addEventListener("click",r),1),()=>document.removeEventListener("click",r)},[s]),Ee.cloneElement(t,{ref:r=>{e.current=r}})},Pb="_popover_1efkk_1",Nb={popover:Pb},ll=({children:s,className:t,isOpen:e,onClose:r})=>n.jsx(zr,{open:e,duration:250,direction:"right",style:{position:"relative"},children:n.jsx(Eb,{callback:r,children:n.jsx("div",{className:B(Nb.popover,t),children:s})})}),Ib="_popover_1oh0j_1",Ab="_menuItems_1oh0j_5",Tb="_header_1oh0j_11",Lb="_menuItem_1oh0j_5",$b="_menuItemActive_1oh0j_28",yr={popover:Ib,menuItems:Ab,header:Tb,menuItem:Lb,menuItemActive:$b},Ob=({onClick:s,className:t,languages:e,currentLanguage:r,languageMenuOpen:a,closeLanguageMenu:o,openLanguageMenu:i})=>{const{t:c}=A("menu"),l=(u,h)=>{u.preventDefault(),s&&s(h),o()},d=()=>{a?o():i()};return n.jsxs("div",{children:[n.jsx(Nn,{"data-testid":void 0,"aria-controls":"language-panel","aria-expanded":a,"aria-haspopup":"menu",className:t,"aria-label":c("language_menu"),onClick:d,onBlur:o,children:n.jsx(J,{icon:jb})}),n.jsx(ll,{isOpen:a,onClose:o,children:n.jsx(cl,{id:"language-panel",children:n.jsx("ul",{className:yr.menuItems,children:e.map(({code:u,displayName:h})=>{const g=(r==null?void 0:r.code)===u,_=B(yr.menuItem,{[yr.menuItemActive]:g});return n.jsx("li",{className:_,onClick:f=>l(f,u),children:n.jsx(Zs,{onFocus:i,onBlur:o,href:"#","aria-current":g,children:h})},u)})})})})]})},Db=()=>{const{i18n:s}=A("menu"),t=z(c=>c.supportedLanguages),e=De(c=>c.languageMenuOpen),r=p.useCallback(()=>De.setState({languageMenuOpen:!0}),[]),a=p.useCallback(()=>De.setState({languageMenuOpen:!1}),[]),o=c=>{s.changeLanguage(c)},i=p.useMemo(()=>t.find(({code:c})=>c===s.language),[s.language,t]);return t.length<2?null:n.jsx(Ob,{openLanguageMenu:r,closeLanguageMenu:a,languageMenuOpen:e,onClick:o,languages:t,currentLanguage:i})},Fb=({isLoggedIn:s,favoritesEnabled:t,open:e,onClose:r,onOpen:a,onLoginButtonClick:o,onSignUpButtonClick:i})=>{const{t:c}=A("menu");return s?n.jsxs("div",{children:[n.jsx(Nn,{"aria-label":c("open_user_menu"),"aria-controls":"menu_panel","aria-expanded":e,"aria-haspopup":"menu",onClick:a,onBlur:r,children:n.jsx(J,{icon:ra})}),n.jsx(ll,{className:Js.popover,isOpen:e,onClose:r,children:n.jsx(cl,{id:"menu_panel",children:n.jsx("div",{onFocus:a,onBlur:r,children:n.jsx(al,{focusable:e,onButtonClick:r,showPaymentItems:!0,favoritesEnabled:t,small:!0})})})})]}):n.jsxs(n.Fragment,{children:[n.jsx(D,{onClick:o,label:c("sign_in"),"aria-haspopup":"dialog"}),n.jsx(D,{variant:"contained",color:"primary",onClick:i,label:c("sign_up"),"aria-haspopup":"dialog"})]})},Rb=()=>{const s=Ne(),t=oe(),e=le(),r=De(_=>_.userMenuOpen),{config:{features:a},accessModel:o}=z(_=>({config:_.config,accessModel:_.accessModel})),i=R(({user:_})=>!!_),c=!!(a!=null&&a.favoritesList),l=o!==$e.AVOD,d=p.useCallback(()=>De.setState({userMenuOpen:!0}),[]),u=p.useCallback(()=>De.setState({userMenuOpen:!1}),[]),h=()=>t(V(e,"login")),g=()=>t(V(e,"create-account"));return!l||s<=te.sm?null:n.jsx(Fb,{open:r,onOpen:d,onClose:u,isLoggedIn:i,favoritesEnabled:c,onLoginButtonClick:h,onSignUpButtonClick:g})},Mb="_layout_93hv3_1",Bb="_main_93hv3_6",$i={layout:Mb,main:Bb},Ub=()=>{const{t:s}=A("common"),{config:t}=z(({config:f,accessModel:x,supportedLanguages:y})=>({config:f,accessModel:x,supportedLanguages:y}),ce),{menu:e,assets:r,siteName:a,styling:o}=t,{footerText:i}=o||{},c=i||hd(K.APP_FOOTER_TEXT),{sideBarOpen:l,searchActive:d}=De(f=>({sideBarOpen:f.sideBarOpen,searchActive:f.searchActive})),u=r.banner,h=()=>De.setState({sideBarOpen:!0}),g=[{label:s("home"),to:"/"},...e.map(({label:f,contentId:x,type:y})=>({label:f,to:y===Jt.content_list?ic(x):oc(x)}))],_={inert:l?"":void 0};return n.jsxs("div",{className:$i.layout,children:[n.jsx(mb,{}),n.jsxs("div",{..._,children:[n.jsxs($w,{searchActive:d,children:[n.jsx(Jw,{}),n.jsx(Bw,{sideBarOpen:l,onClick:h}),n.jsx(zw,{siteName:a,logoSrc:u,setLogoLoaded:()=>{}}),n.jsx(Hw,{navItems:g}),n.jsxs(Gw,{children:[n.jsx(Sb,{}),n.jsx(Db,{}),n.jsx(Rb,{})]})]}),n.jsx("main",{id:"content",className:$i.main,tabIndex:-1,children:n.jsx(qi,{})}),!!c&&n.jsx(Rw,{text:c})]}),n.jsx(hb,{})]})};function Hb(){const s=oe(),t=le(),e=R(i=>{var c;return typeof((c=i.user)==null?void 0:c.uuid)=="string"?i.user.uuid:void 0}),r=G(fe),{hasNotifications:a}=(r==null?void 0:r.getFeatures())||{},o=ge((i,c)=>{s(V(t,i,c))});p.useEffect(()=>{!e||!a||r==null||r.subscribeToNotifications({uuid:e,onMessage:async i=>{var c,l;if(i){const d=JSON.parse(i);switch(d.type){case".failed":case"payment.card.failed":case"subscribe.failed":o("payment-error",(c=d.resource)==null?void 0:c.message);break;case"payment.card.success":await _c.invalidateQueries(["entitlements"]),o(null);break;case"subscribe.success":await r.reloadSubscriptions();break;case"access.revoked":await r.reloadSubscriptions();break;case"payment.card.requires.action":case"subscribe.requires.action":window.location.href=(l=d.resource)==null?void 0:l.redirect_to_url;break}}}})},[r,a,o,e])}const Wb=()=>{const{i18n:s}=A(),t=le(),e=R(r=>({loading:r.loading,user:r.user}),ce);return Hb(),p.useEffect(()=>{document.documentElement.setAttribute("lang",s.language)},[s.language]),e.user&&!e.loading&&window.location.href.includes("#token")?n.jsx(rs,{to:{...t,hash:""},replace:!0}):n.jsx(qi,{})};function Vb(){const{t:s}=A("error");return n.jsx(Hi,{children:n.jsx(He,{element:n.jsx(Wb,{}),children:n.jsxs(He,{element:n.jsx(Ub,{}),errorElement:n.jsx(vg,{}),children:[n.jsx(He,{index:!0,element:n.jsx(k_,{})}),n.jsx(He,{path:Br,element:n.jsx(Li,{type:Jt.playlist})}),n.jsx(He,{path:Zi,element:n.jsx(Li,{type:Jt.content_list})}),n.jsx(He,{path:Qi,element:n.jsx(P1,{})}),n.jsx(He,{path:xd,element:n.jsx(i1,{})}),n.jsx(He,{path:wd,element:n.jsx(V_,{})}),n.jsx(He,{path:Sd,element:n.jsx(qy,{})}),n.jsx(He,{path:bd,element:n.jsx(Cg,{})}),n.jsx(He,{path:"/*",element:n.jsx(et,{title:s("notfound_error_heading","Not found"),message:s("notfound_error_description","This page doesn't exist.")})})]})})})}const qb="_hero_4vsml_1",zb="_heroPadding_4vsml_10",Gb="_info_4vsml_29",Jb="_title_4vsml_54",Yb="_description_4vsml_71",Kb="_poster_4vsml_78",Qb="_posterFade_4vsml_101",zt={hero:qb,heroPadding:zb,info:Gb,title:Jb,description:Yb,poster:Kb,posterFade:Qb},Zb=({title:s,description:t,image:e})=>{const a=Ne()===te.xs;return n.jsxs("div",{className:B(zt.hero,zt.heroPadding),children:[n.jsx($s,{className:zt.poster,image:e,width:1280,alt:""}),n.jsx("div",{className:zt.posterFade}),n.jsxs("div",{className:zt.info,children:[n.jsx("h1",{className:zt.title,children:s}),a?n.jsx(la,{text:t,className:zt.description}):n.jsx(ca,{text:t,maximumLines:8,className:zt.description})]})]})},Xb=s=>(typeof s=="string"?s.replace(/\s+/g,"").split(","):[]).map(e=>({type:"playlist",contentId:e})),eS=({data:s})=>{const t=p.useMemo(()=>Xb(s.playlists||s.playlist),[s.playlist,s.playlists]);return p.useEffect(()=>{var e;(document.scrollingElement||document.body).scroll({top:0}),(e=document.querySelector("#video-details button"))==null||e.focus()},[s]),n.jsxs("header",{children:[n.jsx(Zb,{image:s.backgroundImage,title:s.title,description:s.description}),n.jsx(Hc,{rows:t})]})};function tS(){Ct.registerByContentType(eS,bt.hub)}function sS(s,t){const[e,r]=Xs();return p.useLayoutEffect(()=>{s&&(e.has(zs)&&(!t||t===(s==null?void 0:s.defaultConfigSource))&&r(a=>(a.delete(zs),a),{replace:!0}),t&&t!==(s==null?void 0:s.defaultConfigSource)&&e.get(zs)!==t&&r(a=>(a.set(zs,t),a),{replace:!0}))},[t,e,r,s]),t}const nS=({error:s})=>s instanceof Cs?n.jsx(et,{title:s.payload.title,message:s.payload.description,helpLink:s.payload.helpLink,error:s}):n.jsx(et,{error:s}),rS=({query:s})=>{const{isLoading:t,error:e}=s;return t?n.jsx(xe,{}):e?n.jsx(nS,{error:e}):null},aS=({onReady:s})=>{var e,r;const t=mg(window.location.href,s);return sS((e=t.data)==null?void 0:e.settings,(r=t.data)==null?void 0:r.configSource),n.jsx(rS,{query:t})},oS=()=>{const s=p.useRef(!1),[t,e]=p.useState(!1);p.useEffect(()=>{tS()},[]);const r=p.useCallback(async a=>{a&&(pg(a),a.analyticsToken&&!s.current&&(await wc("/jwpltx.js"),s.current=!0),e(!0))},[]);return n.jsxs(n.Fragment,{children:[t&&n.jsx(Vb,{}),t&&n.jsx(lg,{}),n.jsx(aS,{onReady:r})]})};function iS(){const[s,t]=p.useState({isLoading:!0});return p.useEffect(()=>{Yu().then(()=>t({isLoading:!1})).catch(e=>t({isLoading:!1,error:e}))},[]),s.isLoading?n.jsx(xe,{}):s.error?(Ve("App","Failed to load translations",{error:s.error}),n.jsx(yc,{title:"Unable to load translations",message:"Check your language settings and try again later. If the problem persists contact technical support.",error:s.error})):n.jsx(bu,{children:n.jsx(Zl,{children:n.jsx(qu,{children:n.jsx(oS,{})})})})}const cS=()=>{let s=!1;document.addEventListener("keydown",t=>{t.key==="Tab"&&!s&&(s=!0,document.body.classList.add("is-tabbing"))}),document.addEventListener("mousedown",()=>{s&&(s=!1,document.body.classList.remove("is-tabbing"))})};var Oi={APP_API_BASE_URL:"https://cdn.jwplayer.com",APP_PLAYER_ID:"M4qoGvUk",APP_VERSION:"4.30.0",APP_FOOTER_TEXT:"\\u00a9 JW Player | [jwplayer.com](https://www.jwplayer.com/) | v4.30.0",APP_DEFAULT_LANGUAGE:"en",APP_ENABLED_LANGUAGES:"en,es",BASE_URL:"/",MODE:"prod",DEV:!1,PROD:!0,SSR:!1,APP_BODY_FONT:"",APP_BODY_ALT_FONT:""};sd({APP_VERSION:"4.30.0",APP_API_BASE_URL:"https://cdn.jwplayer.com",APP_PLAYER_ID:"M4qoGvUk",APP_DEFAULT_CONFIG_SOURCE:Oi.APP_DEFAULT_CONFIG_SOURCE,APP_PLAYER_LICENSE_KEY:Oi.APP_PLAYER_LICENSE_KEY,APP_FOOTER_TEXT:"\\u00a9 JW Player | [jwplayer.com](https://www.jwplayer.com/) | v4.30.0",APP_BODY_FONT:"",APP_BODY_ALT_FONT:""});cS();const Di=document.getElementById("root");Di?_l(Di).render(n.jsx(iS,{})):console.info("Application - rootElement not found");const lS=td({immediate:!0,onNeedRefresh:()=>lS(!0)});export{zi as _,HS as a,gS as c,_S as g};
//# sourceMappingURL=index-DrWh1H7H.js.map
